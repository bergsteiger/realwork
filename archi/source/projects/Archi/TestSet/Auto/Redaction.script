USES
 QuickTests.script
 QuickTestsUtils.script
;

PROCEDURE "Выбрать пункт связи между документами"
	"Перейти на вкладку Атрибуты"
	21 раз "Нажать вниз"
;

PROCEDURE "Работа с окном связи с документом" 
 "Контрол по имени {('edNumber')}" pop:Control:SetFocus ASSERT
 '10003000'	emitstring
 "Контрол по имени {('OKBtn')}" pop:Control:Click
;

PROCEDURE "Работа с диалогом создания редакции"
  "Контрол по имени {('edtDocID')}" pop:SpinEdit:Value    := 40000001
 "Контрол по имени {('rgEditionKind')}" pop:RadioGroup:ItemIndex := 1
 "Контрол по имени {('OK')}" pop:Control:Click
;

PROCEDURE "Перейти на вкладку атрибутов и сравнить эталоны"
 "Перейти на вкладку Атрибуты"
 "Сравнить дерево с эталоном {(acAttributesOutliner)}"
;

Тест Redaction
	Параметры: ( "Документ с таблицей с Head-ячейками в соседних строках" 
				 "Закрывать все окна"  
				 "Очищать базу" )
	Выполнить ( 
				 "Выбрать пункт связи между документами"
				 @ ( 'Enter' key ) MODAL "Работа с окном связи с документом"
				 "Обработать сообщения"
				 @ ( 'Alt+E' key ) MODAL "Работа с диалогом создания редакции" // Создать редакцию 
				 "Обработать сообщения"
				 "Перейти на вкладку атрибутов и сравнить эталоны"	
	)			
;

Redaction
