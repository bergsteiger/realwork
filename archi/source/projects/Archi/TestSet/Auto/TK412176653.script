USES
	QuickTestsUtils.script
;

CONST cnChangedNodeID 0

PROCEDURE "Развернуть узел 'Оглавление'"
	"развернуть узел {(cnChangedNodeID)}"
;

CONST "Пункт 4" 4
CONST "Последний пункт" 12

PROCEDURE "Развернуть четвертый узел 'Оглавление'"
	"развернуть узел {("Пункт 4")}"
;

PROCEDURE "Развернуть последний дочерний узел 'Оглавление'"
	"развернуть узел {("Последний пункт")}"
;

PROCEDURE "Найти и выделить последний элемент в дереве"
	INTEGER VAR l_Count
	OBJECT VAR l_List  
	focused:control:push >>> l_List
	"Переместиться в начало дерева"
	l_List tree:GetItemsCount >>> l_Count	
	l_Count LOOP (
		Если ( l_Count 12 == ) то 
			выходим
			"Нажать вниз"    
		)
;

Тест TK412176653
	Параметры: (
		"Документ NSR"
		"Дерево оглавления"
		"Эталон для дерева оглавления"
	)
	Выполнить (
		"Развернуть четвертый узел 'Оглавление'"
		"Развернуть последний дочерний узел 'Оглавление'"
		"Найти и выделить последний элемент в дереве"
	)
;

TK412176653