USES
	QuickTestsUtils.script
;

CONST "Контекстное меню 'Удалить документ'" 'acDeleteDocument'
CONST "Имя списка" 'alDocListTools'

PROCEDURE "Вызвать динамическое меню и выбрать команду 'Удалить документ'"
	"Контекстное меню 'Удалить документ'" "Имя списка" focused:control:push pop:Control:GetParentForm pop:form:ExecuteAction
;

Тест TK541894319  
	Параметры: (
		"Не открывать документ" 
		"Документ Конституция"
		"Добавить в выборку"
		"Пустой документ"
		"Закрывать все окна"
		"Очищать базу в конце теста"
	)
	Выполнить (
		BOOLEAN VAR l_WasException
		false >>> l_WasException
		"Создать выборку и добавить документ {(Конституция)}"
	TRY
		"Выполнить с ожиданием 'Да'" ( 
			"Выполнить с ожиданием 'Да'" ( 
				"Вызвать динамическое меню и выбрать команду 'Удалить документ'" 
			)	
		)
		"Обработать сообщения"
		"Свернуть окно" 

		// ---Вызвать ручку для обновления базы---

		"Открыть редактирование текстового шаблона и выполнить" 
		(
			"Набить текст {('Документ использующий Конституцию')}"	
			"Нажать кнопку ОК" 
		) 
		"Вызвать вставку шаблона"

		2500 SLEEP // для отладки

		"Выполнить с ожиданием 'Да'" ( "Выполнить автопростановку ссылок" ) // не работает
	
		2500 SLEEP // для отладки
	EXCEPT
		true >>> l_WasException
	END
	)
;

TK541894319