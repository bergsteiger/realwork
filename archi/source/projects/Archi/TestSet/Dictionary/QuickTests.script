// QuickTests.script
// Библиотека готовых тестов. Здесь располагаются только тесты.

USES 
 axiom:Filter
 
 BlockTools.script
 EditorTools.script 
 MainFormUtils.script
 @\TestExecuteCommand.script 
 QuickTestsUtils.script
;

PROCEDURE "Тест прокрутки документа колесом мыши"
	Выполнить ( "Прокрутить документ вниз до конца с помощью колеса мыши" )
;

USES
 @\TestWithParameters.script
 @\TestParamsDefine.script
;

PROCEDURE "Тест изображения редактора"
	Параметры: ( "Размеры для проверки отрисованного" "Проверить изображение редактора" ) 
	Выполнить ( "только с учетом параметров" )
;

PROCEDURE "Тест преобразования таблиц" 
	Параметры: ( "Проверка EVD эталона" )
    Выполнить ( "Преобразование в таблицу" )
;

PROCEDURE "Тест фильтров при загрузке из EVD"
	Параметры: ( "Проверка EVD эталона" )
    Выполнить ( "только с учетом параметров" )
;

PROCEDURE "Тест фильтров при загрузке из NSR"
	Параметры: ( "Документ NSR" "Проверка EVD эталона" )
    Выполнить ( "только с учетом параметров" )
;

PROCEDURE "Тест фильтров при загрузке из EVD с проверкой таблиц"
	Параметры: ( "Проверка таблицы" )
    Выполнить ( "только с учетом параметров" )              
;

PROCEDURE "Тест отрисовки"
	Параметры: ( "Размеры для отрисовки" "Эталон отрисованного" )
    Выполнить ( "только с учетом параметров" )              
;

PROCEDURE "Тест отрисовки линий таблиц с высокой точностью"
	Параметры: ( "Размеры для отрисовки" "Эталон для линий таблиц" "Высокая точность сохранения данных о линиях" )
    Выполнить ( "только с учетом параметров" )              
;

Тест "Тест выравнивания таблиц"
	Параметры: ( "Размеры для выравнивания линий таблиц" "Проверка EVD эталона" )
	Выполнить ( "Выравнивание границ ячеек" )
;

USES
 CommonWords.script
;

Тест "Тест выравнивания границ ячеек" 
	Параметры: ( "Размеры для выравнивания линий таблиц" )
	Выполнить ( "Выравнивание границ ячеек с сохранением в лог" )
;

PROCEDURE "Тест создания из RTF"
	Параметры: ( "Документ RTF" ) 
	Выполнить (	"Сравнить текст с эталоном" )
;

PROCEDURE "Тест создания из DOC"
	Параметры: ( "Документ DOC" ) 
	Выполнить (	"Сравнить текст с эталоном" )
;

PROCEDURE "Тест создания из DOCX"
	Параметры: ( "Документ DOCX" ) 
	Выполнить (	"Сравнить текст с эталоном" )
;

PROCEDURE "Тест создания из HTML"
	Параметры: ( "Документ HTML" ) 
	Выполнить (	"Сравнить текст с эталоном" )
;

PROCEDURE "Тест расстановки разделов" 
	Параметры: ( "Размеры для отображения разрыва раздела" )
	Выполнить ( "Расстановка разделов"  )
;	

PROCEDURE "Тест создания из RTF с записью картинок"
	Параметры: ( "Документ RTF" "Запись картинок" ) 
	Выполнить (	"Сравнить текст с эталоном" )
;

PROCEDURE "Тест создания из RTF с записью картинок с привязкой к ПК"
    EtalonNeedsComputerName
	Параметры: ( "Документ RTF" "Запись картинок" ) 
	Выполнить (	"Сравнить текст с эталоном" )
;

// deprecated:

: "Тест отрисовки с Zoom =" IN aZoom
 "Создать или открыть" 
 "Отрисовка с Zoom = {(aZoom)}" 
;

USES
 @\TestUtils.script
;

WORDWORKER "Тест с закрытием всех окон"
	TRY 
		WordToWork DO
	FINALLY 
	 	"Закрыть все окна" 
	END  
; 

: "Тест на проверку выполнения с закрытием всех окон" IN anAction
	"Создать или открыть"
	"Подготовка" 
	"Тест с закрытием всех окон" ( anAction DO )	
;

: "Тест автопростановки ссылок"
 filter:AutolinkFilter
 TRY
  "Прогнать через фильтр и сравнить с эталоном"
 FINALLY 
  filter:CleanAutolinkFilter
 END 
;