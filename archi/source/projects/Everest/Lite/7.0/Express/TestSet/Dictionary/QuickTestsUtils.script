// QuickTestsUtils.script
// Вспомогательные методы для QuickTests.script
// !!! Это специальная переходная версия для EverestLiteTests !!!
USES
 axiom:push	
 axiom:Wait
 axiom:Waited
 axiom:Control
 axiom:Editor
 axiom:cc
 
	ArchiSystem.script
	EverestControls.script
	EverestUtils.script
	CommonWords.script
	TableUtils.script
	@\TestExecuteCommand.script
	@\TestWithParameters.script
;

PROCEDURE "Нажать 'Да' при создании блока"
	wait:Yes
	TRY
		"Вставить блок"
	FINALLY
		waited:? ASSERT
	END 
;

PROCEDURE "Прокрутить документ вниз до конца"
	OBJECT VAR l_Editor
	focused:control:push >>> l_Editor	
        WHILE ( l_Editor pop:Editor:DocumentTailVisible ! )
	BEGIN
		cc:NextPage
	END
;

PROCEDURE "Прокрутить стрелкой вниз до конца"
	OBJECT VAR l_Editor
	focused:control:push >>> l_Editor	
        WHILE ( l_Editor pop:Editor:DocumentTailVisible ! )
	BEGIN
		cc:Down
		"Обработать сообщения"
	END
;

PROCEDURE "Вставить из буфера фрагмент RTF"
	VAR l_File
	script:FileName '.rtf' sysutils:ChangeFileExt 
	sysutils:ExtractFileName >>> l_File
	l_File focused:control:push pop:editor:PasteRTF
;

// На форме 'Проверка орфографии'
PROCEDURE "Нажать кнопку 'Завершить'" BOOLEAN IN aLast
	Если ( aLast ) то
	(
		"Контрол по имени {(acCancelButtomInSpelCheckWindow)}" pop:Control:Click  
	)
	иначе 	
	(
		"Контрол по имени {(acSkipButtomInSpelCheckWindow)}" pop:Control:Click
	)
;

// проверка появления диалога орфографии
PROCEDURE "Проверить появление диалога 'Проверка орфографии'"
	wait:Yes
	TRY
		@ ( "Нажать кнопку 'Проверка орфографии' по (F7)" ) MODAL ( "Нажать кнопку 'Завершить'" )
	FINALLY
		waited:? ASSERT
	END
;

PROCEDURE "Нажать кнопку 'Заменить все'"
	"Контрол по имени {(acReplaceAllButtomInSpelCheckWindow)}" pop:Control:Click  
;

PROCEDURE "Нажать кнопку на форме 'Проверка орфографии'" BOOLEAN IN aLast IN aValueButtom
	Если ( aLast ) то
	(
		"Контрол по имени {(acCancelButtomInSpelCheckWindow)}" pop:Control:Click  
	)
	иначе 	
	(
		"Контрол по имени {(aValueButtom)}" pop:Control:Click
	)
;

PROCEDURE "Нажимать кнопку 'Проверка орфографии' и исправить слова вручную, затем нажать кнопку 'Завершить'"
	@ ( "Нажать кнопку 'Проверка орфографии' по (F7)" ) MODAL (
		"Нажать кнопку на форме 'Проверка орфографии' {(acReplaceAllButtomInSpelCheckWindow)}" 
	)
;




