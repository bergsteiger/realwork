//#UC START# *4683A2A102E6_ext:ParentFileName
w:\garant6x\implementation\Garant\GbaNemesis\Search\nsQueryAttribute.pas
//#UC END# *4683A2A102E6_ext:ParentFileName
//#UC START# *54E5C312006A_4683A2A102E6_impl*
 l_Strings := GetReqAsStrings;
 Assert(l_Strings <> nil);
 l_Count := l_Strings.Count;
 for l_Index := 0 to Pred(l_Count) do
 begin
  if (l_Index > 0) then
   Result := l3Cat([Result, aSeparator]);
  Result := l3Cat([Result, l_Strings.ItemC[l_Index]]);
 end;
//#UC END# *54E5C312006A_4683A2A102E6_impl*
//#UC START# *54E5C312006A_4683A2A102E6_var*
var
 l_Strings: Il3StringsEx;
 l_Index: Integer;
 l_Count: Integer;
//#UC END# *54E5C312006A_4683A2A102E6_var*
//#UC START# *54E5C744010C_4683A2A102E6_impl*
 inherited;
 if not CheckFromControl(l_Exception, l_Message, l_FirstDuplicate) then
  raise l_Exception.Create(l_FirstDuplicate, l_Message);
//#UC END# *54E5C744010C_4683A2A102E6_impl*
//#UC START# *54E5C744010C_4683A2A102E6_var*
var
 l_FirstDuplicate: IevEditorControlField;
 l_Exception: EaqExceptionClass;
 l_Message: AnsiString;
//#UC END# *54E5C744010C_4683A2A102E6_var*
//#UC START# *54E5C772012F_4683A2A102E6_impl*
 l_Req := Get_EditorReq;
 try
  while l_Req.FieldsCount > 1 do
   l_Req.DeleteField(nil, nil, true);
                            // ^ http://mdp.garant.ru/pages/viewpage.action?pageId=96483355&focusedCommentId=109511365#comment-109511365
  if Supports(l_Req.LastField, IevEditorFieldWithTree, l_TreeField) then
   try
    if evIsFieldSet(l_TreeField, True) then
    begin
     if Assigned(l_TreeField.DefaultNode) then
      l_TreeField.ShowNode(l_TreeField.DefaultNode)
     else
     begin
      //l_TreeField.ClearText; // mdp.garant.ru/pages/viewpage.action?pageId=528429019
      l_TreeFieldReq := l_TreeField.Req;
      if (l_TreeFieldReq <> nil) then
      begin
       l_T := l3CStr(l_TreeFieldReq.Para.AsObject.PCharLenA[k2_tiDefaultText]);
       l_TreeField.Text := l_T;
      end;
      // - http://mdp.garant.ru/pages/viewpage.action?pageId=604485227
     end;
     //l_Req.SetFocus(l_TreeField);
    end;//evIsFieldSet(l_TreeField, True)
   finally
    l_TreeField := nil;
   end;
  if Supports(l_Req, IevComboReq, l_ComboReq) then
   try
    l_ComboReq.ClearLogicValue;
   finally
    l_ComboReq := nil;
   end; 
 finally
  l_Req := nil;
 end; 
//#UC END# *54E5C772012F_4683A2A102E6_impl*
//#UC START# *54E5C772012F_4683A2A102E6_var*
var
 l_ComboReq: IevComboReq;
 l_Req: IevReq;
 l_TreeField: IevEditorFieldWithTree;
 l_TreeFieldReq: IevReq;
 l_T: Il3CString;
//#UC END# *54E5C772012F_4683A2A102E6_var*
//#UC START# *54E5D1D5002A_4683A2A102E6_impl*
 Result := inherited CheckFromControl(aExceptionClass, aMessage, aControl);
 if Result then
 begin
  // Проверим уникальность значений
  l_SList := TvcmStringList.Make;
  try
   for l_Index := 0 to Get_EditorReq.FieldsCount - 1 do
   begin
    l_CheckEditor := Get_EditorReq.Fields[l_Index];
    l_CheckValue := l_CheckEditor.Text;
    l_CheckEditor.ErrorColor := not l3IsNil(l_CheckValue) and (l_SList.IndexOf(l_CheckValue) <> -1);
    if l_CheckEditor.ErrorColor then
    begin
     if aControl = nil then
      aControl := l_CheckEditor;
    end
    else
     l_SList.Add(l_CheckValue);
   end;//for l_Index := 0
  finally
   l_SList := nil;
  end;//try..finally
  if Assigned(aControl) then
  begin
   Result := False;
   aExceptionClass := EqaDuplicateValue;
   aMessage := Format(vcmConstString(str_DuplicateValue), [nsEStr(aControl.Text)]);
  end;//Assigned(aControl)
 end;//Result
//#UC END# *54E5D1D5002A_4683A2A102E6_impl*
//#UC START# *54E5D1D5002A_4683A2A102E6_var*
var
 l_Index: Integer;
 l_SList: IvcmStrings;
 l_CheckEditor: IevEditorControlField;
 l_CheckValue: Il3CString;
//#UC END# *54E5D1D5002A_4683A2A102E6_var*
