//#UC START# *4728BE6A0392_474155B703C6get_impl*
 Result := f_PageNumber;
//#UC END# *4728BE6A0392_474155B703C6get_impl*
//#UC START# *4728BE6A0392_474155B703C6get_var*
//#UC END# *4728BE6A0392_474155B703C6get_var*
//#UC START# *4728BE830080_474155B703C6get_impl*
 Result := f_PageWidthNumber;
//#UC END# *4728BE830080_474155B703C6get_impl*
//#UC START# *4728BE830080_474155B703C6get_var*
//#UC END# *4728BE830080_474155B703C6get_var*
//#UC START# *473D824A0357_474155B703C6_impl*
 if (aPage <> nil) then
 begin
  if (f_WidthPages = nil) then
   f_WidthPages := TafwPreviewPageList.Make;
  f_WidthPages.Add(aPage);
 end;//aPage <> nil
//#UC END# *473D824A0357_474155B703C6_impl*
//#UC START# *473D824A0357_474155B703C6_var*
//#UC END# *473D824A0357_474155B703C6_var*
//#UC START# *473D826601A8_474155B703C6_impl*
 if (f_MetaFile <> nil) then
 begin
  {.$IfNDef nsTest}
  if aCounter then
  begin
   FreeAndNil(f_MetaFile);
   {$IfDef nsTest}
   if TafwPreviewPageSpy.Exists then
    TafwPreviewPageSpy.Instance.IncCounterNumber;
   {$EndIf nsTest}
  end
  else
  {.$EndIf  nsTest}
  if (f_DropStream = nil) then
  begin
   {$IfDef nsTest}
   if TafwPreviewPageSpy.Exists then
    TafwPreviewPageSpy.Instance.LogPage(Self, aCounter);
   {$EndIf nsTest}
   f_DropStream := TevDataCache.CreateTempStream;
   try
    l_Stream := f_DropStream.MakeForWrite;
    try
     MetaFile.SaveToIStream(l_Stream);
    finally
     l_Stream := nil;
    end;//try..finally
    FreeAndNil(f_MetaFile);
   except
    f_DropStream := nil;
    raise;
   end;//try..except
(*   {$IfDef nsTest}
   if (f_DropStream <> nil) then
   begin
    if TafwPreviewPageSpy.Exists then
     TafwPreviewPageSpy.Instance.LogPage(Self, aCounter);
    if aCounter then
     f_DropStream := nil;
   end;//f_DropStream <> nil
   {$EndIf nsTest}*)
  end//f_DropStream = nil
  else
   FreeAndNil(f_MetaFile);
 end;//f_MetaFile <> nil
 for l_Index := 1 to Pred(WidthCount) do
  WidthPage(l_Index).Drop(aCounter);
//#UC END# *473D826601A8_474155B703C6_impl*
//#UC START# *473D826601A8_474155B703C6_var*
var
 l_Stream : IStream;
 l_Index  : Integer;
//#UC END# *473D826601A8_474155B703C6_var*
//#UC START# *473D8274005E_474155B703C6_impl*
 f_PageNumber := aPageNumber;
 f_PageWidthNumber := aPageWidthNumber;
 f_OverallPageNumber := anOverallPageNumber;
//#UC END# *473D8274005E_474155B703C6_impl*
//#UC START# *473D8274005E_474155B703C6_var*
//#UC END# *473D8274005E_474155B703C6_var*
//#UC START# *473D828E03A5_474155B703C6_impl*
 Result := l3MulDiv(PHYSICALWIDTH, c_MMPerInch, LOGPIXELSX);
//#UC END# *473D828E03A5_474155B703C6_impl*
//#UC START# *473D828E03A5_474155B703C6_var*
//#UC END# *473D828E03A5_474155B703C6_var*
//#UC START# *473D82A102B2_474155B703C6_impl*
 Result := l3MulDiv(PHYSICALHEIGHT, c_MMPerInch, LOGPIXELSY);
//#UC END# *473D82A102B2_474155B703C6_impl*
//#UC START# *473D82A102B2_474155B703C6_var*
//#UC END# *473D82A102B2_474155B703C6_var*
//#UC START# *473D82B5021A_474155B703C6_impl*
 if (Metafile = nil) AND (f_DropStream <> nil) then
 begin
  f_Metafile := Tl3Metafile.Create;
  l_Stream := f_DropStream.MakeForRead;
  try
   f_Metafile.LoadFromIStream(l_Stream);
  finally
   l_Stream := nil;
  end;//try..finally
 end;//Metafile = nil
 if (MetaFile <> nil) then
 begin
  l_Rect.Left := (aRect.Right - aRect.Left)*PHYSICALOFFSETX div PHYSICALWIDTH + aRect.Left;
  l_Rect.Top := (aRect.Bottom - aRect.Top)*PHYSICALOFFSETY div PHYSICALHEIGHT + aRect.Top;
  l_Rect.Right := (aRect.Right - aRect.Left)*(PHYSICALOFFSETX + HORZRES) div PHYSICALWIDTH + 1 + aRect.Left;
  l_Rect.Bottom := (aRect.Bottom - aRect.Top)*(PHYSICALOFFSETY + VERTRES) div PHYSICALHEIGHT + 1 + aRect.Top;
  aBitmap.Canvas.StretchDraw(l_Rect, Metafile);
 end;//MetaFile <> nil
//#UC END# *473D82B5021A_474155B703C6_impl*
//#UC START# *473D82B5021A_474155B703C6_var*
var
 l_Rect   : TRect;
 l_Stream : IStream;
//#UC END# *473D82B5021A_474155B703C6_var*
//#UC START# *473D82CD0066_474155B703C6_impl*
 if (f_WidthPages = nil) then
  Result := 1
 else
  Result := f_WidthPages.Count + 1;
//#UC END# *473D82CD0066_474155B703C6_impl*
//#UC START# *473D82CD0066_474155B703C6_var*
//#UC END# *473D82CD0066_474155B703C6_var*
//#UC START# *473D82E20016_474155B703C6_impl*
 if (anIndex = 0) then
  Result := Self
 else
 if (f_WidthPages = nil) then
  Result := nil
 else
  Result := f_WidthPages[anIndex-1];
//#UC END# *473D82E20016_474155B703C6_impl*
//#UC START# *473D82E20016_474155B703C6_var*
//#UC END# *473D82E20016_474155B703C6_var*
//#UC START# *474155B703C6_ext:FileName
w:\common\components\gui\Garant\AFW\implementation\Visual\afwPreviewPage.pas
//#UC END# *474155B703C6_ext:FileName
//#UC START# *479731C50290_474155B703C6_impl*
 FreeAndNil(f_WidthPages);
 f_DropStream := nil;
 FreeAndNil(f_Metafile);
 inherited;
//#UC END# *479731C50290_474155B703C6_impl*
//#UC START# *479731C50290_474155B703C6_var*
//#UC END# *479731C50290_474155B703C6_var*
//#UC START# *47A6FEE600FC_474155B703C6_impl*
 Result := true;
//#UC END# *47A6FEE600FC_474155B703C6_impl*
//#UC START# *47A6FEE600FC_474155B703C6_var*
//#UC END# *47A6FEE600FC_474155B703C6_var*
//#UC START# *47DFDAB403DA_474155B703C6_impl*
 if (f_Metafile = nil) then
  f_Metafile := Tl3Metafile.Create;
 ReadDCMetrics(aCanvas);
 InitCanvas(aCanvas);
//#UC END# *47DFDAB403DA_474155B703C6_impl*
//#UC START# *47DFDAB403DA_474155B703C6_var*
//#UC END# *47DFDAB403DA_474155B703C6_var*
//#UC START# *47E0CA2E0263_474155B703C6_impl*
 if (aCanvas <> nil) then
  aCanvas.SetCanvas(TMetafileCanvas.Create(Metafile, aCanvas.DC), false);
//#UC END# *47E0CA2E0263_474155B703C6_impl*
//#UC START# *47E0CA2E0263_474155B703C6_var*
//#UC END# *47E0CA2E0263_474155B703C6_var*
//#UC START# *47E0CA4A006B_474155B703C6_impl*
 f_HORZRES := aCanvas.DeviceCaps(Windows.HORZRES);
 f_VERTRES := aCanvas.DeviceCaps(Windows.VERTRES);
 f_LOGPIXELSX := aCanvas.DeviceCaps(Windows.LOGPIXELSX);
 f_LOGPIXELSY := aCanvas.DeviceCaps(Windows.LOGPIXELSY);
 f_PHYSICALWIDTH := aCanvas.DeviceCaps(Windows.PHYSICALWIDTH);
 f_PHYSICALHEIGHT := aCanvas.DeviceCaps(Windows.PHYSICALHEIGHT);
 f_PHYSICALOFFSETX := aCanvas.DeviceCaps(Windows.PHYSICALOFFSETX);
 f_PHYSICALOFFSETY := aCanvas.DeviceCaps(Windows.PHYSICALOFFSETY);
//#UC END# *47E0CA4A006B_474155B703C6_impl*
//#UC START# *47E0CA4A006B_474155B703C6_var*
//#UC END# *47E0CA4A006B_474155B703C6_var*
//#UC START# *4CB6E48501B8_474155B703C6_impl*
 inherited Create;

 f_Metafile := nil;

 f_HORZRES := 0;
 f_VERTRES := 0;
 f_LOGPIXELSX := 0;
 f_LOGPIXELSY := 0;
 f_PHYSICALWIDTH := 0;
 f_PHYSICALHEIGHT := 0;
 f_PHYSICALOFFSETX := 0;
 f_PHYSICALOFFSETY := 0;
 Start(aCanvas);
//#UC END# *4CB6E48501B8_474155B703C6_impl*
//#UC START# *4CB6E48501B8_474155B703C6_var*
//#UC END# *4CB6E48501B8_474155B703C6_var*
//#UC START# *4CC68B5D00CA_474155B703C6get_impl*
 Result := f_OverallPageNumber;
//#UC END# *4CC68B5D00CA_474155B703C6get_impl*
//#UC START# *4CC68B5D00CA_474155B703C6get_var*
//#UC END# *4CC68B5D00CA_474155B703C6get_var*
