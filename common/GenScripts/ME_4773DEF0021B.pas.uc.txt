//#UC START# *478CF34E02CE_4773DEF0021B_impl*
 if (Source = nil) then
  Clear
 else
 if (Source Is Tl3PrimString) then
  AssignString(Tl3PrimString(Source))
 else
  inherited;
//#UC END# *478CF34E02CE_4773DEF0021B_impl*
//#UC START# *478CF34E02CE_4773DEF0021B_var*
//#UC END# *478CF34E02CE_4773DEF0021B_var*
//#UC START# *47A869D10074_4773DEF0021B_impl*
 Assert(false);
//#UC END# *47A869D10074_4773DEF0021B_impl*
//#UC START# *47A869D10074_4773DEF0021B_var*
//#UC END# *47A869D10074_4773DEF0021B_var*
//#UC START# *4A60B23E00C3_4773DEF0021B_impl*
 Result.SetOk;
 if IID.EQ(Il3CString) then
  Il3CString(Obj) := Tl3StringAdapter.MakeS(Self)
 else
 if IID.EQ(IStream) then
  IStream(Obj) := Tl3StringStream.Make(Self)
 else
  Result := inherited COMQueryInterface(IID, Obj);
//#UC END# *4A60B23E00C3_4773DEF0021B_impl*
//#UC START# *4A60B23E00C3_4773DEF0021B_var*
//#UC END# *4A60B23E00C3_4773DEF0021B_var*
//#UC START# *4E568A7E0120_4773DEF0021B_impl*
 l_S := AsWStr;
 AsWStr := l3PCharLen(l_S.S + Delta, l_S.SLen - Delta, l_S.SCodePage);
 Result := Self;
//#UC END# *4E568A7E0120_4773DEF0021B_impl*
//#UC START# *4E568A7E0120_4773DEF0021B_var*
var
 l_S: Tl3WString;  
//#UC END# *4E568A7E0120_4773DEF0021B_var*
//#UC START# *4E568AB6016C_4773DEF0021B_impl*
//#UC END# *4E568AB6016C_4773DEF0021B_impl*
//#UC START# *4E568AB6016C_4773DEF0021B_var*
//#UC END# *4E568AB6016C_4773DEF0021B_var*
//#UC START# *54C62FCA01B2_4773DEF0021Bget_impl*
 if (Self = nil) then
  Result := nil
 else
  Result := GetAsPCharLen.S;
//#UC END# *54C62FCA01B2_4773DEF0021Bget_impl*
//#UC START# *54C62FCA01B2_4773DEF0021Bget_var*
//#UC END# *54C62FCA01B2_4773DEF0021Bget_var*
//#UC START# *54C63008010F_4773DEF0021Bget_impl*
 if (Self = nil) then
  Result := 0
 else
  Result := GetAsPCharLen.SLen;
//#UC END# *54C63008010F_4773DEF0021Bget_impl*
//#UC START# *54C63008010F_4773DEF0021Bget_var*
//#UC END# *54C63008010F_4773DEF0021Bget_var*
//#UC START# *54C63008010F_4773DEF0021Bset_impl*
//#UC END# *54C63008010F_4773DEF0021Bset_impl*
//#UC START# *54C63008010F_4773DEF0021Bset_var*
//#UC END# *54C63008010F_4773DEF0021Bset_var*
//#UC START# *54C6307003BB_4773DEF0021Bget_impl*
 Result := AsPCharLen.SCodePage;
//#UC END# *54C6307003BB_4773DEF0021Bget_impl*
//#UC START# *54C6307003BB_4773DEF0021Bget_var*
//#UC END# *54C6307003BB_4773DEF0021Bget_var*
//#UC START# *54C6307003BB_4773DEF0021Bset_impl*
 if (Self <> nil) then
  DoSetCodePage(aValue);
//#UC END# *54C6307003BB_4773DEF0021Bset_impl*
//#UC START# *54C6307003BB_4773DEF0021Bset_var*
//#UC END# *54C6307003BB_4773DEF0021Bset_var*
//#UC START# *54C630BC0157_4773DEF0021Bget_impl*
 Result := l3IsOEM(CodePage);
//#UC END# *54C630BC0157_4773DEF0021Bget_impl*
//#UC START# *54C630BC0157_4773DEF0021Bget_var*
//#UC END# *54C630BC0157_4773DEF0021Bget_var*
//#UC START# *54C630DC0134_4773DEF0021Bget_impl*
 Result := l3IsOEMEx(CodePage);
//#UC END# *54C630DC0134_4773DEF0021Bget_impl*
//#UC START# *54C630DC0134_4773DEF0021Bget_var*
//#UC END# *54C630DC0134_4773DEF0021Bget_var*
//#UC START# *54C631160124_4773DEF0021Bget_impl*
 Result := l3IsANSI(CodePage);
//#UC END# *54C631160124_4773DEF0021Bget_impl*
//#UC START# *54C631160124_4773DEF0021Bget_var*
//#UC END# *54C631160124_4773DEF0021Bget_var*
//#UC START# *54C6321A0320_4773DEF0021Bget_impl*
 if (Self = nil) then
  l3AssignNil(Result)
 else
  Tl3WString(Result) := GetAsPCharLen;
//#UC END# *54C6321A0320_4773DEF0021Bget_impl*
//#UC START# *54C6321A0320_4773DEF0021Bget_var*
//#UC END# *54C6321A0320_4773DEF0021Bget_var*
//#UC START# *54C6321A0320_4773DEF0021Bset_impl*
 if (Self <> nil) then
  DoSetAsPCharLen(aValue);
//#UC END# *54C6321A0320_4773DEF0021Bset_impl*
//#UC START# *54C6321A0320_4773DEF0021Bset_var*
//#UC END# *54C6321A0320_4773DEF0021Bset_var*
//#UC START# *54C63409007E_4773DEF0021Bget_impl*
 if not Empty then
  Result := Ch[0]
 else
  Result := #0;
//#UC END# *54C63409007E_4773DEF0021Bget_impl*
//#UC START# *54C63409007E_4773DEF0021Bget_var*
//#UC END# *54C63409007E_4773DEF0021Bget_var*
//#UC START# *54C6352E0043_4773DEF0021Bget_impl*
 if not Empty then
  Result := Ch[Pred(Len)]
 else
  Result := #0;
//#UC END# *54C6352E0043_4773DEF0021Bget_impl*
//#UC START# *54C6352E0043_4773DEF0021Bget_var*
//#UC END# *54C6352E0043_4773DEF0021Bget_var*
//#UC START# *54C6356B0095_4773DEF0021Bget_impl*
 l_S := AsPCharLen;
 if (l_S.S <> nil) AND (aPos >= 0) AND (aPos < l_S.SLen) then
 begin
  if (l_S.SCodePage = CP_Unicode) then
   Result := AnsiChar(PWideChar(l_S.S)[aPos])
  else
   Result := l_S.S[aPos];
 end//S <> nil
 else
  Result := #0;
//#UC END# *54C6356B0095_4773DEF0021Bget_impl*
//#UC START# *54C6356B0095_4773DEF0021Bget_var*
var
 l_S : Tl3WString;
//#UC END# *54C6356B0095_4773DEF0021Bget_var*
//#UC START# *54C6356B0095_4773DEF0021Bset_impl*
 if (aPos >= 0) then
 begin
  l_S := GetAsPCharLen;
  if (l_S.S <> nil) AND (aPos < l_S.SLen) then
  begin
   if (l_S.SCodePage = CP_Unicode) then
    PWideChar(l_S.S)[aPos] := WideChar(aValue)
   else
    l_S.S[aPos] := aValue;
   CheckUnicode; 
  end//S <> nil
  else
   Insert(l3PCharLen(@aValue, 1, CodePage), aPos);
 end;{aPos >= 0}
//#UC END# *54C6356B0095_4773DEF0021Bset_impl*
//#UC START# *54C6356B0095_4773DEF0021Bset_var*
var
 l_S : Tl3WString;
//#UC END# *54C6356B0095_4773DEF0021Bset_var*
//#UC START# *54C6360A0301_4773DEF0021Bget_impl*
 if Empty then
  Result := 0
 else
  Result := l3RTrim(AsPCharLen).SLen;
//#UC END# *54C6360A0301_4773DEF0021Bget_impl*
//#UC START# *54C6360A0301_4773DEF0021Bget_var*
//#UC END# *54C6360A0301_4773DEF0021Bget_var*
//#UC START# *54C6365D02F7_4773DEF0021Bget_impl*
 if Empty then
  Result := 0
 else
  Result := l3LTrim(Self.AsWStr).SLen;
//#UC END# *54C6365D02F7_4773DEF0021Bget_impl*
//#UC START# *54C6365D02F7_4773DEF0021Bget_var*
//#UC END# *54C6365D02F7_4773DEF0021Bget_var*
//#UC START# *54C63686017E_4773DEF0021Bget_impl*
 Result := Ch[0];
//#UC END# *54C63686017E_4773DEF0021Bget_impl*
//#UC START# *54C63686017E_4773DEF0021Bget_var*
//#UC END# *54C63686017E_4773DEF0021Bget_var*
//#UC START# *54C63686017E_4773DEF0021Bset_impl*
 AsPCharLen := l3PCharLen(@aValue, 1, CodePage);
//#UC END# *54C63686017E_4773DEF0021Bset_impl*
//#UC START# *54C63686017E_4773DEF0021Bset_var*
//#UC END# *54C63686017E_4773DEF0021Bset_var*
//#UC START# *54C636F400CA_4773DEF0021Bget_impl*
 Result := PWideChar(St);
//#UC END# *54C636F400CA_4773DEF0021Bget_impl*
//#UC START# *54C636F400CA_4773DEF0021Bget_var*
//#UC END# *54C636F400CA_4773DEF0021Bget_var*
//#UC START# *54C636F400CA_4773DEF0021Bset_impl*
 AsPCharLen := l3PCharLen(PAnsiChar(aValue), -1, CP_Unicode);
//#UC END# *54C636F400CA_4773DEF0021Bset_impl*
//#UC START# *54C636F400CA_4773DEF0021Bset_var*
//#UC END# *54C636F400CA_4773DEF0021Bset_var*
//#UC START# *54C637680235_4773DEF0021Bget_impl*
 {$IfDef XE4}
 l_S := AsPCharLen;
 Result := Tl3Str(l_S).AsWideString;
 {$Else  XE4}
 Result := Tl3Str(AsPCharLen).AsWideString;
 {$EndIf XE4}
//#UC END# *54C637680235_4773DEF0021Bget_impl*
//#UC START# *54C637680235_4773DEF0021Bget_var*
{$IfDef XE4}
var
 l_S : Tl3PCharLen;
{$EndIf XE4}
//#UC END# *54C637680235_4773DEF0021Bget_var*
//#UC START# *54C637680235_4773DEF0021Bset_impl*
 AsPCharLen := l3PCharLen(aValue);
//#UC END# *54C637680235_4773DEF0021Bset_impl*
//#UC START# *54C637680235_4773DEF0021Bset_var*
//#UC END# *54C637680235_4773DEF0021Bset_var*
//#UC START# *54C6388203A0_4773DEF0021B_impl*
 l_W := GetAsPCharLen;
 if (l_W.SCodePage = CP_Unicode) then
 begin
  for l_Index := Low(cCodePages) to High(cCodePages) do
  begin
   l_S.Init(l_W, cCodePages[l_Index]);
   try
    if l3Same(l_W, l_S) then
    begin
     CodePage := cCodePages[l_Index];
     break;
    end;//l3Same(l_S, l_S)
   finally
    l_S.Clear;
   end;//try..finally
  end;//for l_Index
 end;//l_W.SCodePage = CP_Unicode
//#UC END# *54C6388203A0_4773DEF0021B_impl*
//#UC START# *54C6388203A0_4773DEF0021B_var*
const
 cCodePages : array [0..7] of Integer = (CP_RussianWin, CP_EastEurope, CP_Greek, CP_Turkish, CP_WesternWin, CP_Tatar, CP_TatarOEM, CP_RussianDOS);
var
 l_Index: Integer;
 l_S: Tl3Str;
 l_W: Tl3WString;
//#UC END# *54C6388203A0_4773DEF0021B_var*
//#UC START# *54C639280275_4773DEF0021B_impl*
 if (O2 > O1) then L := O2 - O1 else L := 0;
 if aCodePage = CP_Unicode then
  O1 := O1 * SizeOf(WideChar);
 AsPCharLen := l3PCharLen(aSt + O1, L, aCodePage);
 Result := Self;
//#UC END# *54C639280275_4773DEF0021B_impl*
//#UC START# *54C639280275_4773DEF0021B_var*
var
 L : Integer;
//#UC END# *54C639280275_4773DEF0021B_var*
//#UC START# *54C6397F033C_4773DEF0021B_impl*
 Insert(l3PCharLen(@aCh, 1, aCodePage), 0, aRepeat);
//#UC END# *54C6397F033C_4773DEF0021B_impl*
//#UC START# *54C6397F033C_4773DEF0021B_var*
//#UC END# *54C6397F033C_4773DEF0021B_var*
//#UC START# *54C639EC034A_4773DEF0021B_impl*
//#UC END# *54C639EC034A_4773DEF0021B_impl*
//#UC START# *54C639EC034A_4773DEF0021B_var*
//#UC END# *54C639EC034A_4773DEF0021B_var*
//#UC START# *54C63A210201_4773DEF0021B_impl*
 Append(l3PCharLen(@aCh.rWC, 1, aCh.rCodePage), aRepeat);
//#UC END# *54C63A210201_4773DEF0021B_impl*
//#UC START# *54C63A210201_4773DEF0021B_var*
//#UC END# *54C63A210201_4773DEF0021B_var*
//#UC START# *54C63A550261_4773DEF0021B_impl*
 Append(l3PCharLen(@aCh, 1, aCodePage), aRepeat);
//#UC END# *54C63A550261_4773DEF0021B_impl*
//#UC START# *54C63A550261_4773DEF0021B_var*
//#UC END# *54C63A550261_4773DEF0021B_var*
//#UC START# *54C63A9901CE_4773DEF0021B_impl*
 l3SayConstString;
//#UC END# *54C63A9901CE_4773DEF0021B_impl*
//#UC START# *54C63A9901CE_4773DEF0021B_var*
//#UC END# *54C63A9901CE_4773DEF0021B_var*
//#UC START# *54C63AD303DA_4773DEF0021B_impl*
 Insert(l3PCharLen(PAnsiChar(@aCh), 1), aPos, aRepeat);
//#UC END# *54C63AD303DA_4773DEF0021B_impl*
//#UC START# *54C63AD303DA_4773DEF0021B_var*
//#UC END# *54C63AD303DA_4773DEF0021B_var*
//#UC START# *54C63AF80344_4773DEF0021B_impl*
 if not S.Empty then
  Insert(S.AsPCharLen, aPos, aRepeat);
//#UC END# *54C63AF80344_4773DEF0021B_impl*
//#UC START# *54C63AF80344_4773DEF0021B_var*
//#UC END# *54C63AF80344_4773DEF0021B_var*
//#UC START# *54C63B82016A_4773DEF0021B_impl*
 LTrim;
 Result := RTrim;
//#UC END# *54C63B82016A_4773DEF0021B_impl*
//#UC START# *54C63B82016A_4773DEF0021B_var*
//#UC END# *54C63B82016A_4773DEF0021B_var*
//#UC START# *54C63BA70371_4773DEF0021B_impl*
 Result := Trim.DeleteDoubleSpace;
//#UC END# *54C63BA70371_4773DEF0021B_impl*
//#UC START# *54C63BA70371_4773DEF0021B_var*
//#UC END# *54C63BA70371_4773DEF0021B_var*
//#UC START# *54C63BCF01AC_4773DEF0021B_impl*
 Assert(false);
//#UC END# *54C63BCF01AC_4773DEF0021B_impl*
//#UC START# *54C63BCF01AC_4773DEF0021B_var*
//#UC END# *54C63BCF01AC_4773DEF0021B_var*
//#UC START# *54C63BEF0044_4773DEF0021B_impl*
 if not Empty then
 begin
  Len := l3RTrim(AsPCharLen).SLen;
  if Empty then Clear;
 end;//not Empty
 Result := Self;
//#UC END# *54C63BEF0044_4773DEF0021B_impl*
//#UC START# *54C63BEF0044_4773DEF0021B_var*
//#UC END# *54C63BEF0044_4773DEF0021B_var*
//#UC START# *54C63C5E0104_4773DEF0021B_impl*
 while (Len > 0) and (St[Pred(Len)] in [cc_SoftEnter, cc_HardEnter, cc_Null]) do
  Len := Pred(Len);
//#UC END# *54C63C5E0104_4773DEF0021B_impl*
//#UC START# *54C63C5E0104_4773DEF0021B_var*
//#UC END# *54C63C5E0104_4773DEF0021B_var*
//#UC START# *54C63C7C01C4_4773DEF0021B_impl*
 Result := Self;
//#UC END# *54C63C7C01C4_4773DEF0021B_impl*
//#UC START# *54C63C7C01C4_4773DEF0021B_var*
//#UC END# *54C63C7C01C4_4773DEF0021B_var*
//#UC START# *54C63CAA03E0_4773DEF0021B_impl*
 Result := 0;
 l_Pos := 0;
 while true do
 begin
  l_Pos := FindChar(l_Pos, aChar);
  if (l_Pos < 0) then
   break
  else
  begin
   Delete(l_Pos, 1);
   Inc(Result);
  end;//l_Pos < 0
 end;//while true
//#UC END# *54C63CAA03E0_4773DEF0021B_impl*
//#UC START# *54C63CAA03E0_4773DEF0021B_var*
var
 l_Pos : Integer;
//#UC END# *54C63CAA03E0_4773DEF0021B_var*
//#UC START# *54C63CED01C7_4773DEF0021B_impl*
 Result := Self;
 l3SayConstString;
//#UC END# *54C63CED01C7_4773DEF0021B_impl*
//#UC START# *54C63CED01C7_4773DEF0021B_var*
//#UC END# *54C63CED01C7_4773DEF0021B_var*
//#UC START# *54C63EA70259_4773DEF0021B_impl*
 if Empty OR (Pos >= Len) then
  Result := -1
 else
 begin
  P := St;
  P1 := ev_lpScan(C, P + Pos, Len - Pos);
  if (P1 = nil) then
   Result := -1
  else
   Result := (P1 - P);
 end;//Empty.. 
//#UC END# *54C63EA70259_4773DEF0021B_impl*
//#UC START# *54C63EA70259_4773DEF0021B_var*
var
 P, P1 : PAnsiChar;
//#UC END# *54C63EA70259_4773DEF0021B_var*
//#UC START# *54C63F2D0242_4773DEF0021B_impl*
 l_S := AsPCharLen;
 aSt.AsPCharLen := l3FindChar(C, l_S);
 if not aSt.Empty then
  Len := l_S.SLen;
//#UC END# *54C63F2D0242_4773DEF0021B_impl*
//#UC START# *54C63F2D0242_4773DEF0021B_var*
var
 l_S : Tl3PCharLen;
//#UC END# *54C63F2D0242_4773DEF0021B_var*
//#UC START# *54C63F5400AC_4773DEF0021B_impl*
 if Empty then
  Result := 0
 else
  Result := ev_lpIndent(St, Len);
//#UC END# *54C63F5400AC_4773DEF0021B_impl*
//#UC START# *54C63F5400AC_4773DEF0021B_var*
//#UC END# *54C63F5400AC_4773DEF0021B_var*
//#UC START# *54C63F7801B0_4773DEF0021B_impl*
 l_S := AsPCharLen;
 if (l_S.SCodePage = CP_Unicode) then
  l3FillChar(BT, SizeOf(BT))
 else
  l3BMSearch.BMMakeTable(l_S.S, BT, l_S.SLen);
//#UC END# *54C63F7801B0_4773DEF0021B_impl*
//#UC START# *54C63F7801B0_4773DEF0021B_var*
var
 l_S : Tl3PCharLen;
//#UC END# *54C63F7801B0_4773DEF0021B_var*
//#UC START# *54C63FB802C8_4773DEF0021B_impl*
 l_S := S.AsPCharLen;
 l_SS := AsPCharLen;
 if l3IsNil(l_SS) then
  Result := false
 else
  Result := l3SearchStr(l_S, BT, l_SS, Pos);
//#UC END# *54C63FB802C8_4773DEF0021B_impl*
//#UC START# *54C63FB802C8_4773DEF0021B_var*
var
 l_S  : Tl3PCharLen;
 l_SS : Tl3PCharLen;
//#UC END# *54C63FB802C8_4773DEF0021B_var*
//#UC START# *54C63FE7008C_4773DEF0021B_impl*
 l_S := S.AsPCharLen;
 l_SS := AsPCharLen;
 if l3IsNil(l_SS) then
  Result := false
 else
  Result := l3SearchStrUC(l_S, BT, l_SS, Pos);
//#UC END# *54C63FE7008C_4773DEF0021B_impl*
//#UC START# *54C63FE7008C_4773DEF0021B_var*
var
 l_S  : Tl3PCharLen;
 l_SS : Tl3PCharLen;
//#UC END# *54C63FE7008C_4773DEF0021B_var*
//#UC START# *54C640230216_4773DEF0021B_impl*
 l3MakeUpperCase(St, Len, CodePage);
//#UC END# *54C640230216_4773DEF0021B_impl*
//#UC START# *54C640230216_4773DEF0021B_var*
//#UC END# *54C640230216_4773DEF0021B_var*
//#UC START# *54C64032026A_4773DEF0021B_impl*
 l3MakeLowerCase(St, Len, CodePage);
//#UC END# *54C64032026A_4773DEF0021B_impl*
//#UC START# *54C64032026A_4773DEF0021B_var*
//#UC END# *54C64032026A_4773DEF0021B_var*
//#UC START# *54C640510217_4773DEF0021B_impl*
 Result := St;
//#UC END# *54C640510217_4773DEF0021B_impl*
//#UC START# *54C640510217_4773DEF0021B_var*
//#UC END# *54C640510217_4773DEF0021B_var*
//#UC START# *54C640BB0399_4773DEF0021B_impl*
 AsPCharLen := l3PCharLen(aStr, aLen, CodePage);
//#UC END# *54C640BB0399_4773DEF0021B_impl*
//#UC START# *54C640BB0399_4773DEF0021B_var*
//#UC END# *54C640BB0399_4773DEF0021B_var*
//#UC START# *54C641A901E6_4773DEF0021B_impl*
 Result := -1;
//#UC END# *54C641A901E6_4773DEF0021B_impl*
//#UC START# *54C641A901E6_4773DEF0021B_var*
//#UC END# *54C641A901E6_4773DEF0021B_var*
//#UC START# *54C68EF4028F_4773DEF0021B_impl*
 raise Exception.Create('Данный тип строки не может быть модифицирован');
//#UC END# *54C68EF4028F_4773DEF0021B_impl*
//#UC START# *54C68EF4028F_4773DEF0021B_var*
//#UC END# *54C68EF4028F_4773DEF0021B_var*
