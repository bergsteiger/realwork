//#UC START# *49803F5503AA_4C7E4A45018F_impl*
 inherited;
 f_SortTypeMap := nsIntegerMapManager.Map[imap_UnderControlSortType];
//#UC END# *49803F5503AA_4C7E4A45018F_impl*
//#UC START# *49803F5503AA_4C7E4A45018F_var*
//#UC END# *49803F5503AA_4C7E4A45018F_var*
//#UC START# *49EDFA3701B0_4C7E4A45018Ftest_impl*
 aParams.Op.Flag[vcm_ofEnabled] := False;
//#UC END# *49EDFA3701B0_4C7E4A45018Ftest_impl*
//#UC START# *49EDFA3701B0_4C7E4A45018Ftest_var*
//#UC END# *49EDFA3701B0_4C7E4A45018Ftest_var*
//#UC START# *4C7D0C7B0185_4C7E4A45018Ftest_impl*
 aParams.Op.Flag[vcm_ofEnabled] := False;
//#UC END# *4C7D0C7B0185_4C7E4A45018Ftest_impl*
//#UC START# *4C7D0C7B0185_4C7E4A45018Ftest_var*
//#UC END# *4C7D0C7B0185_4C7E4A45018Ftest_var*
//#UC START# *4C7D0CC90052_4C7E4A45018Fexec_impl*
 with UnderControlList.TreeView.Tree do
 begin
  if (SelectedCount > 0) then
  begin
   if (SelectedCount > 1) then
    l_Desision := Ask(qr_RemoveControlStatus)
   else
    l_Desision := Ask(qr_RemoveDocumentFromControl);

   if l_Desision then
   begin
    Changing;
    try
     repeat
      l_Node := GetNextSelected(Root);
      if Assigned(l_Node) then
       l_Node.Delete
      else
       break;
     until false;

     if Supports(UserFoldersTree.ControlledObj, InsControlledList, l_List) then
      l_List.AddFakeNode;
    finally
     Changed;
    end;//try..finally
   end;
  end
 end;
//#UC END# *4C7D0CC90052_4C7E4A45018Fexec_impl*
//#UC START# *4C7D0CC90052_4C7E4A45018Fexec_var*
var
 l_Node: IeeNode;
 l_Desision: Boolean;
 l_List: InsControlledList;
//#UC END# *4C7D0CC90052_4C7E4A45018Fexec_var*
//#UC START# *4C7D0CC90052_4C7E4A45018Fgetstate_impl*
 State := st_user_Edit_Delete_Controlled;
//#UC END# *4C7D0CC90052_4C7E4A45018Fgetstate_impl*
//#UC START# *4C7D0CC90052_4C7E4A45018Fgetstate_var*
//#UC END# *4C7D0CC90052_4C7E4A45018Fgetstate_var*
//#UC START# *4C7D0CC90052_4C7E4A45018Ftest_impl*
 enControlCenterNullListTest(aParams);
//#UC END# *4C7D0CC90052_4C7E4A45018Ftest_impl*
//#UC START# *4C7D0CC90052_4C7E4A45018Ftest_var*
//#UC END# *4C7D0CC90052_4C7E4A45018Ftest_var*
//#UC START# *4C7E4A45018Fimpl_uses*
//#UC END# *4C7E4A45018Fimpl_uses*
//#UC START# *4C7E4B830292_4C7E4A45018Fexec_impl*
 TvcmModulesFactories.SelectOpen(Self.as_IvcmEntityForm,
                      TnsFolderFilterInfo.Make(ffNone, ns_ffDocument),
                      str_SetToControl);
//#UC END# *4C7E4B830292_4C7E4A45018Fexec_impl*
//#UC START# *4C7E4B830292_4C7E4A45018Fexec_var*
//#UC END# *4C7E4B830292_4C7E4A45018Fexec_var*
//#UC START# *4C7E4BA000A6_4C7E4A45018Fexec_impl*
 TvcmModulesFactories.BuildUnderControlList((aParams As IvcmExecuteParams).Container);
//#UC END# *4C7E4BA000A6_4C7E4A45018Fexec_impl*
//#UC START# *4C7E4BA000A6_4C7E4A45018Fexec_var*
//#UC END# *4C7E4BA000A6_4C7E4A45018Fexec_var*
//#UC START# *4C7E4BA000A6_4C7E4A45018Ftest_impl*
 EnControlCenterNullListTest(aParams);
//#UC END# *4C7E4BA000A6_4C7E4A45018Ftest_impl*
//#UC START# *4C7E4BA000A6_4C7E4A45018Ftest_var*
//#UC END# *4C7E4BA000A6_4C7E4A45018Ftest_var*
//#UC START# *4C7E4BB800D4_4C7E4A45018Fexec_impl*
 l_UnderControlInfo := UnderControlInfo;
 if (l_UnderControlInfo <> nil) then
  try
   l_UnderControlInfo.SortType := TnsUCSortType(f_SortTypeMap.DisplayNameToValue(aParams.SelectedString));
  finally
   l_UnderControlInfo := nil;
  end;//try..finally
//#UC END# *4C7E4BB800D4_4C7E4A45018Fexec_impl*
//#UC START# *4C7E4BB800D4_4C7E4A45018Fexec_var*
var
 l_UnderControlInfo : InsUnderControlInfo;
//#UC END# *4C7E4BB800D4_4C7E4A45018Fexec_var*
//#UC START# *4C7E4BB800D4_4C7E4A45018Ftest_impl*
 l_UnderControlInfo := UnderControlInfo;
 if (l_UnderControlInfo <> nil) then
  try
   aParams.Op.Flag[vcm_ofEnabled] := True;
   l_Strings := aParams.Op.SubItems;
   if (l_Strings <> nil) then
   begin
    aParams.Op.SelectedString := f_SortTypeMap.
     ValueToDisplayName(Ord(l_UnderControlInfo.SortType));
    if l_Strings.Count = 0 then
    if Supports(f_SortTypeMap, InsStringsSource, l_StringSource) then
     l_StringSource.FillStrings(l_Strings);
   end;//l_Strings <> nil
  finally
   l_UnderControlInfo := nil;
  end//try..finally
 else
  aParams.Op.Flag[vcm_ofEnabled] := False;
//#UC END# *4C7E4BB800D4_4C7E4A45018Ftest_impl*
//#UC START# *4C7E4BB800D4_4C7E4A45018Ftest_var*
var
 l_Strings: IvcmStrings;
 l_UnderControlInfo: InsUnderControlInfo;
 l_StringSource: InsStringsSource;
//#UC END# *4C7E4BB800D4_4C7E4A45018Ftest_var*
//#UC START# *4C7E4BD301B7_4C7E4A45018Fexec_impl*
 if IsChangeObjects and Ask(qr_DropChangeStatusAllObjects) then
  UnderControlList.TreeView.Tree.Root.IterateF(eeL2NA(@DropStatus));
//#UC END# *4C7E4BD301B7_4C7E4A45018Fexec_impl*
//#UC START# *4C7E4BD301B7_4C7E4A45018Fexec_var*

 function DropStatus(const anIntf: IeeNode) : Boolean;
 var
  l_UCNode  : InsUnderControlNode;
 begin
  Result := False;
  if Supports(anIntf, InsUnderControlNode, l_UCNode) then
   try
    l_UCNode.ResetStatus;
   finally
    l_UCNode := nil;
   end;
 end;

//#UC END# *4C7E4BD301B7_4C7E4A45018Fexec_var*
//#UC START# *4C7E4BD301B7_4C7E4A45018Ftest_impl*
 EnControlCenterNullListTest(aParams);
//#UC END# *4C7E4BD301B7_4C7E4A45018Ftest_impl*
//#UC START# *4C7E4BD301B7_4C7E4A45018Ftest_var*
//#UC END# *4C7E4BD301B7_4C7E4A45018Ftest_var*
//#UC START# *4C7E4C3001B6_4C7E4A45018Fexec_impl*
 OpenControllableElement(self.as_IvcmEntityForm, UnderControlList.GetCurrentNode,
  vcm_okInCurrentTab);
//#UC END# *4C7E4C3001B6_4C7E4A45018Fexec_impl*
//#UC START# *4C7E4C3001B6_4C7E4A45018Fexec_var*
//#UC END# *4C7E4C3001B6_4C7E4A45018Fexec_var*
//#UC START# *4C7E4C3001B6_4C7E4A45018Ftest_impl*
 EnControlCenterNullListTest(aParams);
//#UC END# *4C7E4C3001B6_4C7E4A45018Ftest_impl*
//#UC START# *4C7E4C3001B6_4C7E4A45018Ftest_var*
//#UC END# *4C7E4C3001B6_4C7E4A45018Ftest_var*
//#UC START# *4C7E4C470330_4C7E4A45018Fexec_impl*
 with UnderControlList.TreeView do
 begin
  if Tree.SelectedCount > 1 then
  begin
   if Ask(qr_DropChangeStatusToSelected) then
    with Tree do
    begin
     Changing;
     try
      l_Node := Root;
      repeat
       l_Node := GetNextSelected(l_Node);
       if Assigned(l_Node) then
        ResetElementStatus(l_Node)
       else
        break;
      until false;
     finally
      Changed;
     end;//try..finally
    end;
  end
  else
   ResetElementStatus(CurrentNode);
 end;
//#UC END# *4C7E4C470330_4C7E4A45018Fexec_impl*
//#UC START# *4C7E4C470330_4C7E4A45018Fexec_var*
var
 l_Node : IeeNode;
//#UC END# *4C7E4C470330_4C7E4A45018Fexec_var*
//#UC START# *4C7E4C470330_4C7E4A45018Ftest_impl*
 with UnderControlList.TreeView do
  if Tree.SelectedCount > 1 then
   aParams.Op.Flag[vcm_ofEnabled] := True
  else
   aParams.Op.Flag[vcm_ofEnabled] := IsObjectChanged(CurrentNode);
//#UC END# *4C7E4C470330_4C7E4A45018Ftest_impl*
//#UC START# *4C7E4C470330_4C7E4A45018Ftest_var*
//#UC END# *4C7E4C470330_4C7E4A45018Ftest_var*
//#UC START# *4C7E4FB400A8_4C7E4A45018Fget_impl*
 Supports(UnderControlList.TreeStruct, InsUnderControlInfo, Result);
//#UC END# *4C7E4FB400A8_4C7E4A45018Fget_impl*
//#UC START# *4C7E4FB400A8_4C7E4A45018Fget_var*
//#UC END# *4C7E4FB400A8_4C7E4A45018Fget_var*
//#UC START# *4C7E584D02A3_4C7E4A45018F_impl*
 with aParams do
 begin
  if (UnderControlList.TreeView.Tree.SelectedCount >= 1) then
   Op.Flag[vcm_ofEnabled] := Supports(UnderControlList.TreeView.CurrentNode, InsUnderControlNode)
  else
   Op.Flag[vcm_ofEnabled] := False;
 end;
//#UC END# *4C7E584D02A3_4C7E4A45018F_impl*
//#UC START# *4C7E584D02A3_4C7E4A45018F_var*
//#UC END# *4C7E584D02A3_4C7E4A45018F_var*
