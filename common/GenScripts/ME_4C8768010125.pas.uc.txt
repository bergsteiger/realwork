//#UC START# *495235F401C0_4C8768010125exec_impl*
 with GetSaveDialog do
 begin
  l_FileExt := ExtractFileExt(FileName);

  if ((StrIComp(PChar(l_FileExt), '.bmp') = 0) or
      (StrIComp(PChar(l_FileExt), '.jpg') = 0) or
      (StrIComp(PChar(l_FileExt), '.gif') = 0))
  then
   FileName := ChangeFileExt(FileName, ''); // cleanup file extension

  if Execute then
  try
   case FilterIndex of
    1: ieIO.SaveToFileBMP(ChangeFileExt(FileName, '.bmp'));
    2: ieIO.SaveToFileJpeg(ChangeFileExt(FileName, '.jpg'));
    3: ieIO.SaveToFileGif(ChangeFileExt(FileName, '.gif'));
   end;
  except
   on EFCreateError do
   begin
    if Windows.GetLastError = ERROR_ACCESS_DENIED then
     Say(err_CannotCreateFile, [ExtractFileName(FileName)])
    else
     raise;
   end;//on EFCreateError do
  end;{try..except}
 end;//with GetSaveDialog do
//#UC END# *495235F401C0_4C8768010125exec_impl*
//#UC START# *495235F401C0_4C8768010125exec_var*
var
 l_FileExt: string;
//#UC END# *495235F401C0_4C8768010125exec_var*
//#UC START# *495235F401C0_4C8768010125test_impl*
 //nsDisableOperationInTrialMode(aParams);
 aParams.Op.Flag[vcm_ofEnabled] := True;
//#UC END# *495235F401C0_4C8768010125test_impl*
//#UC START# *495235F401C0_4C8768010125test_var*
//#UC END# *495235F401C0_4C8768010125test_var*
//#UC START# *4C762C910358_4C8768010125exec_impl*
 if IsModalForm then
  ModalResult := mrCancel
 else
  Dispatcher.History.Back;
//#UC END# *4C762C910358_4C8768010125exec_impl*
//#UC START# *4C762C910358_4C8768010125exec_var*
//#UC END# *4C762C910358_4C8768010125exec_var*
//#UC START# *4C762C910358_4C8768010125getstate_impl*
 State := st_user_Result_Cancel_Close;
//#UC END# *4C762C910358_4C8768010125getstate_impl*
//#UC START# *4C762C910358_4C8768010125getstate_var*
//#UC END# *4C762C910358_4C8768010125getstate_var*
//#UC START# *4C7B9EBC01AC_4C8768010125exec_impl*
 TdmStdRes.OpenPictureInfo(nil, f_Info);
//#UC END# *4C7B9EBC01AC_4C8768010125exec_impl*
//#UC START# *4C7B9EBC01AC_4C8768010125exec_var*
//#UC END# *4C7B9EBC01AC_4C8768010125exec_var*
//#UC START# *4C7B9EBC01AC_4C8768010125getstate_impl*
 State := st_user_Document_GetAttributesFrmAct_Picture;
//#UC END# *4C7B9EBC01AC_4C8768010125getstate_impl*
//#UC START# *4C7B9EBC01AC_4C8768010125getstate_var*
//#UC END# *4C7B9EBC01AC_4C8768010125getstate_var*
//#UC START# *4C7B9EBC01AC_4C8768010125test_impl*
 aParams.Op.Flag[vcm_ofEnabled] := afw.Application.IsInternal and
                                   Assigned(f_Info);
//#UC END# *4C7B9EBC01AC_4C8768010125test_impl*
//#UC START# *4C7B9EBC01AC_4C8768010125test_var*
//#UC END# *4C7B9EBC01AC_4C8768010125test_var*
//#UC START# *4C7D0C7B0185_4C8768010125exec_impl*
 ieProc.CopyToClipboard;
//#UC END# *4C7D0C7B0185_4C8768010125exec_impl*
//#UC START# *4C7D0C7B0185_4C8768010125exec_var*
//#UC END# *4C7D0C7B0185_4C8768010125exec_var*
//#UC START# *4C7D0C7B0185_4C8768010125test_impl*
 //nsDisableOperationInTrialMode(aParams);
 aParams.Op.Flag[vcm_ofEnabled] := True; 
//#UC END# *4C7D0C7B0185_4C8768010125test_impl*
//#UC START# *4C7D0C7B0185_4C8768010125test_var*
//#UC END# *4C7D0C7B0185_4C8768010125test_var*
//#UC START# *4C876C1F014C_4C8768010125exec_impl*
 if l3IsNil(aParams.SelectedString) then
  Exit;
 if l3Same(f_ValueMap.SpecialDisplayName, aParams.SelectedString)then
  FitInWindow
 else
  try
   ieViewer.AutoFit := False;
   Scale := StrToInt(l3Str(f_ValueMap.DisplayNameToValue(aParams.SelectedString)))
  except
   on El3ValueMapValueNotFound do
    Say(war_PictureRangeWarning, [f_ValueMap.MinValue, f_ValueMap.MaxValue]);
  end;//try..except
//#UC END# *4C876C1F014C_4C8768010125exec_impl*
//#UC START# *4C876C1F014C_4C8768010125exec_var*
//#UC END# *4C876C1F014C_4C8768010125exec_var*
//#UC START# *4C876C1F014C_4C8768010125test_impl*
 aParams.Op.Flag[vcm_ofEnabled] := True;
 l_Strings := aParams.Op.SubItems;
 if (l_Strings = nil) then
  Exit;
 if not ieViewer.AutoFit then
  aParams.Op.SelectedString := f_ValueMap.ValueToDisplayName(nsCStr(IntToStr(Scale)))
 else
  aParams.Op.SelectedString := f_ValueMap.SpecialDisplayName;
 if (l_Strings.Count = 0) and Supports(f_ValueMap, InsStringsSource, l_StringSource) then
  l_StringSource.FillStrings(l_Strings);
//#UC END# *4C876C1F014C_4C8768010125test_impl*
//#UC START# *4C876C1F014C_4C8768010125test_var*
var
 l_Strings : IvcmStrings;
 l_StringSource: InsStringsSource;
//#UC END# *4C876C1F014C_4C8768010125test_var*
//#UC START# *4C876E670305_4C8768010125exec_impl*
 Enlarge;
//#UC END# *4C876E670305_4C8768010125exec_impl*
//#UC START# *4C876E670305_4C8768010125exec_var*
//#UC END# *4C876E670305_4C8768010125exec_var*
//#UC START# *4C876E670305_4C8768010125test_impl*
 aParams.Op.Flag[vcm_ofEnabled] := CanEnlarge;
//#UC END# *4C876E670305_4C8768010125test_impl*
//#UC START# *4C876E670305_4C8768010125test_var*
//#UC END# *4C876E670305_4C8768010125test_var*
//#UC START# *4C876E850207_4C8768010125exec_impl*
 Shrink;
//#UC END# *4C876E850207_4C8768010125exec_impl*
//#UC START# *4C876E850207_4C8768010125exec_var*
//#UC END# *4C876E850207_4C8768010125exec_var*
//#UC START# *4C876E850207_4C8768010125test_impl*
 aParams.Op.Flag[vcm_ofEnabled] := CanShrink;
//#UC END# *4C876E850207_4C8768010125test_impl*
//#UC START# *4C876E850207_4C8768010125test_var*
//#UC END# *4C876E850207_4C8768010125test_var*
//#UC START# *4C876EA202FF_4C8768010125exec_impl*
 Scale := 100;
//#UC END# *4C876EA202FF_4C8768010125exec_impl*
//#UC START# *4C876EA202FF_4C8768010125exec_var*
//#UC END# *4C876EA202FF_4C8768010125exec_var*
//#UC START# *4C876EA202FF_4C8768010125test_impl*
 aParams.Op.Flag[vcm_ofEnabled] := Scale <> 100;
//#UC END# *4C876EA202FF_4C8768010125test_impl*
//#UC START# *4C876EA202FF_4C8768010125test_var*
//#UC END# *4C876EA202FF_4C8768010125test_var*
//#UC START# *4C876EB40188_4C8768010125exec_impl*
 FitInWindow;
//#UC END# *4C876EB40188_4C8768010125exec_impl*
//#UC START# *4C876EB40188_4C8768010125exec_var*
//#UC END# *4C876EB40188_4C8768010125exec_var*
//#UC START# *4C876EB40188_4C8768010125test_impl*
 aParams.Op.Flag[vcm_ofEnabled] := not ieViewer.AutoFit;
//#UC END# *4C876EB40188_4C8768010125test_impl*
//#UC START# *4C876EB40188_4C8768010125test_var*
//#UC END# *4C876EB40188_4C8768010125test_var*
//#UC START# *4CDACD8302DD_4C8768010125get_impl*
 Result := ieViewer.IEBitmap.VclBitmap;
//#UC END# *4CDACD8302DD_4C8768010125get_impl*
//#UC START# *4CDACD8302DD_4C8768010125get_var*
//#UC END# *4CDACD8302DD_4C8768010125get_var*
//#UC START# *4CDAD282005F_4C8768010125_impl*
 Result := f_Info.Name;
//#UC END# *4CDAD282005F_4C8768010125_impl*
//#UC START# *4CDAD282005F_4C8768010125_var*
//#UC END# *4CDAD282005F_4C8768010125_var*
//#UC START# *4CDAD29D0169_4C8768010125_impl*
 Result := f_Info.ShortName;
//#UC END# *4CDAD29D0169_4C8768010125_impl*
//#UC START# *4CDAD29D0169_4C8768010125_var*
//#UC END# *4CDAD29D0169_4C8768010125_var*
