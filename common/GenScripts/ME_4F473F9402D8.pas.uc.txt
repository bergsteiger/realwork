//#UC START# *47A042E100E2_4F473F9402D8_impl*
 inherited;
 Sorted := true;
//#UC END# *47A042E100E2_4F473F9402D8_impl*
//#UC START# *47A042E100E2_4F473F9402D8_var*
//#UC END# *47A042E100E2_4F473F9402D8_var*
//#UC START# *4F473F9402D8_ext:FileName
w:\common\components\rtl\Garant\ScriptEngine\tfwCStringFactory.pas
//#UC END# *4F473F9402D8_ext:FileName
//#UC START# *4F47405B02FD_4F473F9402D8_impl*
 {.$IfNDef XE}
 l_Len := Length(aString);
 if (l_Len < cLimit) then
 begin
  if (l_Len = 1) then
   Result := C(aString[1])
  else
  if (l_Len = 2) then
  begin
   l_W := PWord(@(aString[1]))^;
   Result := TtfwCStringArraySing2.Instance.Items[l_W];
   if (Result = nil) then
   begin
    Result := l3CStr(aString);
    TtfwCStringArraySing2.Instance.Items[l_W] := Result;
   end;//Result = nil
  end//l_Len = 2
  else
   with Instance do
   begin
    if FindData(l3PCharLen(aString), i, SortIndex) then
     Result := Items[i]
    else
    begin
     Result := l3CStr(aString);
     CacheString(i, Result);
    end;//FindData(l3PCharLen(aString), i)
   end;//with Instance
 end//Length(aString) < cLimit
 else
 {.$EndIf XE}
  Result := l3CStr(aString);
//#UC END# *4F47405B02FD_4F473F9402D8_impl*
//#UC START# *4F47405B02FD_4F473F9402D8_var*
var
 i : Integer;
 l_Len : Integer;
 l_W   : Word;
//#UC END# *4F47405B02FD_4F473F9402D8_var*
//#UC START# *4F47407D0052_4F473F9402D8_impl*
 {.$IfNDef XE}
 if (aString.SLen < cLimit) AND l3IsANSI(aString.SCodePage) then
 begin
  if (aString.SLen = 1) {AND l3IsANSI(aString.SCodePage)} then
  begin
   Assert(aString.S <> nil);
   Result := C(aString.S[0]);
  end//aString.SLen = 1
  else
  if (aString.SLen = 2) {AND l3IsANSI(aString.SCodePage)} then
  begin
   Assert(aString.S <> nil);
   l_W := PWord(aString.S)^;
   Result := TtfwCStringArraySing2.Instance.Items[l_W];
   if (Result = nil) then
   begin
    Result := l3CStr(aString);
    TtfwCStringArraySing2.Instance.Items[l_W] := Result;
   end;//Result = nil
  end//aString.SLen = 2
  else
   with Instance do
   begin
    if {l3IsANSI(aString.SCodePage) AND }FindData(aString, i, SortIndex) then
     Result := Items[i]
    else
    begin
     Result := l3CStr(aString);
     CacheString(i, Result);
    end;//FindData(l3PCharLen(aString), i)
   end;//with Instance
 end//Length(aString) < cLimit
 else
 {.$EndIf XE}
  Result := l3CStr(aString);
//#UC END# *4F47407D0052_4F473F9402D8_impl*
//#UC START# *4F47407D0052_4F473F9402D8_var*
var
 i : Integer;
 l_W : Word;
//#UC END# *4F47407D0052_4F473F9402D8_var*
//#UC START# *4F4740A802A8_4F473F9402D8_impl*
 if (aString = nil) then
  Result := l3CStr('')
 else
 begin
  l_S := aString.AsWStr;
  if (l_S.SLen < cLimit) then
   Result := C(l_S)
  else
   Result := l3CStr(aString);
 end;//aString = nil
//#UC END# *4F4740A802A8_4F473F9402D8_impl*
//#UC START# *4F4740A802A8_4F473F9402D8_var*
var
 l_S : Tl3WString;
//#UC END# *4F4740A802A8_4F473F9402D8_var*
//#UC START# *4F50782700AA_4F473F9402D8_impl*
 Result := TtfwCStringArraySing.Instance.Items[Ord(aChar)];
 if (Result = nil) then
 begin
  Result := l3CStr(aChar);
  TtfwCStringArraySing.Instance.Items[Ord(aChar)] := Result;
 end;//Result = nil
//#UC END# *4F50782700AA_4F473F9402D8_impl*
//#UC START# *4F50782700AA_4F473F9402D8_var*
//#UC END# *4F50782700AA_4F473F9402D8_var*
//#UC START# *559F726001FC_4F473F9402D8_impl*
 l_W := aString.AsWStr;
 if (l_W.SLen < 50{cLimit}) then
 begin
  if (l_W.SLen < 5) then
   Result := C(l_W)
  else
  begin
   with Instance do
   begin
    if FindData({aString}l_W, i, SortIndex) then
     Result := Items[i]
    else
    begin
     Result := aString;
     CacheString(i, Result);
    end;//FindData(l3PCharLen(aString), i)
   end;//with Instance
  end;//l_W.SLen < 5
 end
 else
  Result := aString;
//#UC END# *559F726001FC_4F473F9402D8_impl*
//#UC START# *559F726001FC_4F473F9402D8_var*
var
 l_W : Tl3WString;
 i : Integer;
//#UC END# *559F726001FC_4F473F9402D8_var*
//#UC START# *56011A85035E_4F473F9402D8_impl*
 if (Count >= cCountLimit) then
 begin
  Clear;
  theIndex := 0;
 end;//Count >= cCountLimit
 DirectInsert(theIndex, aString);
//#UC END# *56011A85035E_4F473F9402D8_impl*
//#UC START# *56011A85035E_4F473F9402D8_var*
const
 cCountLimit = 5000;
//#UC END# *56011A85035E_4F473F9402D8_var*
//#UC START# *56028D1B01AC_4F473F9402D8_impl*
 Result := l3Cat([aA, aB]);
 if (Result <> aA) AND (Result <> aB) then
  Result := C(Result);
//#UC END# *56028D1B01AC_4F473F9402D8_impl*
//#UC START# *56028D1B01AC_4F473F9402D8_var*
//#UC END# *56028D1B01AC_4F473F9402D8_var*
//#UC START# *56028DB8038D_4F473F9402D8_impl*
 Result := C(l3Cat(aStrings));
//#UC END# *56028DB8038D_4F473F9402D8_impl*
//#UC START# *56028DB8038D_4F473F9402D8_var*
//#UC END# *56028DB8038D_4F473F9402D8_var*
//#UC START# *56029758029D_4F473F9402D8_impl*
 Result := C(aString);
 //Result := Tl3ConstString.MakeI(aString);
//#UC END# *56029758029D_4F473F9402D8_impl*
//#UC START# *56029758029D_4F473F9402D8_var*
//#UC END# *56029758029D_4F473F9402D8_var*
//#UC START# *5602A7F8015D_4F473F9402D8_impl*
 if l3IsNil(aA) then
  Result := aB
 else
 if l3IsNil(aB) then
  Result := aA
 else
  Result := Cat([aA, aSep, aB]);
//#UC END# *5602A7F8015D_4F473F9402D8_impl*
//#UC START# *5602A7F8015D_4F473F9402D8_var*
//#UC END# *5602A7F8015D_4F473F9402D8_var*
//#UC START# *56F3E7140106_4F473F9402D8_impl*
 if l3IsNil(aString) then
  Result := aString
 else
 if (aString.AsWStr.SCodePage = CP_Unicode) then
  Result := aString
 else
  Result := l3CStr(l3DStr(aString));
  //Result := l3CStr(l3PCharLen(l3DStr(aString)));
  //Result := C(l3PCharLen(l3DStr(aString)));
//#UC END# *56F3E7140106_4F473F9402D8_impl*
//#UC START# *56F3E7140106_4F473F9402D8_var*
//#UC END# *56F3E7140106_4F473F9402D8_var*
