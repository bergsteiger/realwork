//#UC START# *4DAEEDE10285_555F0E15007C_Word_impl*
 System.Randomize;
//#UC END# *4DAEEDE10285_555F0E15007C_Word_impl*
//#UC START# *4DAEEDE10285_555F0E15007C_Word_var*
//#UC END# *4DAEEDE10285_555F0E15007C_Word_var*
//#UC START# *4DAEEDE10285_555F11230214_Word_impl*
 SetCurrentDir(ExtractFilePath(ParamStr(0)));
//#UC END# *4DAEEDE10285_555F11230214_Word_impl*
//#UC START# *4DAEEDE10285_555F11230214_Word_var*
//#UC END# *4DAEEDE10285_555F11230214_Word_var*
//#UC START# *4DAEEDE10285_555F11EC00DE_Word_impl*
 try
  {$IfDef l3HackedVCL}
  {$IfNDef NoVCL}
  Forms.Application.CallActionIdle;
  {$Else   NoVCL}
  Assert(false);
  {$EndIf  NoVCL}
  {$EndIf l3HackedVCL}
 except
  on EListError do;  //541670158
 end;//try..except
//#UC END# *4DAEEDE10285_555F11EC00DE_Word_impl*
//#UC START# *4DAEEDE10285_555F11EC00DE_Word_var*
//#UC END# *4DAEEDE10285_555F11EC00DE_Word_var*
//#UC START# *4DAEEDE10285_555F1F2A01EF_Word_impl*
 l3System.ClearClipboard;
//#UC END# *4DAEEDE10285_555F1F2A01EF_Word_impl*
//#UC START# *4DAEEDE10285_555F1F2A01EF_Word_var*
//#UC END# *4DAEEDE10285_555F1F2A01EF_Word_var*
//#UC START# *4DAEEDE10285_555F20810000_Word_impl*
 Windows.GetLocalTime(l_Time);
 aCtx.rEngine.PushInt(l_Time.wYear);
 aCtx.rEngine.PushInt(l_Time.wMonth);
 aCtx.rEngine.PushInt(l_Time.wDay);
//#UC END# *4DAEEDE10285_555F20810000_Word_impl*
//#UC START# *4DAEEDE10285_555F20810000_Word_var*
var
  l_Time: TSystemTime;
//#UC END# *4DAEEDE10285_555F20810000_Word_var*
//#UC START# *4DAEEDE10285_555F20C400A3_Word_impl*
 Windows.GetLocalTime(l_Time);
 aCtx.rEngine.PushInt(l_Time.wYear);
 aCtx.rEngine.PushInt(l_Time.wMonth);
 aCtx.rEngine.PushInt(l_Time.wDay);
 aCtx.rEngine.PushInt(l_Time.wHour);
 aCtx.rEngine.PushInt(l_Time.wMinute);
 aCtx.rEngine.PushInt(l_Time.wSecond);
 aCtx.rEngine.PushInt(l_Time.wMilliseconds);
//#UC END# *4DAEEDE10285_555F20C400A3_Word_impl*
//#UC START# *4DAEEDE10285_555F20C400A3_Word_var*
var
  l_Time: TSystemTime;
//#UC END# *4DAEEDE10285_555F20C400A3_Word_var*
//#UC START# *4DAEEDE10285_555F20DD01F9_Word_impl*
 Windows.GetLocalTime(l_Time); 
 aCtx.rEngine.PushInt(l_Time.wHour);
 aCtx.rEngine.PushInt(l_Time.wMinute);
 aCtx.rEngine.PushInt(l_Time.wSecond);
 aCtx.rEngine.PushInt(l_Time.wMilliseconds);
//#UC END# *4DAEEDE10285_555F20DD01F9_Word_impl*
//#UC START# *4DAEEDE10285_555F20DD01F9_Word_var*
var
  l_Time: TSystemTime;
//#UC END# *4DAEEDE10285_555F20DD01F9_Word_var*
//#UC START# *4DAEEDE10285_555F210C022D_Word_impl*
 aCtx.rCaller.StartTimer;
//#UC END# *4DAEEDE10285_555F210C022D_Word_impl*
//#UC START# *4DAEEDE10285_555F210C022D_Word_var*
//#UC END# *4DAEEDE10285_555F210C022D_Word_var*
//#UC START# *4F5EFA23015A_ext:FileName
w:\common\components\rtl\Garant\ScriptEngine\SysUtilsPack.pas
//#UC END# *4F5EFA23015A_ext:FileName
//#UC START# *4F5EFA23015Aimpl_uses*
//#UC END# *4F5EFA23015Aimpl_uses*
//#UC START# *555F0CD4039A_555F0CD4039A_Word_impl*
 Result := Tl3TabService.Instance.HasTabs;
//#UC END# *555F0CD4039A_555F0CD4039A_Word_impl*
//#UC START# *555F0CD4039A_555F0CD4039A_Word_var*
//#UC END# *555F0CD4039A_555F0CD4039A_Word_var*
//#UC START# *555F0D370239_555F0D370239_Word_impl*
 Result := l3Is64System;
//#UC END# *555F0D370239_555F0D370239_Word_impl*
//#UC START# *555F0D370239_555F0D370239_Word_var*
//#UC END# *555F0D370239_555F0D370239_Word_var*
//#UC START# *555F0D840371_555F0D840371_Word_impl*
 l_CompSize := MAX_COMPUTERNAME_LENGTH + 1;
 SetLength(l_S, l_CompSize);

 Win32Check(GetComputerNameA(PAnsiChar(l_S), LongWord(l_CompSize)));
 SetLength(l_S, l_CompSize);
 Result := l_S;
//#UC END# *555F0D840371_555F0D840371_Word_impl*
//#UC START# *555F0D840371_555F0D840371_Word_var*
var
 l_CompSize : Integer;
 l_S : AnsiString;
//#UC END# *555F0D840371_555F0D840371_Word_var*
//#UC START# *555F0DC900C0_555F0DC900C0_Word_impl*
 Result := GetWindowsVersionString;
//#UC END# *555F0DC900C0_555F0DC900C0_Word_impl*
//#UC START# *555F0DC900C0_555F0DC900C0_Word_var*
//#UC END# *555F0DC900C0_555F0DC900C0_Word_var*
//#UC START# *555F0DF30159_555F0DF30159_Word_impl*
 Result := System.Random(aMax);
//#UC END# *555F0DF30159_555F0DF30159_Word_impl*
//#UC START# *555F0DF30159_555F0DF30159_Word_var*
//#UC END# *555F0DF30159_555F0DF30159_Word_var*
//#UC START# *555F0E3300FB_555F0E3300FB_Word_impl*
 RandSeed := aValue;
//#UC END# *555F0E3300FB_555F0E3300FB_Word_impl*
//#UC START# *555F0E3300FB_555F0E3300FB_Word_var*
//#UC END# *555F0E3300FB_555F0E3300FB_Word_var*
//#UC START# *555F0E6D015F_555F0E6D015F_Word_impl*
 l_Color := TColor(RGB(aR, aG, aB));
 Result := ColorToString(l_Color);
//#UC END# *555F0E6D015F_555F0E6D015F_Word_impl*
//#UC START# *555F0E6D015F_555F0E6D015F_Word_var*
var
 l_Color : TColor;
//#UC END# *555F0E6D015F_555F0E6D015F_Word_var*
//#UC START# *555F0F000329_555F0F000329_Word_impl*
 Result := SysUtils.IntToStr(aValue);
//#UC END# *555F0F000329_555F0F000329_Word_impl*
//#UC START# *555F0F000329_555F0F000329_Word_var*
//#UC END# *555F0F000329_555F0F000329_Word_var*
//#UC START# *555F0F220176_555F0F220176_Word_impl*
 {$IfDef XE}
 Result := true;
 {$Else  XE}
 Result := false;
 {$EndIf XE}
//#UC END# *555F0F220176_555F0F220176_Word_impl*
//#UC START# *555F0F220176_555F0F220176_Word_var*
//#UC END# *555F0F220176_555F0F220176_Word_var*
//#UC START# *555F0F4A0046_555F0F4A0046_Word_impl*
 l_S := aPath;
 if (ExtractFilePath(l_S) = '') then
  l_S := ExtractFilePath(ParamStr(0)) + l_S;
 Windows.WinExec(PAnsiChar(l_S), {SW_HIDE}SW_SHOWNORMAL);
//#UC END# *555F0F4A0046_555F0F4A0046_Word_impl*
//#UC START# *555F0F4A0046_555F0F4A0046_Word_var*
var
 l_S : AnsiString;
//#UC END# *555F0F4A0046_555F0F4A0046_Word_var*
//#UC START# *555F0F880363_555F0F880363_Word_impl*
 Result := aCtx.rStreamFactory.FileName;
//#UC END# *555F0F880363_555F0F880363_Word_impl*
//#UC START# *555F0F880363_555F0F880363_Word_var*
//#UC END# *555F0F880363_555F0F880363_Word_var*
//#UC START# *555F0FC90086_555F0FC90086_Word_impl*
 Result := ChangeFileExt(aName, anExt);
//#UC END# *555F0FC90086_555F0FC90086_Word_impl*
//#UC START# *555F0FC90086_555F0FC90086_Word_var*
//#UC END# *555F0FC90086_555F0FC90086_Word_var*
//#UC START# *555F1009034D_555F1009034D_Word_impl*
 Result := ExtractFileName(aName);
//#UC END# *555F1009034D_555F1009034D_Word_impl*
//#UC START# *555F1009034D_555F1009034D_Word_var*
//#UC END# *555F1009034D_555F1009034D_Word_var*
//#UC START# *555F10300119_555F10300119_Word_impl*
 Result := ExtractFilePath(aName);
//#UC END# *555F10300119_555F10300119_Word_impl*
//#UC START# *555F10300119_555F10300119_Word_var*
//#UC END# *555F10300119_555F10300119_Word_var*
//#UC START# *555F105D037F_555F105D037F_Word_impl*
 Result := ExtractFileDrive(aName);
//#UC END# *555F105D037F_555F105D037F_Word_impl*
//#UC START# *555F105D037F_555F105D037F_Word_var*
//#UC END# *555F105D037F_555F105D037F_Word_var*
//#UC START# *555F10880253_555F10880253_Word_impl*
 Result := DirectoryExists(aPath);
//#UC END# *555F10880253_555F10880253_Word_impl*
//#UC START# *555F10880253_555F10880253_Word_var*
//#UC END# *555F10880253_555F10880253_Word_var*
//#UC START# *555F10BB02BF_555F10BB02BF_Word_impl*
 Result := FileExists(aPath);
//#UC END# *555F10BB02BF_555F10BB02BF_Word_impl*
//#UC START# *555F10BB02BF_555F10BB02BF_Word_var*
//#UC END# *555F10BB02BF_555F10BB02BF_Word_var*
//#UC START# *555F10EC036B_555F10EC036B_Word_impl*
 Result := ForceDirectories(aPath);
//#UC END# *555F10EC036B_555F10EC036B_Word_impl*
//#UC START# *555F10EC036B_555F10EC036B_Word_var*
//#UC END# *555F10EC036B_555F10EC036B_Word_var*
//#UC START# *555F117F016A_555F117F016A_Word_impl*
 Result := ParamStr(0);
//#UC END# *555F117F016A_555F117F016A_Word_impl*
//#UC START# *555F117F016A_555F117F016A_Word_var*
//#UC END# *555F117F016A_555F117F016A_Word_var*
//#UC START# *555F11A500DD_555F11A500DD_Word_impl*
 Result := Windows.GetTickCount;
//#UC END# *555F11A500DD_555F11A500DD_Word_impl*
//#UC START# *555F11A500DD_555F11A500DD_Word_var*
//#UC END# *555F11A500DD_555F11A500DD_Word_var*
//#UC START# *555F1F8D0148_555F1F8D0148_Word_impl*
 Windows.GetLocalTime(l_Time);
 
 l_Time.wDay := aDay;
 l_Time.wMonth := aMonth;
 l_Time.wYear := anYear;

 Windows.SetLocalTime(l_Time);
//#UC END# *555F1F8D0148_555F1F8D0148_Word_impl*
//#UC START# *555F1F8D0148_555F1F8D0148_Word_var*
var
 l_Time: TSystemTime;
//#UC END# *555F1F8D0148_555F1F8D0148_Word_var*
//#UC START# *555F1FE70369_555F1FE70369_Word_impl*
 Windows.GetLocalTime(l_Time);

 l_Time.wMilliseconds := aMilli;
 l_Time.wSecond := aSecond;
 l_Time.wMinute := aMinute;
 l_Time.wHour := anHour;

 Windows.SetLocalTime(l_Time);
//#UC END# *555F1FE70369_555F1FE70369_Word_impl*
//#UC START# *555F1FE70369_555F1FE70369_Word_var*
var
 l_Time: TSystemTime;
//#UC END# *555F1FE70369_555F1FE70369_Word_var*
//#UC START# *555F203D014D_555F203D014D_Word_impl*
 Windows.GetLocalTime(l_Time);

 l_Time.wMilliseconds := aMilli;
 l_Time.wSecond := aSecond;
 l_Time.wMinute := aMinute;
 l_Time.wHour := anHour;
 l_Time.wDay := aDay;
 l_Time.wMonth := aMonth;
 l_Time.wYear := anYear;

 Windows.SetLocalTime(l_Time);
//#UC END# *555F203D014D_555F203D014D_Word_impl*
//#UC START# *555F203D014D_555F203D014D_Word_var*
var
 l_Time: TSystemTime;
//#UC END# *555F203D014D_555F203D014D_Word_var*
//#UC START# *555F212902C6_555F212902C6_Word_impl*
 Result := aCtx.rCaller.StopTimer(aName);
//#UC END# *555F212902C6_555F212902C6_Word_impl*
//#UC START# *555F212902C6_555F212902C6_Word_var*
//#UC END# *555F212902C6_555F212902C6_Word_var*
//#UC START# *555F215300EC_555F215300EC_Word_impl*
 Result := aCtx.rCaller.StopTimer(aName, aSubName);
//#UC END# *555F215300EC_555F215300EC_Word_impl*
//#UC START# *555F215300EC_555F215300EC_Word_var*
//#UC END# *555F215300EC_555F215300EC_Word_var*
//#UC START# *555F21920151_555F21920151_Word_impl*
 l_S2 := Mangle(aSubName);
 l_S1 := Mangle(aName);
 aCtx.rCaller.TimeToLog(aValue, l_S1, l_S2);
//#UC END# *555F21920151_555F21920151_Word_impl*
//#UC START# *555F21920151_555F21920151_Word_var*

 function Mangle(const aStr: AnsiString): AnsiString;
(* const
  cLimit = 30;*)
 begin
  Result := aStr;
(*  Result := l3Transliterate(aStr);
  l3Replace(Result, ' ', '_');
  l3Replace(Result, '''', '_');
  l3Replace(Result, '(', '_');
  l3Replace(Result, ')', '_');
  l3Replace(Result, '.', '_');
  if (Length(Result) > cLimit) then
   SetLength(Result, cLimit);*)
 end;
 
var
 l_S1 : AnsiString;
 l_S2 : AnsiString;
//#UC END# *555F21920151_555F21920151_Word_var*
//#UC START# *555F2FF3000A_555F2FF3000A_Word_impl*
 Windows.GetLocalTime(l_Time);
 with l_Time do
  l_DelphiTime := EncodeDateTime(wYear, wMonth, wDay, wHour, wMinute, wSecond, wMilliseconds);
 l_DelphiTime := IncYear(l_DelphiTime, aDeltaY);
 l_DelphiTime := IncMonth(l_DelphiTime, aDeltaM);
 l_DelphiTime := IncDay(l_DelphiTime, aDeltaD);
 with l_Time do
  DecodeDateTime(l_DelphiTime, wYear, wMonth, wDay, wHour, wMinute, wSecond, wMilliseconds);
 Windows.SetLocalTime(l_Time);
//#UC END# *555F2FF3000A_555F2FF3000A_Word_impl*
//#UC START# *555F2FF3000A_555F2FF3000A_Word_var*
var
 l_Time: TSystemTime;
 l_DelphiTime: TDateTime;
//#UC END# *555F2FF3000A_555F2FF3000A_Word_var*
//#UC START# *555F302402C4_555F302402C4_Word_impl*
 Windows.GetLocalTime(l_Time);
 with l_Time do
  l_DelphiTime := EncodeDateTime(wYear, wMonth, wDay, wHour, wMinute, wSecond, wMilliseconds);
 l_DelphiTime := IncMilliSecond(l_DelphiTime, aDeltaMilli);
 with l_Time do
  DecodeDateTime(l_DelphiTime, wYear, wMonth, wDay, wHour, wMinute, wSecond, wMilliseconds);
 Windows.SetLocalTime(l_Time);
//#UC END# *555F302402C4_555F302402C4_Word_impl*
//#UC START# *555F302402C4_555F302402C4_Word_var*
var
 l_Time: TSystemTime;
 l_DelphiTime: TDateTime;
//#UC END# *555F302402C4_555F302402C4_Word_var*
//#UC START# *555F35970310_555F35970310_Word_impl*
 if (aFormat.rType = tfw_vtInt) then
  l_Format := Cardinal(aFormat.AsInt)
 else
  {$If Declared(l3GetClipboardByFormatName)}
  l_Format := Cardinal(l3GetClipboardByFormatName(l3Str(aFormat.AsString)));
  {$Else}
  RunnerAssert(false, 'Не определена функция l3GetClipboardByFormatName', aCtx);
  {$IfEnd}

 {$If Declared(Clipboard)}
 if Clipboard.HasFormat(l_Format) then
 begin
  l_ClipbrdHandle := Clipboard.GetAsHandle(l_Format);
  l_String := GlobalLock(l_ClipbrdHandle);
  try
   //aCtx.rEngine.PushString( StrPas(l_String));
   if (l_Format = CF_UnicodeText) then
    Result := TtfwCStringFactory.C(l3PCharLen(PWideChar(l_String){, GlobalSize(l_ClipbrdHandle) div SizeOf(WideChar)}))
   else
   if (l_Format = CF_Text) OR (l_Format = CF_OEMTExt) then
    Result := TtfwCStringFactory.C(l3PCharLen(l_String{, GlobalSize(l_ClipbrdHandle)}))
   else 
    Result := TtfwCStringFactory.C(l3PCharLen(l_String, GlobalSize(l_ClipbrdHandle)));
  finally
   GlobalUnLock(l_ClipbrdHandle);
  end;
 end//Clipboard.HasFormat(l_Format)
 else
  // plain text
  Result := TtfwCStringFactory.C(Clipboard.AsText);
 {$Else}
 Assert(false);
 {$IfEnd}
//#UC END# *555F35970310_555F35970310_Word_impl*
//#UC START# *555F35970310_555F35970310_Word_var*
var
 l_Format: Cardinal;
 l_ClipbrdHandle: THandle;
 l_String: PAnsiChar;
//#UC END# *555F35970310_555F35970310_Word_var*
//#UC START# *555F35EC027C_555F35EC027C_Word_impl*
 {$If Declared(Clipboard)}
 l3System.SetClipboardData(Tl3CStringDataObject.Make(aValue));
 //Clipboard.AsText := l3Str(aValue);
 {$Else}
 Assert(false);
 {$IfEnd}
//#UC END# *555F35EC027C_555F35EC027C_Word_impl*
//#UC START# *555F35EC027C_555F35EC027C_Word_var*
//#UC END# *555F35EC027C_555F35EC027C_Word_var*
//#UC START# *5565C43A01FA_5565C43A01FA_Word_impl*
 Result := aCtx.rEngine.ExceptionStack;
//#UC END# *5565C43A01FA_5565C43A01FA_Word_impl*
//#UC START# *5565C43A01FA_5565C43A01FA_Word_var*
//#UC END# *5565C43A01FA_5565C43A01FA_Word_var*
//#UC START# *55CB5442020A_55CB5442020A_Word_impl*
 Result := ParamCount;
//#UC END# *55CB5442020A_55CB5442020A_Word_impl*
//#UC START# *55CB5442020A_55CB5442020A_Word_var*
//#UC END# *55CB5442020A_55CB5442020A_Word_var*
//#UC START# *55CB54630103_55CB54630103_Word_impl*
 Result := ParamStr(anIndex);
//#UC END# *55CB54630103_55CB54630103_Word_impl*
//#UC START# *55CB54630103_55CB54630103_Word_var*
//#UC END# *55CB54630103_55CB54630103_Word_var*
//#UC START# *55CB547900E8_55CB547900E8_Word_impl*
 Result := SysUtils.GetCurrentDir;
//#UC END# *55CB547900E8_55CB547900E8_Word_impl*
//#UC START# *55CB547900E8_55CB547900E8_Word_var*
//#UC END# *55CB547900E8_55CB547900E8_Word_var*
//#UC START# *55CB548A02B3_55CB548A02B3_Word_impl*
 Result := SysUtils.SetCurrentDir(aDir); 
//#UC END# *55CB548A02B3_55CB548A02B3_Word_impl*
//#UC START# *55CB548A02B3_55CB548A02B3_Word_var*
//#UC END# *55CB548A02B3_55CB548A02B3_Word_var*
//#UC START# *55CB54C90276_55CB54C90276_Word_impl*
 Result := SysUtils.CreateDir(aDir);
//#UC END# *55CB54C90276_55CB54C90276_Word_impl*
//#UC START# *55CB54C90276_55CB54C90276_Word_var*
//#UC END# *55CB54C90276_55CB54C90276_Word_var*
//#UC START# *55CB54EF00B8_55CB54EF00B8_Word_impl*
 Result := SysUtils.RemoveDir(aDir);
//#UC END# *55CB54EF00B8_55CB54EF00B8_Word_impl*
//#UC START# *55CB54EF00B8_55CB54EF00B8_Word_var*
//#UC END# *55CB54EF00B8_55CB54EF00B8_Word_var*
//#UC START# *570E6FCA0217_570E6FCA0217_Word_impl*
 l3System.Msg2Log(aStr);
//#UC END# *570E6FCA0217_570E6FCA0217_Word_impl*
//#UC START# *570E6FCA0217_570E6FCA0217_Word_var*
//#UC END# *570E6FCA0217_570E6FCA0217_Word_var*
//#UC START# *570FF89B00BE_570FF89B00BE_Word_impl*
 Result := aCtx.rCaller.StopTimer(aName, '', false);
//#UC END# *570FF89B00BE_570FF89B00BE_Word_impl*
//#UC START# *570FF89B00BE_570FF89B00BE_Word_var*
//#UC END# *570FF89B00BE_570FF89B00BE_Word_var*
//#UC START# *570FF8C8038E_570FF8C8038E_Word_impl*
 Result := aCtx.rCaller.StopTimer(aName, aSubName, false);
//#UC END# *570FF8C8038E_570FF8C8038E_Word_impl*
//#UC START# *570FF8C8038E_570FF8C8038E_Word_var*
//#UC END# *570FF8C8038E_570FF8C8038E_Word_var*
//#UC START# *571766B60308_571766B60308_Word_impl*
 Result := GetThreadLocale;
//#UC END# *571766B60308_571766B60308_Word_impl*
//#UC START# *571766B60308_571766B60308_Word_var*
//#UC END# *571766B60308_571766B60308_Word_var*
//#UC START# *571766C80011_571766C80011_Word_impl*
 Result := LCIDToCodePage(GetThreadLocale);
//#UC END# *571766C80011_571766C80011_Word_impl*
//#UC START# *571766C80011_571766C80011_Word_var*

 function LCIDToCodePage(ALcid: LCID): Integer;
 var
   Buffer: array [0..6] of Char;
 begin
   GetLocaleInfo(ALcid, LOCALE_IDEFAULTANSICODEPAGE, Buffer, SizeOf(Buffer));
   Result:= StrToIntDef(Buffer, GetACP);
 end;
 
//#UC END# *571766C80011_571766C80011_Word_var*
//#UC START# *5718D0250329_5718D0250329_Word_impl*
 Result := Windows.GetACP; 
//#UC END# *5718D0250329_5718D0250329_Word_impl*
//#UC START# *5718D0250329_5718D0250329_Word_var*
//#UC END# *5718D0250329_5718D0250329_Word_var*
//#UC START# *573990470097_573990470097_Word_impl*
 Result := SysUtils.IntToHex(aValue, aDigits);
//#UC END# *573990470097_573990470097_Word_impl*
//#UC START# *573990470097_573990470097_Word_var*
//#UC END# *573990470097_573990470097_Word_var*
//#UC START# *5755450A0019_5755450A0019_Word_impl*
 Result := l3CreateStringGUID;
//#UC END# *5755450A0019_5755450A0019_Word_impl*
//#UC START# *5755450A0019_5755450A0019_Word_var*
//#UC END# *5755450A0019_5755450A0019_Word_var*
//#UC START# *57A44E1B036A_57A44E1B036A_Word_impl*
  Result := False;
  l_CommandLine := CommandLine;
  if (InputFile <> '') then
   hInputFile := CreateFile(PAnsiChar(InputFile), GENERIC_READ, FILE_SHARE_READ,
     CreateInheritable(SecAtrrs), OPEN_EXISTING, FILE_ATTRIBUTE_TEMPORARY, 0)
  else
   hInputFile := 0;
  if hInputFile <> INVALID_HANDLE_VALUE then
  begin
    hOutputFile := CreateFile(PAnsiChar(OutPutFile), GENERIC_READ or GENERIC_WRITE,
      FILE_SHARE_READ or FILE_SHARE_WRITE, CreateInheritable(SecAtrrs), OPEN_EXISTING,
      FILE_ATTRIBUTE_TEMPORARY, 0);
    if (hOutputFile = INVALID_HANDLE_VALUE) then
     hOutputFile := CreateFile(PAnsiChar(OutPutFile), GENERIC_READ or GENERIC_WRITE,
       FILE_SHARE_READ or FILE_SHARE_WRITE, CreateInheritable(SecAtrrs), CREATE_ALWAYS,
       FILE_ATTRIBUTE_TEMPORARY, 0)
    else
    begin
     FileSeek(Integer(hOutputFile), 0, FILE_END	);
    end;//hOutputFile = INVALID_HANDLE_VALUE
    if hOutputFile <> INVALID_HANDLE_VALUE then
    begin
      ResetMemory(StartupInfo, SizeOf(StartupInfo));
      ResetMemory(ProcessInfo, SizeOf(ProcessInfo));
      StartupInfo.cb := SizeOf(StartupInfo);
      StartupInfo.dwFlags := STARTF_USESHOWWINDOW or STARTF_USESTDHANDLES;
      StartupInfo.wShowWindow := SW_HIDE;
      StartupInfo.hStdOutput := hOutputFile;
      StartupInfo.hStdInput := hInputFile;
      UniqueString(l_CommandLine);//in the Unicode version the parameter lpCommandLine needs to be writable
      Result := CreateProcess(nil, PAnsiChar(l_CommandLine), nil, nil, True,
        CREATE_NEW_CONSOLE or NORMAL_PRIORITY_CLASS, nil, nil, StartupInfo,
        ProcessInfo);
      if Result then
      begin
        WaitForSingleObject(ProcessInfo.hProcess, INFINITE);
        CloseHandle(ProcessInfo.hProcess);
        CloseHandle(ProcessInfo.hThread);
      end;
      CloseHandle(hOutputFile);
    end;
    CloseHandle(hInputFile);
  end;
//#UC END# *57A44E1B036A_57A44E1B036A_Word_impl*
//#UC START# *57A44E1B036A_57A44E1B036A_Word_var*

 function CreateInheritable(out Sa: TSecurityAttributes): PSecurityAttributes;
 begin
   Sa.nLength := SizeOf(Sa);
   Sa.lpSecurityDescriptor := nil;
   Sa.bInheritHandle := True;
   if IsWinNT then
     Result := @Sa
   else
     Result := nil;
 end;

 procedure ResetMemory(out P; Size: Longint);
 begin
   if Size > 0 then
   begin
     Byte(P) := 0;
     l3FillChar(P, Size, 0);
   end;
 end;

var
  StartupInfo: TStartupInfo;
  ProcessInfo: TProcessInformation;
  SecAtrrs: TSecurityAttributes;
  hInputFile, hOutputFile: THandle;
  l_CommandLine: AnsiString;
//#UC END# *57A44E1B036A_57A44E1B036A_Word_var*
