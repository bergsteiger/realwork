//#UC START# *479731C50290_4FFC4C800030_impl*
 f_FoundItem := nil;
 f_Sorted := False;
 inherited;
//#UC END# *479731C50290_4FFC4C800030_impl*
//#UC START# *479731C50290_4FFC4C800030_var*
//#UC END# *479731C50290_4FFC4C800030_var*
//#UC START# *479F2B3302C1_4FFC4C800030_impl*
 inherited;
 THackCollection(Self).FUpdateCount := 0;
 THackOwnedCollection(Self).FOwner := nil;
//#UC END# *479F2B3302C1_4FFC4C800030_impl*
//#UC START# *479F2B3302C1_4FFC4C800030_var*
//#UC END# *479F2B3302C1_4FFC4C800030_var*
//#UC START# *47A6FEE600FC_4FFC4C800030_impl*
 {$IfDef XE}
 Result := False;
 {$Else  XE}
 Result := True;
 {$EndIf XE}
//#UC END# *47A6FEE600FC_4FFC4C800030_impl*
//#UC START# *47A6FEE600FC_4FFC4C800030_var*
//#UC END# *47A6FEE600FC_4FFC4C800030_var*
//#UC START# *4F8E7A900279_4FFC4C800030_impl*
 if (Action in [cnExtracting, cnDeleting]) AND (Item = f_FoundItem) then
  f_FoundItem := nil;
 inherited;
//#UC END# *4F8E7A900279_4FFC4C800030_impl*
//#UC START# *4F8E7A900279_4FFC4C800030_var*
//#UC END# *4F8E7A900279_4FFC4C800030_var*
//#UC START# *4FFC4C800030ci*
 THackCollection = class(TPersistent)
 private
   FItemClass: TCollectionItemClass;
   FItems: TList;
   FUpdateCount: Integer;
 end;//THackCollection
 THackOwnedCollection = class(TCollection)
 private
   FOwner: TPersistent;
 end;//THackOwnedCollection
//#UC END# *4FFC4C800030ci*
//#UC START# *4FFC4C800030cit*
//#UC END# *4FFC4C800030cit*
//#UC START# *4FFC4C800030impl*
//#UC END# *4FFC4C800030impl*
//#UC START# *4FFC4C800030impl_uses*
//#UC END# *4FFC4C800030impl_uses*
//#UC START# *4FFC4C800030intf_uses*
//#UC END# *4FFC4C800030intf_uses*
//#UC START# *4FFC4C800030publ*
//#UC END# *4FFC4C800030publ*
//#UC START# *5607EB150143_4FFC4C800030set_impl*
 if aValue <> f_Sorted then
 begin
  f_Sorted := aValue;
  if f_Sorted then
   Sort;
 end;
//#UC END# *5607EB150143_4FFC4C800030set_impl*
//#UC START# *5607EB150143_4FFC4C800030set_var*
//#UC END# *5607EB150143_4FFC4C800030set_var*
//#UC START# *5607EB680196_4FFC4C800030get_impl*
 Result := TvcmBaseCollectionItem(inherited GetItem(anIndex));
//#UC END# *5607EB680196_4FFC4C800030get_impl*
//#UC START# *5607EB680196_4FFC4C800030get_var*
//#UC END# *5607EB680196_4FFC4C800030get_var*
//#UC START# *5607EB680196_4FFC4C800030set_impl*
 inherited SetItem(anIndex, aValue);
//#UC END# *5607EB680196_4FFC4C800030set_impl*
//#UC START# *5607EB680196_4FFC4C800030set_var*
//#UC END# *5607EB680196_4FFC4C800030set_var*
//#UC START# *5607EC4F0276_4FFC4C800030_impl*
 for I := Pred(Count) downto 0 do
 for J := Pred(Count) downto 0 do
  if lCompareItems(Items[J].Caption, Items[I].Caption) = 0 then
   // Caption одинаковый, сортируем по Name
   lCompareItems(Items[J].Name, Items[I].Name);
//#UC END# *5607EC4F0276_4FFC4C800030_impl*
//#UC START# *5607EC4F0276_4FFC4C800030_var*
var
 I, J : Integer;

  function lCompareItems(const aItem1, aItem2 : String) : Integer;
  var
   lItem : TvcmBaseCollectionItem;
  begin
  {$IfDef vcmNeedL3}
   Result := l3Compare(l3PCharLen(aItem1), l3PCharLen(aItem2));
  {$Else vcmNeedL3}
   Result := AnsiCompareStr(aItem1, aItem2);
  {$EndIf vcmNeedL3}
   if (Result < 0) then
   begin
    lItem := Items[I];
    Items[J].Index := I;
    lItem.Index := J;
   end;
  end;
//#UC END# *5607EC4F0276_4FFC4C800030_var*
//#UC START# *5607EE5400CB_4FFC4C800030_impl*
 inherited Create(anOwner, GetItemClass);
//#UC END# *5607EE5400CB_4FFC4C800030_impl*
//#UC START# *5607EE5400CB_4FFC4C800030_var*
//#UC END# *5607EE5400CB_4FFC4C800030_var*
//#UC START# *5607EE71032D_4FFC4C800030_impl*
 Result := TvcmBaseCollectionItem;
//#UC END# *5607EE71032D_4FFC4C800030_impl*
//#UC START# *5607EE71032D_4FFC4C800030_var*
//#UC END# *5607EE71032D_4FFC4C800030_var*
//#UC START# *5607EE8B03CD_4FFC4C800030_impl*
 Result := nil;
 if (f_FoundItem Is TvcmBaseCollectionItem) AND
    ANSISameText(TvcmBaseCollectionItem(f_FoundItem).Name, aName) then
  Result := TvcmBaseCollectionItem(f_FoundItem)
 else
 for l_Index := 0 to Pred(Count) do
 begin
  l_Item := Items[l_Index];
  if ANSISameText(TvcmBaseCollectionItem(l_Item).Name, aName) then
  begin
   Result := TvcmBaseCollectionItem(l_Item);
   f_FoundItem := Result;
   break;
  end;//l_Item Is TevBaseCollectionItem
 end;//for l_Item
//#UC END# *5607EE8B03CD_4FFC4C800030_impl*
//#UC START# *5607EE8B03CD_4FFC4C800030_var*
var
 l_Item: TvcmBaseCollectionItem;
 l_Index: Integer;
//#UC END# *5607EE8B03CD_4FFC4C800030_var*
//#UC START# *5607EEA50071_4FFC4C800030_impl*
 Result := FindItemByName(aName);
 if (Result = nil) then
 begin
  Result := TvcmBaseCollectionItem(Add);
  Result.Name := aName;
 end;//Result = nil
//#UC END# *5607EEA50071_4FFC4C800030_impl*
//#UC START# *5607EEA50071_4FFC4C800030_var*
//#UC END# *5607EEA50071_4FFC4C800030_var*
//#UC START# *5607EEB3007A_4FFC4C800030_impl*
 Result := nil;
 if (f_FoundItem Is TvcmBaseCollectionItem) AND
    ANSISameText(TvcmBaseCollectionItem(f_FoundItem).Caption, aName) then
  Result := TvcmBaseCollectionItem(f_FoundItem)
 else
 for l_Index := 0 to Pred(Count) do
 begin
  l_Item := Items[l_Index];
  if ANSISameText(TvcmBaseCollectionItem(l_Item).Caption, aName) then
  begin
   Result := TvcmBaseCollectionItem(l_Item);
   f_FoundItem := Result;
   break;
  end;//l_Item Is TevBaseCollectionItem
 end;//for l_Item
//#UC END# *5607EEB3007A_4FFC4C800030_impl*
//#UC START# *5607EEB3007A_4FFC4C800030_var*
var
 l_Item: TvcmBaseCollectionItem;
 l_Index: Integer;
//#UC END# *5607EEB3007A_4FFC4C800030_var*
//#UC START# *5607EEC401EC_4FFC4C800030_impl*
 Result := nil;
 if (f_FoundItem Is TvcmBaseCollectionItem) AND
    (TvcmBaseCollectionItem(f_FoundItem).GetID = anID) then
  Result := TvcmBaseCollectionItem(f_FoundItem)
 else 
 for l_Index := 0 to Pred(Count) do
 begin
  l_Item := Items[l_Index];
  if (l_Item.GetID = anID) then
  begin
   Result := l_Item;
   f_FoundItem := Result;
   break;
  end;//l_Item Is TevBaseCollectionItem
 end;//for l_Item
//#UC END# *5607EEC401EC_4FFC4C800030_impl*
//#UC START# *5607EEC401EC_4FFC4C800030_var*
var
 l_Item: TvcmBaseCollectionItem;
 l_Index: Integer;
//#UC END# *5607EEC401EC_4FFC4C800030_var*
//#UC START# *5607EEDB0193_4FFC4C800030_impl*
 if f_Sorted then
  Sort;
//#UC END# *5607EEDB0193_4FFC4C800030_impl*
//#UC START# *5607EEDB0193_4FFC4C800030_var*
//#UC END# *5607EEDB0193_4FFC4C800030_var*
