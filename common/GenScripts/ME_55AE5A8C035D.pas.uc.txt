//#UC START# *55AE5A8C035D_ext:FileName
w:\common\components\rtl\Garant\ScriptEngine\tfwDictionaryExWordsPack.pas
//#UC END# *55AE5A8C035D_ext:FileName
//#UC START# *55AE5A8C035Dimpl_uses*
 , l3String
 , tfwAutoregisteredDiction
 , tfwFileStreamFactory
//#UC END# *55AE5A8C035Dimpl_uses*
//#UC START# *55AE62910135_55AE62910135_559E8B2E0385_Word_impl*
 if (aDictionaryEx = nil) then
  Result := TtfwCStringFactory.C('')
 else
  Result := aDictionaryEx.FileName;
//#UC END# *55AE62910135_55AE62910135_559E8B2E0385_Word_impl*
//#UC START# *55AE62910135_55AE62910135_559E8B2E0385_Word_var*
//#UC END# *55AE62910135_55AE62910135_559E8B2E0385_Word_var*
//#UC START# *55AE6569010C_55AE6569010C_559E8B2E0385_Word_impl*
 Result := TtfwUsedDictionariesIterator.Make(aDictionaryEx);
//#UC END# *55AE6569010C_55AE6569010C_559E8B2E0385_Word_impl*
//#UC START# *55AE6569010C_55AE6569010C_559E8B2E0385_Word_var*
//#UC END# *55AE6569010C_55AE6569010C_559E8B2E0385_Word_var*
//#UC START# *55AE657A03C8_55AE657A03C8_559E8B2E0385_Word_impl*
 Result := TtfwExportedDictionariesIterator.Make(aDictionaryEx);
//#UC END# *55AE657A03C8_55AE657A03C8_559E8B2E0385_Word_impl*
//#UC START# *55AE657A03C8_55AE657A03C8_559E8B2E0385_Word_var*
//#UC END# *55AE657A03C8_55AE657A03C8_559E8B2E0385_Word_var*
//#UC START# *55AE65FD001D_55AE65FD001D_559E8B2E0385_Word_impl*
 aDictionaryEx.ExportDictionary(aDictionary);
//#UC END# *55AE65FD001D_55AE65FD001D_559E8B2E0385_Word_impl*
//#UC START# *55AE65FD001D_55AE65FD001D_559E8B2E0385_Word_var*
//#UC END# *55AE65FD001D_55AE65FD001D_559E8B2E0385_Word_var*
//#UC START# *55AE661B00DA_55AE661B00DA_559E8B2E0385_Word_impl*
 aDictionaryEx.UseDictionary(aDictionary);
//#UC END# *55AE661B00DA_55AE661B00DA_559E8B2E0385_Word_impl*
//#UC START# *55AE661B00DA_55AE661B00DA_559E8B2E0385_Word_var*
//#UC END# *55AE661B00DA_55AE661B00DA_559E8B2E0385_Word_var*
//#UC START# *55AE66560055_55AE66560055_559E8B2E0385_Word_impl*
 Result := l3DateTimeToStr(aDictionaryEx.FileDateTime);
//#UC END# *55AE66560055_55AE66560055_559E8B2E0385_Word_impl*
//#UC START# *55AE66560055_55AE66560055_559E8B2E0385_Word_var*
//#UC END# *55AE66560055_55AE66560055_559E8B2E0385_Word_var*
//#UC START# *55AE84FA0076_55AE84FA0076_559E8B2E0385_Word_impl*
 {$IfDef seCacheDict}
 l_D := aDictionaryEx.Use;
 try
  TtfwDictionaryCache.Instance.Remove(l_D);
  if (l_D Is TtfwMainDictionary) then
   TtfwMainDictionaryCache.Instance.Remove(TtfwMainDictionary(l_D));
 finally
  FreeAndNil(l_D);
 end;//try..finally
 {$EndIf seCacheDict}
//#UC END# *55AE84FA0076_55AE84FA0076_559E8B2E0385_Word_impl*
//#UC START# *55AE84FA0076_55AE84FA0076_559E8B2E0385_Word_var*
{$IfDef seCacheDict}
var
 l_D : TtfwDictionaryEx;
{$EndIf seCacheDict}
//#UC END# *55AE84FA0076_55AE84FA0076_559E8B2E0385_Word_var*
//#UC START# *57F665430181_57F665430181_559E8B2E0385_Word_impl*
 with TtfwDictionaryCache.Instance do
 begin
  Lock;
  try
   l_Name := TtfwCStringFactory.C(aCtx.ResolveIncludedFilePath(l3Str(aName)));
   Result := FindDictionary(l_Name);
   if (Result = nil) then
   begin
    l_F := TtfwFileStreamFactory.Create(l3Str(l_Name));
    try
     l_D := TtfwDictionaryEx.Create(l_F, [TtfwAutoregisteredDiction.Instance]);
     try
      Add(l_D);
      Result := l_D;
     finally
      FreeAndNil(l_D);
     end;//try..finally
    finally
     FreeAndNil(l_F);
    end;//try..finally
   end;//Result = nil
  finally
   Unlock;
  end;//try..finally
 end;//with TtfwDictionaryCache.Instance
//#UC END# *57F665430181_57F665430181_559E8B2E0385_Word_impl*
//#UC START# *57F665430181_57F665430181_559E8B2E0385_Word_var*
var
 l_D : TtfwDictionaryEx;
 l_Name : Il3CString;
 l_F : TtfwFileStreamFactory;
//#UC END# *57F665430181_57F665430181_559E8B2E0385_Word_var*
