unit TestLZWDecode;
{

  Delphi DUnit Test Case
  ----------------------
  This unit contains a skeleton test case class generated by the Test Case Wizard.
  Modify the generated code to correctly setup and call the methods from the unit 
  being tested.

}

interface

uses
  TestFramework, Stream, gtObject, DecodeIntf, Classes, Predictor, gtTypes, LZWDecode,
  FileStream, SysUtils, DUnitAssert, Dialogs;

type
  // Test methods for class TgtLZWDecode

  TestTgtLZWDecode = class(TAssertTestCase)
  strict private
    FgtLZWDecode: TgtLZWDecode;
  public
    procedure SetUp; override;
    procedure TearDown; override;
  published
    procedure TestLookChar;
    procedure TestGetChar;
    procedure TestGetPosition;
    procedure TestReadRawChar;
    procedure TestReset;
  end;

implementation
var
    FgtLZWDecode: TgtLZWDecode;
    FInFile, FOutFile: TFileStream;
    FgtInFile, FgtOutFile: TgtFileStream;
    FOutStream: TgtStream;
    Lbuffer : Bytes;
    OutValue,i : Integer;

procedure TestTgtLZWDecode.SetUp;
begin
 FInFile := TFileStream.Create('Filters\LZWDecode\LZW.txt', fmOpenRead);
 FgtInFile := TgtFileStream.Create(FInFile, 0, 0, False);

 FgtLZWDecode := TgtLZWDecode.create(FgtInFile,1,1,1,8,1);

 FOutFile := TFileStream.Create('Filters\LZWDecode\DLZW.txt', fmOpenRead);
 FgtOutFile := TgtFileStream.Create(FOutFile, 0, 0, False);

  FgtLZWDecode.Reset 

end;

procedure TestTgtLZWDecode.TearDown;
begin
  FreeAndNil(FgtLZWDecode);
  FreeAndNil(FgtInFile);
  FreeAndNil(FInFile);
  FreeAndNil(FOutFile);
  FreeAndNil(FgtOutFile);
  FreeAndNil(FOutStream);
end;

procedure TestTgtLZWDecode.TestLookChar;
var
  ReturnValue: Integer;
begin
  ReturnValue := FgtLZWDecode.LookChar;
  OutValue := FgtOutFile.LookChar;
  Assert.AreEqual(ReturnValue, OutValue);
  // TODO: Validate method results
end;

procedure TestTgtLZWDecode.TestGetChar;
var
  LSin, LSout: string;
  LI: Integer;
begin
  LSin := '';
  LSout := '';
  for LI := 0 to 2 do
  begin
    LSin := LSin + Char(FgtLZWDecode.GetChar);
    LSout := LSout + Char(FgtOutFile.GetChar);
  end;

  Assert.AreEqualString(LSin, LSout);
end;

procedure TestTgtLZWDecode.TestGetPosition;
var
  ReturnValue: Int64;
begin
  ReturnValue := FgtLZWDecode.GetPosition;
  Assert.AreEqual(ReturnValue,0);
  // TODO: Validate method results
end;

procedure TestTgtLZWDecode.TestReadRawChar;
var
  ReturnValue, RawVal: Integer;
begin
  ReturnValue := FgtLZWDecode.ReadRawChar;
  RawVal:= FgtOutFile.GetChar;
  Assert.AreEqual(ReturnValue,RawVal);
  // TODO: Validate method results
end;

procedure TestTgtLZWDecode.TestReset;
begin
  FgtLZWDecode.Reset;
  // TODO: Validate method results
end;

initialization
  // Register any test cases with the test runner
  RegisterTest(TestTgtLZWDecode.Suite);
 
end.

