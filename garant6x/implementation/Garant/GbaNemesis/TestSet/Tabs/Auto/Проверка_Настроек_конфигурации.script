Тест Проверка_Настроек_конфигурации

 Параметры: ( "Восстановить настройки до теста" )
 Выполнить (
  "Открыть диалог Настройка конфигурации и выполнить" (  
   "Перейти к концу"
   STRING VAR "Последний раздел"
   "Контрол в фокусе" "Заголовок контрола" >>> "Последний раздел"
   "Переместиться в начало дерева"

   STRING VAR "Текущий раздел"
   30 раз ( 
    Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ  class::TvtCustomOutliner ) то
     ( "Контрол в фокусе" "Заголовок контрола" >>> "Текущий раздел"
       ' ' .
      '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~' .
      "Текущий раздел" .
      '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~' .
      20 раз ( 
       Если ( "Текущий раздел" РАВНО 'Мои документы' ) то
        ( выходим )
       "Нажать {('Tab')}"
       Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ  class::TvtCustomOutliner ) то 
        ( выходим )
       иначе (
        "Сравнить с эталоном выбранное значение, активность и хинт текущего контрола"
        Если ( "Контрол в фокусе" ЯВЛЯЕТСЯ class::TvtCheckBox ) то
         ( 'Галочка: ' "Получить состояние чекбокса {("Контрол в фокусе")}" ToPrintable Cat . ) 
        "Отделить текст в эталоне"
       )
      )
      Если ( "Текущий раздел" РАВНО "Последний раздел" ) то
       ( выходим )
      иначе (
       "Нажать {('Right')}"
       "Дождаться переключения вкладок"
       "Нажать {('Down')}"
       "Дождаться переключения вкладок"
      )
     )
   )
  )
 )
;

Проверка_Настроек_конфигурации