unit nsIntegrationSupport;

interface

type
 TIntergationDataKind = (idkCommand, idkLink, idkCheckIntegrationKey);

 TnsLinkDataArray = array [0..0] of byte;
 PnsLinkDataArray = ^TnsLinkDataArray;

 PIntegrationData = ^TIntegrationData;
 TIntegrationData = packed record
  OpenInNewWindow: Boolean;
  case Kind: TIntergationDataKind of
   idkCommand: (Command: Integer);
   idkLink: (LinkLength: Integer; Link: TnsLinkDataArray);
   idkCheckIntegrationKey: (KeyLength: Integer; Key: TnsLinkDataArray);
 end;

const
 c_IntegrationMessageName = '{394AC4BC-9BC4-4A75-BE21-40CC58511CD6}';
 c_IntergationMutexName = '{BC46C623-DBC9-473E-B8CC-9E7CBD8ACBC3}';
 c_LastMainWindowMessageName = '{1CDEED58-DDBF-4AC9-B86F-8D957B46E59C}';

 // коды ошибок
 GI_OK = 0; // Нет ошибок
 GI_NOTFOUND = 1; // Система Гарант не найдена
 GI_INVALIDLINKFORMAT = 2; // Неверный формат ссылки
 GI_BUSY = 3; // Система Гарант занята (отображает модальный диалог, печатает и т.д.)
              // и не может обработать запрос
 GI_TIMEOUT = 4; // Тайм-аут при получении ссылки на главное окно Гаранта
 GI_ALREADYRUNNING = 5; // Система Гарант уже запущена
 GI_SYSTEMERROR = 6; // Общесистемная ошибка (нет xml-парсера, битая база и пр.)
 GI_QUERYPARAMSHASABSENTVALUES = 7; // Ссылка-запрос содержит условия, которые при
                                    // попытке выполнить запрос на текущей
                                    // базе будут игнорированы
 GI_USERDENYLOGIN = 8; // При запуске системы пользователь отказался от авторизации
 GI_TRYTOFINDEMPTYCONTEXT = 9; // Попытка поиска пустого контекста
 GI_TOOMANYOPENWINDOWS = 10; // Слишком много открытых окон

 // Команды
 GC_ACTIVATE              = 0; // Просто запустить/активировать текущее окно
 GC_MAIN_MENU             = 1; // Основное меню
 GC_NAVIGATOR             = 2; // Правовой навигатор
 GC_SITUATION_SEARCH      = 3; // Поиски по ситуации,
 GC_ATTRIBUTES_SEARCH     = 4; // Поиски по реквизитам,
 GC_PUBLISH_SOURCE_SEARCH = 5; // Поиски по источнику опубликования,
 GC_REVIEW                = 7; // Обзор изменений в законодательстве
 GC_DICTION               = 8; // Толковый словарь
 GC_NEW_DOCS              = 9; // Новые документы из Справочной информации
 GC_INPHARM_SEARCH        = 10; // Поиск лекарственного препарата
 GC_DRUG_LIST             = 11; // Список лекарственных препаратов
 GC_INPHARM_MAIN_MENU     = 12; // Основное меню Инфарм
 GC_IMPHARM_DICTION       = 13; // Словарь мед. терминов
 GC_INTERNET_AGENT        = 14; // Новости онлайн
 GC_OPEN_CONSULT          = 15; // Задать вопрос эксперту
 GC_PRIME                 = 16; // Моя новостная лента

 GC_FIRST = GC_ACTIVATE;
 GC_LAST  = GC_PRIME;

implementation

end.