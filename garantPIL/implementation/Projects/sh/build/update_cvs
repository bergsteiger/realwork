#!/bin/sh

if test "$1" = "" ; then
echo "Usage: update_cvs <module> [<branch>]"
echo "<branch> = {<branch>|HEAD|-n}; -n = read-only update (in order to show file status only)"
exit
fi

if test "$MPCXC_ROOT" = ""; then
echo "You must export MPCXC_ROOT env to point to the root of your Multi Platform Common eXtra Code."
exit
fi

mod_name=$1
branch_name=$2

echo "update_cvs: $mod_name $branch_name ..."

if test "$branch_name" = "" ; then
	rev_com=""
	rd_only=""
else
	if test "$branch_name" = "HEAD" ; then
		rev_com="-A"
	else
		if test "$branch_name" != "-n" ; then
			rev_com="-r $branch_name"
		else
			rd_only="-n"
		fi
	fi
fi

if test "$MPCXC_CVS_DATE" = "" ; then
	cvs_date=""
else
	cvs_date="-D $MPCXC_CVS_DATE"
	echo "update_cvs: date = $MPCXC_CVS_DATE"
fi

tmp_curdir=$PWD
cd $MPCXC_ROOT/src

export CVSROOT=":pserver:$MPCXC_CVS_USER@developer.garant.ru/export/home/cvs"

if test "$rd_only" != "-n" ; then
	update_options="-P -d -C"
else
	update_options=""
fi

cvs $rd_only update $cvs_date $update_options $rev_com $mod_name

cd $tmp_curdir

echo "end."

