                         Описание работы с защитой.
                         --------------------------


Функции для работы с электронным ключем
---------------------------------------

Функция:                FindHasp
Необходимые модули:     hasp.obj
Заголовок:              hasp.h
Описание:               int FindHasp (void);
Параметры:              нет
Результат:              одно из значений ERR_ (см. приложение 1)
Действие:               проверяет наличие ключа HASP


Функция:                IncreaseCounter
Необходимые модули:     hasp.obj
Заголовок:              hasp.h
Описание:               int IncreaseCounter (char *Product, int CopyType);
Параметры:              Product - имя продукта (см. приложение 2)
                        CopyType - тип версии (см. приложение 3)
Результат:              одно из значений ERR_ (см. приложение 1)
Действие:               Увеличить счетчик установок в ключе


Функция:                CheckCounter
Необходимые модули:     hasp.obj
Заголовок:              hasp.h
Описание:               int CheckCounter (char *Product, int CopyType);
Параметры:              Product - имя продукта (см. приложение 2)
                        CopyType - тип версии (см. приложение 3)
Результат:              одно из значений ERR_ (см. приложение 1)
Действие:               Проверить, можно ли увеличить счетчик установок в ключе


Функции для работы с ключевой дискетой
--------------------------------------

Функция:                IsKeyDisk
Необходимые модули:     checklab.c, common.c, dellab.c, labels.c, qcrc.c
Заголовок:              labels.h, hasp.h
Описание:               int IsKeyDisk (int Floppy);
Параметры:              Floppy - номер устройства (0=A, 1=B, ...)
Результат:              1 - Дискета ключевая
                        0 - Дискета не является ключевой
Действие:               Проверка: является ли дискета ключевой


Функция:                CheckCopy
Необходимые модули:     checklab.c, common.c, dellab.c, labels.c, qcrc.c
Заголовок:              labels.h, hasp.h
Описание:               int CheckCopy (int Floppy, char *base, int CopyType);
Параметры:              Floppy - номер устройства (0=A, 1=B, ...)
                        base - имя продукта (см. приложение 2)
                        CopyType - тип версии (см. приложение 3)
Результат:              1 - есть копии
                        0 - нет копий
Действие:               Проверка наличия копий указанного продукта указанного
                        типа на ключевой дискете


Функция:                DecreaseCopy
Необходимые модули:     checklab.c, common.c, dellab.c, labels.c, qcrc.c
Заголовок:              labels.h, hasp.h
Описание:               int DecreaseCopy (int Floppy, char *base, int cpType);
Параметры:              Floppy - номер устройства (0=A, 1=B, ...)
                        base - имя продукта (см. приложение 2)
                        CopyType - тип версии (см. приложение 3)
Результат:              1 - есть копии
                        0 - нет копий
Действие:               Уменьшение количества копий указанного продукта
                        указанного типа на ключевой дискете


Приложение 1. Значения, возвращаемые функциями работы с электронным ключем.
---------------------------------------------------------------------------

Константа     Значение  Описание
---------------------------------------------------------------------------
ERR_NOERROR      0      Нет ошибок
ERR_NOHASP      -1      HASP не найден
ERR_READHAS     -2      Ошибка чтения HASP
ERR_WRITEHASP   -3      Ошибка записи HASP
ERR_BADHASP     -4      HASP не содержит нужной сигнатуры
ERR_BADREQUEST  -5      Неправильный параметр "тип копии"
ERR_OVERFLOW    -6      Переполнение счетчика
ERR_NOTINLIST   -7      Продукт не найден в списке


Приложение 2. Продукты.
-----------------------

"MAXIMUM"       Гарант-Максимум
"MASTER"        Гарант-Мастер
"UNIVERSL"      Гарант-Универсал
"CLASSIC"       Гарант-Классик
"CPRAKTIK"      Гарант-Практик
"MEDICINE"      Медицинская база
"GAR_ENG"	Английская база


Приложение 3. Типы версий.
--------------------------

Константа     Значение  Описание
---------------------------------------------------------------------------
LABEL_LOC       1       Локальная версия
LABEL_NET       2       Сетевая многопользовательская версия
LABEL_ONE       3       Однопользовательская сетевая версия
LABEL_VB        4       Версия для сетей типа Banyan Vines