'$Include "global.sbl"
'$include "States.sbl"
Sub Main
    Call NeedState (ST_MAIN_MENU)
    CUR_STATE=ST_NONE_STANDART   
    Window SetContext, "Caption={ГАРАНТ*}", ""
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=10,50"
    ListBox Click, "ObjectIndex=1", "Coords=14,260"
    InputKeys "{HOME}"
    call Position_Internal("CurrentFocus","Правовой навигатор\Судебная и арбитражная практика")
    InputKeys "{ENTER}"
    Window SetContext, "Caption={ГАРАНТ*}", ""
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=6,234"
    ListBox Click, "ObjectIndex=1", "Coords=14,9"
    call Position_by_Text("CurrentFocus","Суд и судоустройство, адвокатура и юридическая помощь")
    ListBox Click, "ObjectIndex=5", "Coords=12,49"
    InputKeys "{HOME}"
    Dim ItemDel$
    SQAGetProperty "CurrentFocus","Text",ItemDel
    InputKeys "{DELETE}{HOME}"
    SQASuspendLogOutput
    Dim res%
    res=Position_Internal("CurrentFocus",ItemDel,1)
    SQAResumeLogOutput
    if res<>0 then
    SQALogMessage sqaFail, "Ошибка! Элемент не был удалён", "Элемент с именем: "+ItemDel+"найден!"
      
    else
      SQALogMessage sqaPass, "Элемент был удалён", "Элемент с именем: """+ItemDel+""" не найден!"
    end if 
    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    MenuIdSelect 12
    Toolbar Click, "Text=Навигатор", "Coords=11,15"
    Toolbar Click, "Text=Навигатор", "Coords=11,15"
    
End Sub
