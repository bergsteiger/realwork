'$Include "global.sbl"

'$include "States.sbl"
Sub Main
    Call NeedState (ST_MAIN_MENU)
    CUR_STATE=ST_NONE_STANDART
'создаём папку с именем, совпадающим с закладкоу в этой папке.
    Dim sBook$
    sBook=SetBookMark("10003000",0)
    Window SetContext, "Caption={ГАРАНТ*}", ""
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=8,115"
    ListBox Click, "ObjectIndex=1", "Coords=30,10"
    GenericObject Click, "Class=TvcmToolbar;ClassIndex=4", "Coords=6,6"
    EditBox Click, "ObjectIndex=2", ""
    ClipBoard.SetText sBook
    InputKeys "{END}+{HOME}"
    InputKeys "+{INSERT}"
    
    GenericObject Click, "Class=TvcmToolbar;ClassIndex=9", "Coords=22,4"
    'GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
    ListBox Click, "ObjectIndex=1", "Coords=30,10"
    if Position_by_Text("Type=ListBox;ObjectIndex=1",sBook)<>0 then
        SQALogMessage sqaPass, "Элемент создался", "Элемент с именем "+sBook+" создался"
        InputKeys "{DELETE}"
        Window SetContext, "Caption=ГАРАНТ;Class=#32770", ""
        InputKeys "{ENTER}"
        Window SetContext, "Caption={ГАРАНТ*}", ""
        if Position_by_Text("Type=ListBox;ObjectIndex=1",sBook)<>0 then
            SQALogMessage sqaPass, "Элемент создался", "Элемент с именем "+sBook+" создался"
            InputKeys "{DELETE}"            
        else
            SQALogMessage sqaFail, "Элемент не создался", "Элемент с именем "+sBook+" не создался"
        end if

        
        'PushButton Click, "Text=Да"
        
    else
        SQALogMessage sqaFail, "Элемент не создался", "Элемент с именем "+sBook+" не создался"
    end if
   ' call DeleteFolder(sBook,2)    
   ' call DeleteFolder(sBook)    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
    GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
    Window SetContext, "Caption={ГАРАНТ*}", ""
    MenuIDSelect 12
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=6,36"
End Sub
