'$Include "global.sbl"
'$include "States.sbl"
Sub Main
    Call NeedState (ST_MAIN_MENU)
    CUR_STATE=ST_NONE_STANDART

    Dim sBook$
    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    InputKeys "{F7}"
    GenericObject Click, "Class=TComboBoxQS;ClassIndex=11", "Coords=25,8"
    InputKeys "^{ENTER}"
    Window SetContext, "Caption=ГАРАНТ;Class=#32770", ""
    'PushButton Click, "Text=Да"
    InputKeys "{ENTER}"
    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    call Click_SaveAs
    
    Window SetContext, "Caption=Мои документы (Сохранить как...)", ""
    SQAGetProperty "Type=EditBox;ObjectIndex=2","Text",sBook
    ToolBar Click, "Text=Выбор действия", "Coords=37,13"
    
    
    
    
    
    'создаём папку с именем, совпадающим с закладкоу в этой папке.    
'    Window SetContext, "Caption={ГАРАНТ*}", ""
'    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=8,115"
'    ListBox Click, "ObjectIndex=1", "Coords=35,10"
'    GenericObject Click, "Class=TvcmToolbar;ClassIndex=4", "Coords=6,6"
'    EditBox Click, "ObjectIndex=2", ""
'    ClipBoard.SetText sBook
'    InputKeys "{END}+{HOME}"
'    InputKeys "+{INSERT}"
    call CreateFolder("Мои документы",sBook)
    Window SetContext, "Caption={ГАРАНТ*}", ""
    Toolbar Click, "ObjectIndex=6;VisualText=Папки", "Coords=16,17"
    ListBox Click, "ObjectIndex=1", "Coords=35,10"
    if Position_by_Text("Type=ListBox;ObjectIndex=1",sBook)<>0 then
        SQALogMessage sqaPass, "Элемент создался", "Элемент с именем "+sBook+" создался"
        InputKeys "{DELETE}"
        Window SetContext, "Caption=ГАРАНТ;Class=#32770", ""
        InputKeys "{ENTER}"
        Window SetContext, "Caption={ГАРАНТ*}", ""
        if Position_by_Text("Type=ListBox;ObjectIndex=1",sBook)<>0 then
            SQALogMessage sqaPass, "Элемент создался", "Элемент с именем "+sBook+" создался"
            InputKeys "{DELETE}"
        else
            SQALogMessage sqaFail, "Элемент не создался", "Элемент с именем "+sBook+" не создался"
        end if
       
    else
        SQALogMessage sqaFail, "Элемент не создался", "Элемент с именем "+sBook+" не создался"
    end if
    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    Toolbar Click, "ObjectIndex=6;VisualText=Папки", "Coords=16,17"
    'GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
    Window SetContext, "Caption={ГАРАНТ*}", ""
    MenuIDSelect 12
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=6,36"
End Sub
