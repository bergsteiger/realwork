'$Include "global.sbl"
'$include "States.sbl"
Sub Main
    Call NeedState (ST_MAIN_MENU)
    CUR_STATE=ST_NONE_STANDART
   Dim sBook$
   sBook=SetBookMark("10003000",1)
   Window SetContext, "Caption={ГАРАНТ*}", ""
   MenuIDSelect 12
   'переходим по закладке
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=10,140"
    ListBox Click, "ObjectIndex=1", "Coords=49,11"
    Toolbar Click, "ObjectIndex=6;VisualText=Папки", "Coords=17,15"
    'GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=12,14"
    if Position_by_Text("CurrentFocus",sBook)<>0 then
        InputKeys "{ENTER}"
        DelayFor 2000
        RichEdit Click, "ObjectIndex=1", "Coords=7,10"
        InputKeys "^+{RIGHT}"
        Result = RichEditVP (CompareImage, "ObjectIndex=1", "VP=MiddleDoc")
        
        Window SetContext, "Caption={ГАРАНТ*}", ""
        GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=10,140"
        ListBox Click, "ObjectIndex=1", "Coords=49,11"
        call  Position_by_Text("CurrentFocus",sBook)
        InputKeys "{DELETE}"
        Window SetContext, "Caption=ГАРАНТ;Class=#32770", ""
        InputKeys "{ENTER}"
        
    else
        SQALogMessage sqaFail, "Закладки нет!!!", "Закладка с именем ""+sBook+"" отсутствует!"
    end if
    Window SetContext, "Caption={ГАРАНТ*}", ""
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=10,145"
    'GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=12,14"
    Toolbar Click, "ObjectIndex=6;VisualText=Папки", "Coords=17,15"
    Window SetContext, "Caption={ГАРАНТ*}", ""
    MenuIDSelect 12
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=19,64"
    
End Sub
