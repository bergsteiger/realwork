'$Include "global.sbl"
'$include "States.sbl"
Sub Main
    Call NeedState (ST_MAIN_MENU)
    CUR_STATE=ST_NONE_STANDART
    
   Window SetContext, "Caption={ГАРАНТ*}", ""
    MenuIDSelect 104
    'ListView Click, "ObjectIndex=1;\;ItemText=Гарант 5.х", "Coords=39,52"
    ListView Click, "ObjectIndex=1;\;ItemText=Гарант 5.х", ""
  
'    Window SetContext, "Caption=Сообщение", ""
'    PushButton Click, "Text=OK"
   
   Window SetContext, "Caption={ГАРАНТ*}", ""
    
    'Window SetContext, "Caption=ГАРАНТ 6 - Основное меню", ""
    InputKeys "{F7}"
    EditBox Click, "ObjectIndex=4", ""
    call Click_FindSaveAs


    Window SetContext, "Caption=Мои документы (Сохранить как...)", ""
    InputKeys "Пустой запрос"
    ToolBar Click, "Text=Выбор действия", "Coords=41,9"
   
   Dim QueryName$
   QueryName="Пустой запрос"
   Window SetContext, "Caption={ГАРАНТ*}", ""
   MenuIDSelect 12
   Window SetContext, "Caption={ГАРАНТ*}", ""
   GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=7,140"
   Toolbar Click, "ObjectIndex=6;VisualText=Папки", "Coords=16,17"
   ListBox Click, "ObjectIndex=1", "Coords=56,13"
   if Position_by_Text("CurrentFocus",QueryName)<>0 then
        SQALogMessage sqaPass, "Элемент создался", "Элемент с именем """+QueryName+""" создался"
        InputKeys "{DELETE}"
        Window SetContext, "Caption=ГАРАНТ;Class=#32770", ""
        InputKeys "{ENTER}"   
   else
        SQALogMessage sqaFail, "Элемент не создался", "Элемент с именем """+QueryName+""" не создался"
   end if
   Window SetContext, "Caption={ГАРАНТ*}", ""
   Toolbar Click, "ObjectIndex=6;VisualText=Папки", "Coords=16,17"
   'GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
   Window SetContext, "Caption={ГАРАНТ*}", ""
   MenuIDSelect 12
   GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=6,36"
   
    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=13,226"
    ListView Click, "ObjectIndex=1;\;ItemText=Стандартная", ""
 
'    Window SetContext, "Caption=Сообщение", ""
'    PushButton Click, "Text=OK"
    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    Toolbar Click, "ObjectIndex=1;\;ItemIndex=0", ""
    
    
End Sub
