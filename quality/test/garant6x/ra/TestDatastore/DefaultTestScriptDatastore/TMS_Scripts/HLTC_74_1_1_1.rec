'$Include "global.sbl"

'функция для позиционирования указателя на необходимом элементе, в том числе и находящегося в свёрнутом элементе
'необходимо задавать полный путь к интересующему элементу, разделяя уровня косой чертой, например:
' "Форма документа\Акт" - в результате позиционируемся на элементе Акт, находящемся в ветке Формы документа
'! Не пойму почему так медленно работает в дилоге выбора реквизитов, похоже, что тормаза возникают при
' получении текста текущего элемента дерева, но вроде в других деревьях нормально было!.
'параметры передаваемые в функцию такие же как и в предыдущей (выполняющей простое позиционирование)
'$include "States.sbl"
Sub Main
    Call NeedState (ST_MAIN_MENU)
    CUR_STATE=ST_NONE_STANDART    
'Скрипт создаёт две папки на одном уровне с различными именами, соответсвенно,
'выполняется проверка того что в списке появились эти папки!!!
'Скрипт заканчивает свою работу переходом к  основного меню, и в левом навигаторе активна закладка "Навигатор" (это не обязательно)
    Window SetContext, "Caption={ГАРАНТ*}", ""
    call CreateFolder("Мои документы","Новая")
    call CreateFolder("Мои документы","Ещё новее")
'    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=8,115"
'    ListBox Click, "ObjectIndex=1", "Coords=20,10"
'    GenericObject Click, "Class=TvcmToolbar;ClassIndex=4", "Coords=6,6"
'    EditBox Click, "ObjectIndex=2", ""
'    InputKeys "{END}+{HOME}Новая"
'    GenericObject Click, "Class=TvcmToolbar;ClassIndex=9", "Coords=10,11"
'    ListBox Click, "ObjectIndex=1", "Coords=16,11"
'    GenericObject Click, "Class=TvcmToolbar;ClassIndex=4", "Coords=14,9"
'    EditBox Click, "ObjectIndex=2", ""
'    InputKeys "{END}+{HOME}Ещё новее"
'    'GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
    ListBox Click, "ObjectIndex=1", "Coords=38,7"
    'InputKeys "{HOME}"
    if Position_Internal("CurrentFocus","Мои документы\Новая")<>0 then
        SQALogMessage sqaPass, "Папка создалась", "Папка с именем ""Новая"" создалась"
        InputKeys "{DELETE}"
    else
        SQALogMessage sqaFail, "Папка не создалась", "Папка с именем ""Новая"" не создалась"
    end if
    InputKeys "{HOME}"
    if Position_by_Text("CurrentFocus","Ещё новее")<>0 then
        SQALogMessage sqaPass, "Папка создалась", "Папка с именем ""Ещё новее"" создалась"
        InputKeys "{DELETE}"
    else
        SQALogMessage sqaFail, "Папка не создалась", "Папка с именем ""Ещё новее"" не создалась"
    end if
    
    Window SetContext, "Caption={ГАРАНТ*}", ""
    GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
    GenericObject Click, "Class=TvcmToolbar;ClassIndex=5", "Coords=15,14"
    Window SetContext, "Caption={ГАРАНТ*}", ""
    MenuIDSelect 12
    GenericObject Click, "Class=TElPageControlNavigator;ClassIndex=1", "Coords=6,36"
    
End Sub
