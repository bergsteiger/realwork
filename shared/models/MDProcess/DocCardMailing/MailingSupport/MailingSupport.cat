
(object Petal
    version    	50
    _written   	"Rose 2006.0.0.060314"
    charSet    	204)

(object Class_Category "MailingSupport"
    is_unit    	TRUE
    is_loaded  	TRUE
    attributes 	(list Attribute_Set
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"ElementCreationOrder"
	    value      	"280860846339")
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"AbstarctOperation"
	    value      	"regular")
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"GlobalLocally"
	    value      	"false")
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"IsNative"
	    value      	"false")
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"WikiPageID (wiki)"
	    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport|4E5667BB019F
	    ))
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"SourceType (wiki)"
	    value      	"wiki")
	(object Attribute
	    tool       	"MDA Generator User Properties"
	    name       	"name"
	    value      	"MailingSupport")
	(object Attribute
	    tool       	"MDA Generator User Properties"
	    name       	"vendor name"
	    value      	"ÎÎÎ ÍÏÏ 'Ãàðàíò-Ñåðâèñ'")
	(object Attribute
	    tool       	"MDA Generator User Properties"
	    name       	"vendor url"
	    value      	"www.garant.ru")
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"ApplyedGens"
	    value      	"All")
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"NESTED GENERATED FILES (java)"
	    value      	"")
	(object Attribute
	    tool       	"MDA Generator"
	    name       	"NESTED GENERATED WikiPageID (wiki)"
	    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport/FindAndSendMailWithSubjectDelayInExportDocCardsForMoscow|50D0620400F9::50D0620400F9;MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport/FindAndSendMailWithSubjectDelayInExportDocCardsForTambov|50D0620E0169::50D0620E0169;MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport/MailingListener|4E56680702B5::4E56680702B5
	    )))
    quid       	"4E5667BB019F"
    documentation 	"MailingSupport"
    stereotype 	"KPlugins"
    visible_categories 	(list visibility_relationship_list
	(object Visibility_Relationship
	    quid       	"4E5668410119"
	    supplier   	"Logical View::MDProcess::DocCardMailing::Mailing"
	    quidu      	"4E54C59003D4")
	(object Visibility_Relationship
	    quid       	"4E5B683C0294"
	    supplier   	"Logical View::MDProcess::DocCardChange::Entities"
	    quidu      	"4C37135C025B")
	(object Visibility_Relationship
	    quid       	"4EE87BE30118"
	    supplier   	"Logical View::external::ConfluenceSupport::com.atlassian.confluence.mail"
	    quidu      	"4E55163E0315")
	(object Visibility_Relationship
	    quid       	"4FB9FC120223"
	    supplier   	"Logical View::MDProcess::ConfluencePlugins::EntitySupport"
	    quidu      	"4B1F4958003C")
	(object Visibility_Relationship
	    quid       	"53E88E3C0209"
	    supplier   	"Logical View::MDProcess::DocCardChange::DocCardSupport"
	    quidu      	"4C3F058C039B"))
    exportControl 	"Public"
    logical_models 	(list unit_reference_list
	(object Class "MailingJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1731788221193")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/MailingJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport/MailingJob|4E84777001E7
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0/10 * * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4E84777001E7_CUSTOM_IMPORT*"
		    value      	"//#UC START# *4E84777001E7_CUSTOM_IMPORT*¤import com.atlassian.confluence.mail.Mail;¤import com.atlassian.confluence.setup.bandana.ConfluenceBandanaContext;¤import com.atlassian.confluence.spaces.Space;¤import com.atlassian.confluence.user.AuthenticatedUserThreadLocal;¤import com.atlassian.mail.Email;¤import com.atlassian.user.search.SearchResult;¤import com.atlassian.user.Group;¤import com.atlassian.user.User;¤¤import ru.garant.MDProcess.ConfluencePlugins.EmailNotification.EmailGateway;¤import ru.garant.shared.ConfluenceCore.Helpers.ContainerManager;¤import ru.garant.MDProcess.DocCardMailing.FromToEmailDAO;¤import ru.garant.MDProcess.DocCardMailing.MailingDAO;¤import ru.garant.MDProcess.DocCardMailing.Mailing.DocCardContent;¤import ru.garant.MDProcess.DocCardMailing.Mailing.DocCardFile;¤import ru.garant.MDProcess.DocCardMailing.MailingImpl.MailMailingItem;¤import ru.garant.shared.ConfluenceCore.ActionSupport.ActionContextThreadLocalFactory;¤import ru.garant.shared.ConfluenceCore.ActionSupportImpl.DefaultPostProcessor;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.CreateUvsQuery;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.DpoUvsHelper;¤¤import java.util.*;¤¤import org.apache.commons.lang.StringUtils;¤//#UC END# *4E84777001E7_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4E84777001E7_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *4E84777001E7_CUSTOM_CLASS_DEFINITION*¤¤//#UC END# *4E84777001E7_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4E84777001E7_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *4E84777001E7_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *4E84777001E7_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4E84777001E7_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *4E84777001E7_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤		//List<Space> spaces = DpoUvsHelper.getSpacesWhichHasGardocSettings();¤//		for(Space space : spaces){¤			String spaceKey = "DPOUVS";¤			Logs.LOG_D ("MailingJob.doExecute for spaceKey=" + spaceKey);¤			ConfluenceBandanaContext context = ConfluenceBandanaContext.GLOBAL_CONTEXT;¤//			if(space.getKey().equals("DPOUVS") == false){¤//				context = new ConfluenceBandanaContext(space.getKey());¤//			}¤			Long lastMailId = (Long) ContainerManager.Factory.get ().getBandanaManager ().getValue (context, "LAST_MAIL_ID");¤			if (lastMailId == null) {¤				lastMailId = 0l;¤			}¤			Logs.LOG_D ("MailingJob.doExecute, lastMailId = " + lastMailId);¤			try {¤				Mail emailReceived;¤				while ((emailReceived = ContainerManager.Factory.get ().getMailContentManager ().getFirstMailAfter (spaceKey, lastMailId)) != null) {¤					Logs.LOG_D("MailingJob.doExecute: processEmailReceived, emailReceived = " + emailReceived);¤					try {¤						MailingItem mailingItemReceived = MailingItem.Factory.make(emailReceived.getId(), "MAIL");¤						lastMailId = processEmailReceived (mailingItemReceived, spaceKey);					¤					} catch (Exception e) {¤						Logs.LOG_SEX (e);¤						lastMailId = emailReceived.getId();¤					}¤					ContainerManager.Factory.get ().getBandanaManager ().setValue (context, "LAST_MAIL_ID", lastMailId);¤					Logs.LOG_D ("MailingJob.doExecute: bandana.setValue, lastMailId = " + lastMailId + "  for spaceKey=" + spaceKey);¤				}¤			} finally {¤				Logs.LOG_D ("MailingJob.doExecute, begin DefaultPostProcessor.Factory.get().onPostCommitEvent() for spaceKey=" + spaceKey);¤				DefaultPostProcessor.Factory.get().onPostCommitEvent();			¤			}¤//		}¤	}¤¤	/*public Long processEmailReceivedNew (final Mail emailReceived) throws Exception {¤		//#UC START# *4EE87B6F0376*¤		if(!((emailReceived != null) && (emailReceived.getFrom() != null) && (emailReceived.getFrom().length > 0) && (emailReceived.getFrom () [0].getAddress () != null))) {¤			Logs.LOG_E("MailingJob.processEmailReceived: bad emailReceived = " + emailReceived);¤			throw new Exception ();			¤		}¤		¤		Long lastMailId = emailReceived.getId();¤		¤		Logs.LOG_D ("MailingJob.processEmailReceived: lastMailId = " + lastMailId);¤		Logs.LOG_D ("MailingJob.processEmailReceived: emailReceived from " + emailReceived.getFrom () [0].getAddress ());¤		Logs.LOG_D ("MailingJob.processEmailReceived: ContainerManager..getAttachments (emailReceived).size () = " + ContainerManager.Factory.get ().getAttachmentManager().getAttachments (emailReceived).size ());¤		¤		//ôîðìèðóåì êîíòåêñò¤		MailingContext mc = new MailingContext();¤		List <Attachment> attachments = ContainerManager.Factory.get ().getAttachmentManager().getAttachments (emailReceived);¤		if (attachments.size () > 0) {¤			try {¤				for (Attachment a : attachments) {				¤					FileContent fc = FileContent.Factory.make ();¤					fc.setBinaryStream (a.getContentsAsStream ());¤					mc.addFile(a.getFileName(), fc);¤				}¤			} catch (IOException e) {¤				String addr = ((emailReceived != null) && (emailReceived.getFrom() != null) && (emailReceived.getFrom().length>0)) ? emailReceived.getFrom() [0].getAddress() : null;¤				Logs.LOG_E("MailingParser_i.extractAttachedFiles: IOException in attached files for email = " + addr);¤			}¤		}¤		¤		//ïîëó÷àåì ñîîòâåòñòâóþùèå MailingDAO è èõ âñå ïûòàåìñÿ ïðèìåíèòü		¤		List<FromToEmailDAO> currentFromToDaoList = FromToEmailDAO.getByEmailAddressFromId(emailReceived.getFrom () [0].getAddress ());¤		for (FromToEmailDAO currentFromToDao : currentFromToDaoList) {¤			¤			Logs.LOG_D ("MailingJob.processEmailReceived: found currentFromToDao, id = " + currentFromToDao.getId() + ", mailingid = " + currentFromToDao.getMailingDAO().getId());¤		¤			MailingDAO current = currentFromToDao.getMailingDAO();¤			if (current != null) {¤				¤			}¤		¤		}¤		return lastMailId;¤	}*/¤¤	protected boolean isNeedWriteTransaction() {¤		return true;¤	}¤	¤	public static void makeRequests (final List <DocCardContent> result, final StringBuilder log, final FromToEmailDAO currentFromToDao, final String senderAddress, final String spaceKey) {¤		MailingDAO current = currentFromToDao.getMailingDAO();¤		Logs.LOG_D ("MailingJob.processEmailReceived: log.length() = " + log.length());¤		if (result.size () > 0) {¤			Logs.LOG_D ("MailingJob.processEmailReceived: MailingParser result not empty, .size () = " + result.size ());¤			if (current.getRequestCreatorKey () != null && current.getRequestAuthor() != null) {¤				String[] creators = StringUtils.split(current.getRequestCreatorKey (), ",");¤				List<String> creatorsList = Arrays.asList(creators);¤				for(String currentCreator : creatorsList){¤					currentCreator = currentCreator.trim();¤					Logs.LOG_D ("MailingJob.processEmailReceived: RequestCreator, factory key = " + currentCreator);¤					RequestCreator rc = null;¤					try {¤						rc = RequestCreator.Factory.make (currentFromToDao, currentCreator);¤						rc.setCreateInNewTransaction(true);¤	¤					} catch (ru.garant.shared.Core.Root.UnknownFactoryKey e) {¤						Logs.LOG_D ("MailingJob.doExecute: no RequestCreator for " + senderAddress + ", use default");¤						rc = RequestCreator.Factory.make (currentFromToDao, "DEFAULT");¤					}¤					String creator = AuthenticatedUserThreadLocal.getUsername();¤					if(current.getRequestAuthor().contains("assignSender")){¤						¤						String senderName = getSenderNameFromAdress(senderAddress);¤						if(StringUtils.isNotEmpty(senderName)){¤							creator = senderName;¤						}¤					}¤					rc.process (result, new CreateUvsQuery(), log, creator, spaceKey); //TODO: remove from model because new inside the method¤				}¤			} else if (current.getRequestCreatorKey () == null){¤				Logs.LOG_W ("MailingJob.processEmailReceived: .getRequestCreatorKey is null for " + senderAddress + ", no requests created");¤			}else if(current.getRequestAuthor() == null){¤				Logs.LOG_W ("MailingJob.processEmailReceived: .getRequestAuthor is null for " + senderAddress + ", no requests created");¤			}¤		}¤		if(StringUtils.isNotEmpty(log.toString())){¤			sendMail(current, log, currentFromToDao);¤		}¤	}¤	¤	public static String getSenderNameFromAdress(final String senderAdress){¤		SearchResult sr = ContainerManager.Factory.get().getUserAccessor().getUsersByEmail(senderAdress);¤		Iterator it = sr.pager().iterator();¤		String senderName = null;¤		while(it.hasNext()){¤			User u = (User)it.next();¤			List<Group> groups = ContainerManager.Factory.get().getUserAccessor().getGroupsAsList(u);¤			if(groups.size() > 0){¤				if(StringUtils.isNotEmpty(senderName)){¤					return null;¤				}¤				senderName = u.getName();¤			}¤		}¤		return senderName;¤	}¤	¤	private static void sendMail(MailingDAO current, StringBuilder log, FromToEmailDAO currentFromToDao){¤		EmailGateway eg = EmailGateway.Factory.create();¤		Logs.LOG_D ("MailingJob.processEmailReceived: currentFromToDao.getEmailAddressReceiver () = " + currentFromToDao.getEmailAddressReceiver ());¤		Email emailForSend = eg.createEmail (¤			current.getNameTitle() + ", ëîã îáðàáîòêè " + (¤				log.toString ().matches ("[\\s\\S]*ÎØÈÁÊÀ[\\s\\S]*")¤				? "(ÅÑÒÜ ÎØÈÁÊÈ)"¤				: log.toString ().matches ("[\\s\\S]*ÎÁÐÀÁÎÒÀÍÎ 0 ÈÇ 0[\\s\\S]*") ? "(ÍÅÒ ÄÎÊÓÌÅÍÒÎÂ)" : "(óñïåøíûé)"¤			)  + " îò " + currentFromToDao.getEmailAddressFromId ()¤			, log.toString ().replace("\n", "\n<BR>")¤			, currentFromToDao.getEmailAddressReceiver () != null ? currentFromToDao.getEmailAddressReceiver () : "elenau@garant.ru,ses@garant.ru"¤		);¤		¤		Logs.LOG_D("Mailing log:\n" + log.toString ());¤		¤		Logs.LOG_D ("MailingJob.processEmailReceived: emailForSend = " + emailForSend + ", eg = " + eg);¤		eg.queueEmail (emailForSend);¤		¤		Logs.LOG_D ("MailingJob.processEmailReceived: ceg.send ()");¤		eg.send ();		¤	}¤	¤	public static void processReceivedFiles (final List<DocCardFile> emailReceivedFiles, final FromToEmailDAO currentFromToDao, final String senderAddress) throws Exception {¤		¤		Logs.LOG_D ("MailingJob.processEmailReceived: found currentFromToDao, id = " + currentFromToDao.getId() + ", mailingid = " + currentFromToDao.getMailingDAO().getId());¤	¤		MailingDAO current = currentFromToDao.getMailingDAO();¤		if (current != null) {¤	¤			Logs.LOG_D ("MailingJob.processEmailReceived: MailingParser, MailingDAO current.getNameTitle() = " + current.getNameTitle());¤			¤			MailingParser mail_parser = MailingParser.Factory.make (current);¤			¤			List<String> emFileNames = new ArrayList<String>(emailReceivedFiles.size());¤			for (DocCardFile dcf : emailReceivedFiles) {¤				emFileNames.add(dcf.getFileName());¤			}¤			¤			if (mail_parser.canParse (emFileNames)) {¤				StringBuilder log = new StringBuilder ();¤				List <DocCardContent> result = mail_parser.parse (emailReceivedFiles, log, currentFromToDao.getSpaceKey());¤				¤				addMailingToFileComment (result, mail_parser.getMailDAO());¤				¤				if (current.getIsAsync()) {¤					Logs.LOG_W("isAsync=true for " + current.getRequestCreatorKey());¤¤					MailingQueue.Factory.get().add(¤							current.getRequestCreatorKey()¤							, result¤							, currentFromToDao.getId()¤							, senderAddress¤							, currentFromToDao.getSpaceKey()¤					);¤				} else {¤					makeRequests (result, log, currentFromToDao, senderAddress, currentFromToDao.getSpaceKey());¤				}¤			} else {¤				Logs.LOG_W ("MailingJob.processEmailReceived: canParse FALSE for email from " + senderAddress + " as mailing algorithm '" + current.getNameTitle() + "', DAO id = " + current.getId());¤			}¤		}¤		¤	}¤	¤¤	public static void addMailingToFileComment (List <DocCardContent> result, MailingDAO mailing) {¤		for (DocCardContent dc : result) {¤			for (DocCardFile file : dc.getFiles()) {¤				if (StringUtils.isBlank(file.getFileComment())) {¤					String fileComment = mailing.getNameTitle() + " [" + mailing.getId() + "]";¤					file.setFileComment(fileComment);¤				}¤			}¤		}		¤	}¤	//#UC END# *4E84777001E7_CUSTOM_METHODS_AND_DATA*
		    )))
	    quid       	"4E84777001E7"
	    documentation 	"MailingJob"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1397808600670038"))
		    quid       	"5350DDD8029C"
		    supplier   	"Logical View::MDProcess::DocCardChange::DocCardSupport::GarDocAbstractJob"
		    quidu      	"53E4BF9000E2"))
	    used_nodes 	(list uses_relationship_list
		(object Uses_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1731819902298")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"AbstarctOperation"
			    value      	"regular")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"IsNative"
			    value      	"false"))
		    quid       	"4E84779000A5"
		    stereotype 	"uses"
		    supplier   	"Logical View::MDProcess::DocCardMailing::Mailing::RequestCreator"
		    quidu      	"4E79EC4501CD")
		(object Uses_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1731840575125")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"AbstarctOperation"
			    value      	"regular")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"IsNative"
			    value      	"false"))
		    quid       	"4E8477A40344"
		    stereotype 	"uses"
		    supplier   	"Logical View::MDProcess::DocCardMailing::Mailing::MailingParser"
		    quidu      	"4E54C62F00A5")
		(object Uses_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1373542789799300")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"AbstarctOperation"
			    value      	"regular")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"IsNative"
			    value      	"false"))
		    quid       	"51DE9985031E"
		    stereotype 	"uses"
		    supplier   	"Logical View::MDProcess::DocCardMailing::Mailing::MailingQueue"
		    quidu      	"51938049018D"))
	    operations 	(list Operations
		(object Operation "processEmailReceived"
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1323858799904149")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"AbstarctOperation"
			    value      	"regular")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"IsNative"
			    value      	"false")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ResolvedTypeGuid"
			    value      	"4775064E0397")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"java:*4EE87B6F0376*"
			    value      	(value Text 
|//#UC START# *4EE87B6F0376*¤		if(mailingItemReceived.getSender() == null) {¤			Logs.LOG_E("MailingJob.processEmailReceived: bad mailingItemReceived = " + mailingItemReceived);¤			throw new Exception ();			¤		}¤		¤		Long lastMailId = mailingItemReceived.getItemId();¤		¤		Logs.LOG_D ("MailingJob.processEmailReceived: lastMailId = " + lastMailId);¤		Logs.LOG_D ("MailingJob.processEmailReceived: mailingItemReceived from " + mailingItemReceived.getSender());¤		Logs.LOG_D ("MailingJob.processEmailReceived: ContainerManager.getAttachments (mailingItemReceived).size () = " + mailingItemReceived.getFilesSize());¤		¤		java.util.List<DocCardFile> emailReceivedFiles = mailingItemReceived.getFiles();¤		¤		List<FromToEmailDAO> currentFromToDaoList = FromToEmailDAO.getByEmailAddressFromId(mailingItemReceived.getSender());¤		for (FromToEmailDAO currentFromToDao : currentFromToDaoList) {¤			processReceivedFiles (emailReceivedFiles, currentFromToDao, mailingItemReceived.getSender());¤		}¤		return lastMailId;¤		//#UC END# *4EE87B6F0376*
			    ))
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"GetRaises"
			    value      	"47720AA401AF"))
		    quid       	"4EE87B6F0376"
		    stereotype 	"chg"
		    parameters 	(list Parameters
			(object Parameter "mailing_item_received"
			    attributes 	(list Attribute_Set
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ElementCreationOrder"
				    value      	"1435312539357876")
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ResolvedTypeGuid"
				    value      	"558D07E8033D"))
			    quid       	"558D219B015D"
			    type       	"MailingItem"
			    quidu      	"558D07E8033D")
			(object Parameter "space_key"
			    attributes 	(list Attribute_Set
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ElementCreationOrder"
				    value      	"1397808579845846")
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ResolvedTypeGuid"
				    value      	"3DBFFE240068"))
			    quid       	"5350DDC30347"
			    type       	"string"
			    quidu      	"3DBFFE240068"))
		    result     	"Long"
		    concurrency 	"Sequential"
		    opExportControl 	"Public"
		    uid        	0
		    quidu      	"4775064E0397"))
	    language   	"MDA Generator")
	(object Class "AddArchiExportDateFromNumberInUvsQueryInMail"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1332336186325935")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0/2 * * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/AddArchiExportDateFromNumberInUvsQueryInMail.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D63A0144_CUSTOM_IMPORT*"
		    value      	"//#UC START# *4F69D63A0144_CUSTOM_IMPORT*¤import java.util.Date;¤import java.util.ArrayList;¤import java.util.List;¤import java.util.regex.Matcher;¤import java.util.regex.Pattern;¤¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.UVSQuestDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.DpoUvsHelper;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.GarDocAbstractJob;¤import ru.garant.MDProcess.DocCardChange.Entities.UVSQueryManager;¤import ru.garant.shared.ConfluenceCore.ActionSupport.ActionContextThreadLocalFactory;¤import com.atlassian.confluence.setup.bandana.ConfluenceBandanaContext;¤import com.atlassian.confluence.spaces.Space;¤¤import com.atlassian.gzipfilter.org.apache.commons.lang.StringUtils;¤import com.atlassian.confluence.mail.address.ConfluenceMailAddress;¤//#UC END# *4F69D63A0144_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D63A0144_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *4F69D63A0144_CUSTOM_CLASS_DEFINITION*¤//#UC END# *4F69D63A0144_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D63A0144_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *4F69D63A0144_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *4F69D63A0144_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D63A0144_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *4F69D63A0144_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤//		List<Space> spaces = DpoUvsHelper.getSpacesWhichHasGardocSettings();¤//		for(Space space : spaces){¤			String spaceKey = "DPOUVS";¤			ConfluenceBandanaContext context = new ConfluenceBandanaContext(spaceKey);¤			if(spaceKey.equals("DPOUVS")){¤				context = ConfluenceBandanaContext.GLOBAL_CONTEXT;¤			}¤			Long lastMailId = (Long) ContainerManager.Factory.get ().getBandanaManager ().getValue (context, "LAST_MAIL_ID_FOR_ARCHI_EXPORT_DATE");¤			if (lastMailId == null) {¤				lastMailId = 0l;¤			}¤			Logs.LOG_D ("AddArchiExportDateFromNumberInUvsQueryInMail.doExecute, lastMailId = " + lastMailId);¤			List<String> requestsNumbers = new ArrayList<String>();¤			Mail emailReceived;¤			try {¤				while ((emailReceived = ContainerManager.Factory.get ().getMailContentManager ().getFirstMailAfter (spaceKey, lastMailId)) != null) {¤					Logs.LOG_D("AddArchiExportDateFromNumberInUvsQueryInMail.doExecute: processEmailReceived, emailReceived = " + emailReceived);¤					requestsNumbers = getNumbersFromMail (emailReceived, spaceKey);¤					findUvsQueriesAndAddToCopyExportDate(requestsNumbers);¤					lastMailId = emailReceived.getId();¤					ContainerManager.Factory.get ().getBandanaManager ().setValue (context, "LAST_MAIL_ID_FOR_ARCHI_EXPORT_DATE", lastMailId);¤				}¤			} catch (Exception e) {¤				Logs.LOG_SEX (e);¤			}¤//		}¤	}¤	¤	protected boolean isNeedWriteTransaction() {¤		return true;¤	}¤	//#UC END# *4F69D63A0144_CUSTOM_METHODS_AND_DATA*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport/AddArchiExportDateFromNumberInUvsQueryInMail|4F69D63A0144
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki"))
	    quid       	"4F69D63A0144"
	    documentation 	"Äæîá, êîòîðûé çàïóñêàåòñÿ ðàç â äâå ìèíóòû, ïðîâåðÿåò ÍÎÂÛÅ ïèñüìà âî âõîäÿùåé ïî÷òå è âñå ñ òåìîé Ñèíõðîíèçàöèÿ ñ MDP íà÷èíàåò îáðàáàòûâàòü"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1337600382700434"))
		    quid       	"4FBA297E02BB"
		    supplier   	"Logical View::MDProcess::DocCardChange::DocCardSupport::GarDocAbstractJob"
		    quidu      	"53E4BF9000E2"))
	    operations 	(list Operations
		(object Operation "get_numbers_from_mail"
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1332336383374206")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"AbstarctOperation"
			    value      	"regular")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"IsNative"
			    value      	"false")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ResolvedTypeGuid"
			    value      	"49816B2C0043")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"GetRaises"
			    value      	"47720AA401AF")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"java:*4F69D6FF016B*"
			    value      	(value Text 
|//#UC START# *4F69D6FF016B*¤		if(!((emailReceived != null) && (emailReceived.getFrom() != null) && (emailReceived.getFrom().length > 0) && (emailReceived.getFrom () [0].getAddress () != null))) {¤			Logs.LOG_E("AddArchiExportDateFromNumberInUvsQueryInMail.getNumbersFromMail: bad emailReceived = " + emailReceived);¤			throw new Exception ();			¤		}¤		¤		Long lastMailId = emailReceived.getId();¤		¤		Logs.LOG_D ("AddArchiExportDateFromNumberInUvsQueryInMail.getNumbersFromMail: lastMailId = " + lastMailId);¤		Logs.LOG_D ("AddArchiExportDateFromNumberInUvsQueryInMail.getNumbersFromMail: emailReceived from " + emailReceived.getFrom () [0].getAddress ());¤¤		List<String> numbers = new ArrayList<String>();¤		ConfluenceBandanaContext context = new ConfluenceBandanaContext(spaceKey);¤		String content = emailReceived.getMessageBody();¤		¤		String regex = (String) ContainerManager.Factory.get ().getBandanaManager ().getValue (context, "AddArchiExportDateFromNumberInUvsQueryInMail.RegexForParseSynchronizationMail2");¤		Pattern pattern = Pattern.compile(regex);¤		Matcher m = pattern.matcher(content);¤		while (m.find()) {¤			String number = (String)m.group(1);¤			Logs.LOG_D ("AddArchiExportDateFromNumberInUvsQueryInMail.getNumbersFromMail: nextNumber = " + number);¤			numbers.add(number);¤		}¤		return numbers;¤		//#UC END# *4F69D6FF016B*
			    )))
		    quid       	"4F69D6FF016B"
		    stereotype 	"chg"
		    parameters 	(list Parameters
			(object Parameter "emailReceived"
			    attributes 	(list Attribute_Set
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ElementCreationOrder"
				    value      	"1332336563469508")
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ResolvedTypeGuid"
				    value      	"4E5516560315"))
			    quid       	"4F69D7B301CD"
			    type       	"Mail"
			    quidu      	"4E5516560315")
			(object Parameter "space_key"
			    attributes 	(list Attribute_Set
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ElementCreationOrder"
				    value      	"1397808411346207")
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ResolvedTypeGuid"
				    value      	"3DBFFE240068"))
			    quid       	"5350DD1B0153"
			    type       	"string"
			    quidu      	"3DBFFE240068"))
		    result     	"StringList"
		    concurrency 	"Sequential"
		    opExportControl 	"Public"
		    uid        	0)
		(object Operation "find_uvs_queries_and_add_to_copy_export_date"
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1332336656298819")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"AbstarctOperation"
			    value      	"regular")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"IsNative"
			    value      	"false")
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"java:*4F69D810011F*"
			    value      	(value Text 
|//#UC START# *4F69D810011F*¤		for(String number : numbers){¤			UVSQuestDAO uvsQuery = UVSQueryManager.Factory.get().getUvsQueryByNumber(number);¤			if(uvsQuery == null){¤				Logs.LOG_E("AddArchiExportDateFromNumberInUvsQueryInMail.findUvsQueriesAndAddToCopyExportDate:no found uvsQuery with number = " + number);¤			}else{¤				Logs.LOG_D ("AddArchiExportDateFromNumberInUvsQueryInMail.findUvsQueriesAndAddToCopyExportDate: save ArchiExportDate uvsQuery.contentid= " + uvsQuery.getId());¤				uvsQuery.getCopy().setArchiExportDate(new Date());¤			}¤		}¤		//#UC END# *4F69D810011F*
			    )))
		    quid       	"4F69D810011F"
		    stereotype 	"chg"
		    parameters 	(list Parameters
			(object Parameter "numbers"
			    attributes 	(list Attribute_Set
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ElementCreationOrder"
				    value      	"1332336730071039")
				(object Attribute
				    tool       	"MDA Generator"
				    name       	"ResolvedTypeGuid"
				    value      	"49816B2C0043"))
			    quid       	"4F69D85A0047"
			    type       	"StringList"))
		    concurrency 	"Sequential"
		    opExportControl 	"Public"
		    uid        	0))
	    language   	"MDA Generator")
	(object Class "FindAndSendMailWithSubjectDelayInExportDocCards"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1332336743146788")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0 * * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/FindAndSendMailWithSubjectDelayInExportDocCards.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D8670091_CUSTOM_IMPORT*"
		    value      	"//#UC START# *4F69D8670091_CUSTOM_IMPORT*¤import java.util.ArrayList;¤import java.util.HashMap;¤import java.util.List;¤import java.util.Map;¤¤import ru.garant.MDProcess.ConfluencePlugins.EmailNotification.EmailGateway;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.GarDocDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.Partner;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.PartnerReceiverMail;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.UVSQuestDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.PartnerManager;¤import ru.garant.MDProcess.DocCardChange.DocCardCommonImpl.CachedPartnerManager;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.DpoUvsHelper;¤import ru.garant.MDProcess.DocCardChange.Entities.UVSQuery;¤import ru.garant.MDProcess.DocCardChange.Entities.UVSQueryManager;¤import ru.garant.shared.Core.Root.NoActiveFactory;¤import ru.garant.shared.ConfluenceCore.ActionSupport.ActionContextThreadLocalFactory;¤¤import net.sf.hibernate.HibernateException;¤¤import org.apache.commons.collections.CollectionUtils;¤¤import com.atlassian.mail.Email;¤import com.atlassian.confluence.setup.bandana.ConfluenceBandanaContext;¤import com.atlassian.confluence.spaces.Space;¤import com.atlassian.gzipfilter.org.apache.commons.lang.StringUtils;¤//#UC END# *4F69D8670091_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D8670091_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *4F69D8670091_CUSTOM_CLASS_DEFINITION*¤//#UC END# *4F69D8670091_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D8670091_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *4F69D8670091_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *4F69D8670091_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*4F69D8670091_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *4F69D8670091_CUSTOM_METHODS_AND_DATA*¤	public java.util.List<String> getSpaceKeys () {¤		List<Space> spaces = ContainerManager.Factory.get().getSpaceManager().getAllSpaces();¤		return DpoUvsHelper.getSpaceKeysWhichHasGardocSettingsFromSpacesList(spaces);¤	}¤ ¤	public void processFindAndSend() {¤		for(String spaceKey : getSpaceKeys ()){¤			Logs.LOG_D ("FindAndSendMailWithSubjectDelayInExportDocCards.processFindAndSend, spaceKey = " + spaceKey);¤			¤			try{¤				List<UVSQuestDAO> uvsQuests = UVSQueryManager.Factory.get().getClosedRequestsWithoutCopyCreationDateOrNotExportedInArchi(spaceKey, getDelayTime(spaceKey));¤				Logs.LOG_D ("FindAndSendMailWithSubjectDelayInExportDocCards.processFindAndSend, uvsQuests.size = " + uvsQuests.size());¤				filtrateRegionQuery(uvsQuests);¤				Logs.LOG_D ("FindAndSendMailWithSubjectDelayInExportDocCards.processFindAndSend, after filtrateRegionQuery uvsQuests.size = " + uvsQuests.size());¤				filtrateLabelGardocNoExport(uvsQuests);¤				Logs.LOG_D ("FindAndSendMailWithSubjectDelayInExportDocCards.processFindAndSend, after filtrateLabelGardocNoExport uvsQuests.size = " + uvsQuests.size());¤				¤				¤				Map<String, List<UVSQuestDAO>> warningRecieversToDelayedUVSQuery = new HashMap<String, List<UVSQuestDAO>>();¤				for(UVSQuestDAO uvsQuest : uvsQuests) {¤					GarDocDAO gardoc= uvsQuest.getGardoc();¤					Partner partner = new CachedPartnerManager(PartnerManager.Factory.get()).getPartnerForGarDoc(gardoc.getId(), gardoc.getBlocks(), gardoc.getAdditionalDocIssuers());¤		¤					if (partner.getIsExportToArchi() && StringUtils.isNotEmpty(partner.getArchiWarningReceivers())) {¤						List<UVSQuestDAO> lst = warningRecieversToDelayedUVSQuery.get(partner.getArchiWarningReceivers());¤						if (lst == null) {¤							lst = new ArrayList<UVSQuestDAO>();¤							warningRecieversToDelayedUVSQuery.put(partner.getArchiWarningReceivers(), lst);¤						}¤						lst.add(uvsQuest);				¤					}else if (CollectionUtils.isNotEmpty(partner.getReceivers())) {¤						for (PartnerReceiverMail prm : partner.getReceivers()) {¤							if (StringUtils.isNotEmpty(prm.getReceivers()) && checkReceiver (uvsQuest, prm, partner)) {¤								List<UVSQuestDAO> lst = warningRecieversToDelayedUVSQuery.get(prm.getReceivers());¤								if (lst == null) {¤									lst = new ArrayList<UVSQuestDAO>();¤									warningRecieversToDelayedUVSQuery.put(prm.getReceivers(), lst);¤								}¤								lst.add(uvsQuest);							¤							}¤						}¤					}¤					¤				}¤				¤				if(warningRecieversToDelayedUVSQuery.size() > 0){¤					for(String emails : warningRecieversToDelayedUVSQuery.keySet()){¤						String subj = "Çàäåðæêà â ýêñïîðòå êàðòî÷åê";¤						String body = getMessageBody(warningRecieversToDelayedUVSQuery.get(emails), emails);¤		¤						EmailGateway eg = EmailGateway.Factory.create();¤						Email emailForSend = eg.createEmail (subj, body, emails);¤						eg.queueEmail (emailForSend);¤						eg.send ();¤					}¤				}¤			} catch (NoActiveFactory e) {¤				Logs.LOG_SEX(e);¤			} catch (HibernateException e) {¤				Logs.LOG_SEX(e);¤¤			}¤¤		}¤	}¤	¤	private long getDelayTime(final String spaceKey){¤		ConfluenceBandanaContext cbc = new ConfluenceBandanaContext(spaceKey);¤		Object val = ru.garant.shared.ConfluenceCore.Helpers.ContainerManager.Factory.get().getBandanaManager().getValue(cbc, "FindAndSendMailWithSubjectDelayInExportDocCards.DelayTime");¤		return(val == null)?0:(Long)val;¤	}¤	¤	public boolean checkReceiver(UVSQuestDAO uvsQuest, PartnerReceiverMail receiver, Partner partner){¤		return DpoUvsHelper.isSendMail(receiver, partner, uvsQuest.getGardoc());¤	}¤	¤	public String getMessageBody(List<UVSQuestDAO> uvsQuests, String receivers){¤		String body = null;¤		for(UVSQuestDAO uvsQuest : uvsQuests){¤			Logs.LOG_D ("FindAndSendMailWithSubjectDelayInExportDocCards.processFindAndSend, uvsQuest.contentid = " + uvsQuest.getId());¤			UVSQuery uvsQuery = UVSQuery.Factory.get(uvsQuest.getId());¤			if(body == null){¤				body = "";¤			}¤			String pageAddress = ru.garant.MDProcess.ConfluencePlugins.CommonVelocityContext.GlobalHelper.getPageUrl(uvsQuery.getPage());¤			body += "" + "<a href=\"" + pageAddress + "\">" + uvsQuery.getDocCard().getTopic() + " (" + uvsQuery.getPage().getTitle() + ")" + "</a><br/>";¤			¤		}¤		String messageBody = "Çäðàâñòâóéòå! <br/> " ¤				+ "Ñëåäóþùèå òîïèêè íå áûëè ýêñïîðòèðîâàíû â Àð÷è óæå äîñòàòî÷íî äàâíî (" + uvsQuests.size() + "):<br/>" ¤				+ body¤				+ "<br/>";¤¤		return messageBody;¤	}¤	¤	public void filtrateRegionQuery(List<UVSQuestDAO> uvsQuests){¤		List<UVSQuestDAO> regionQuests = new ArrayList<UVSQuestDAO>();¤		for(UVSQuestDAO uvsQuest : uvsQuests){¤			if(uvsQuest.getPage().getLabels().contains(DpoUvsHelper.getRegionQueryLabel())){¤				regionQuests.add(uvsQuest);¤			}¤		}¤		uvsQuests.removeAll(regionQuests);¤	}¤¤	public void filtrateLabelGardocNoExport(List<UVSQuestDAO> uvsQuests){¤		List<UVSQuestDAO> regionQuests = new ArrayList<UVSQuestDAO>();¤		for(UVSQuestDAO uvsQuest : uvsQuests){¤			if(uvsQuest.getPage().getLabels().contains(DpoUvsHelper.getGardocNoExportLabel())){¤				regionQuests.add(uvsQuest);¤			}¤		}¤		uvsQuests.removeAll(regionQuests);¤	}¤¤	@Override¤	protected void executeJob() {¤		processFindAndSend();¤	}¤	¤	protected boolean isNeedWriteTransaction() {¤		return true;¤	}¤	¤	public long getPartnerId(){¤		return 0;¤	}¤¤	public final long MOSCOW_ID = 1;¤	public final long TOMBOV_ID = 2;¤	public final long CHEBOKSARI_ID = 3;¤	//#UC END# *4F69D8670091_CUSTOM_METHODS_AND_DATA*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport/FindAndSendMailWithSubjectDelayInExportDocCards|4F69D8670091
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki"))
	    quid       	"4F69D8670091"
	    documentation 	"Äæîá, êîòîðûé çàïóñêàåòñÿ ðàç â ÷àñ, êîòîðûé âûáèðàåò èç áàçû âñå çàïðîñû? êîòîðûå âñå çàêðûòûå, ó êîòîðûõ èëè íóëë äàòà ñîçäàíèÿ èëè óæå áîëåå 30 ìèíóò íå áûë ýêñïîðòèðîâàí â àð÷è è ïîñûëàåò ïèñüìî î Çàäåðæêå â ýêñïîðòå êàðòî÷åê"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1337600379355241"))
		    quid       	"4FBA297B0163"
		    supplier   	"Logical View::MDProcess::DocCardChange::DocCardSupport::GarDocAbstractJob"
		    quidu      	"53E4BF9000E2"))
	    language   	"MDA Generator"
	    parameters 	(list Parameters
		(object Parameter "T"
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1355827877525583"))
		    quid       	"50D04AA501FE")))
	(object Class "RequestCreatorAsyncJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1368621833955161")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0/5 * * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/RequestCreatorAsyncJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5193830903BB_CUSTOM_IMPORT*"
		    value      	"//#UC START# *5193830903BB_CUSTOM_IMPORT*¤//#UC END# *5193830903BB_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5193830903BB_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *5193830903BB_CUSTOM_CLASS_DEFINITION*¤import ru.garant.MDProcess.DocCardMailing.Mailing.Elem;¤import ru.garant.MDProcess.DocCardMailing.FromToEmailDAO;¤import ru.garant.MDProcess.DocCardMailing.Mailing.MailingQueue;¤¤import org.apache.commons.collections.CollectionUtils;¤import com.atlassian.confluence.setup.bandana.ConfluenceBandanaContext;¤//#UC END# *5193830903BB_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5193830903BB_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *5193830903BB_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤		Logs.LOG_W("RequestCreatorAsyncJob::executeJob::start");¤		ConfluenceBandanaContext context = new ConfluenceBandanaContext("DPOUVS");¤		Long countCreatedDocCardsLong = (Long) ContainerManager.Factory.get ().getBandanaManager ().getValue (context, "RequestCreatorAsyncJob.countCreatedDocCards");¤		if(countCreatedDocCardsLong == null){¤			countCreatedDocCardsLong = 300l;¤		}¤		¤		Integer countCreatedDocCards = Integer.parseInt(countCreatedDocCardsLong.toString());¤		¤		Logs.LOG_W("RequestCreatorAsyncJob::executeJob::count=" + MailingQueue.Factory.get().getCount());¤¤		StringBuilder log = new StringBuilder();¤		log.append("ÎÒËÎÆÅÍÍÀß ÎÁÐÀÁÎÒÊÀ (îñòàëîñü ").append(MailingQueue.Factory.get().getCount()).append("):\n");¤		¤		Elem e = MailingQueue.Factory.get().poll(countCreatedDocCards);¤		if(e != null && CollectionUtils.isNotEmpty(e.getResult())){¤			MailingJob.makeRequests(¤					e.getResult()¤					, log¤					, FromToEmailDAO.get(e.getFromToEmailDAOId())¤					, e.getLogKey()¤					, e.getSpaceKey()¤			);¤		}¤		¤		Logs.LOG_W("RequestCreatorAsyncJob::executeJob::end");¤	}¤¤	@Override¤	protected boolean isNeedWriteTransaction() {¤		return true;¤	}¤	//#UC END# *5193830903BB_CUSTOM_METHODS_AND_DATA*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5193830903BB_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *5193830903BB_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *5193830903BB_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardMailing/MailingSupport/RequestCreatorAsyncJob|5193830903BB
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki"))
	    quid       	"5193830903BB"
	    documentation 	"îòëîæåííàÿ îáðàáîòêà êàðòî÷åê"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1368689576879835"))
		    quid       	"51948BA8036D"
		    supplier   	"Logical View::MDProcess::DocCardChange::DocCardSupport::GarDocAbstractJob"
		    quidu      	"53E4BF9000E2"))
	    language   	"MDA Generator")
	(object Class "AbstractWorkWithZakonGosDumaJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1432114785047048")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"abstract")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardChange/DocCardSupport/AbstractWorkWithZakonGosDumaJob|555C5661002E
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/AbstractWorkWithZakonGosDumaJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555C5661002E_CUSTOM_IMPORT*"
		    value      	"//#UC START# *555C5661002E_CUSTOM_IMPORT*¤import java.io.*;¤import java.net.*;¤import java.util.*;¤import java.util.regex.*;¤¤import org.apache.commons.io.IOUtils;¤¤import com.atlassian.confluence.labels.Label;¤import com.atlassian.confluence.pages.AbstractPage;¤import com.atlassian.gzipfilter.org.apache.commons.lang.StringUtils;¤¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.SiteCopyDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.RssParser.*;¤import ru.garant.MDProcess.DocCardChange.Entities.DocCard;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.ReplaceGosDumaSiteLinkOnIPWrapper;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.RssParser;¤¤import ru.garant.MDProcess.DocCardMailing.Mailing.*;¤//#UC END# *555C5661002E_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555C5661002E_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *555C5661002E_CUSTOM_CLASS_DEFINITION*¤//#UC END# *555C5661002E_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555C5661002E_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *555C5661002E_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *555C5661002E_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555C5661002E_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *555C5661002E_CUSTOM_METHODS_AND_DATA*¤	public List<Item> getRssFeedItems(Map<String, String> params){¤		String urlString = "http://api.duma.gov.ru/api/search.rss";¤		RssParser rp = new RssParser(urlString, params, "duma");¤		rp.parse(); ¤		RssFeed feed = rp.getFeed();¤		return feed.getItems();¤	}¤	¤	¤	public List <DocCardContent> getAttributes(Map<String, String> params){¤		List <DocCardContent> docAttributes = new ArrayList <DocCardContent>();¤		int i = 1;¤		List<Item> items = getRssFeedItems(params);¤		if(items != null){¤			for(Item item : items){¤				String issuer = "Ãîñóäàðñòâåííàÿ Äóìà Ôåäåðàëüíîãî Ñîáðàíèÿ";¤				String type = "ÏÐÎÅÊÒ ÇÀÊÎÍÀ";¤¤				try{¤					String number = null;¤					Date creationDate = null;¤	¤					Pattern pattern = Pattern.compile(".*\\<b\\>Íîìåð\\:\\<\\/b\\> ([^\\<br\\/\\>]*)\\<br\\/\\>\\n\\<b\\>Äàòà âíåñåíèÿ â ÃÄ:\\<\\/b\\> (\\d{1,2}) (ÿíâàðÿ|ôåâðàëÿ|ìàðòà|àïðåëÿ|ìàÿ|èþíÿ|èþëÿ|àâãóñòà|ñåíòÿáðÿ|îêòÿáðÿ|íîÿáðÿ|äåêàáðÿ) (\\d{4}) ãîäà\\<br\\/\\>.*");¤					Matcher m = pattern.matcher(item.description);¤					if (m.find()) {¤						number = (String)m.group(1);¤						String day = (String)m.group(2);¤						String month = (String)m.group(3);¤						String year = (String)m.group(4);¤						creationDate = parseDate(day, month, year);¤						¤						DocCardContent content = new DocCardContent();¤						content.setNumber(number);¤						content.setCreationDate(creationDate);¤						content.setIssuer(issuer);¤						content.setType(type);¤						content.setTitle(item.title);¤						String link = replaceLinkOnIP(item.link);¤						content.setLink(link);¤						docAttributes.add(content);¤¤						Logs.LOG_W(i + ". number=" + number + " creationDate=" + creationDate + " title=" + item.title + " link=" + link);¤						//System.out.println(i + ". number=" + number + " creationDate=" + creationDate + " link=" + item.link);¤						i++;¤					}else{¤						Logs.LOG_W("AbstractWorkWithZakonGosDumaJob::getAttributes::Not find rules to parse description=" + item.description);¤					}¤				}catch(Exception ex){¤					Logs.LOG_SEX(ex);¤				}¤			}¤		}¤		return docAttributes;¤	}¤	¤	public String replaceLinkOnIP(final String link){¤		return ReplaceGosDumaSiteLinkOnIPWrapper.replace(link);¤	}¤	¤	public Date parseDate(String day, String month, String year){¤		Calendar cal = Calendar.getInstance();¤		cal.set(Calendar.HOUR, 0);¤		cal.set(Calendar.MINUTE, 0);¤		cal.set(Calendar.SECOND, 0);¤		cal.set(Calendar.DAY_OF_MONTH, Integer.parseInt(day));¤		int monthIndex = Calendar.JANUARY; ¤		if(month.equals("ôåâðàëÿ")){¤			monthIndex = Calendar.FEBRUARY;¤		}else if(month.equals("ìàðòà")){¤			monthIndex = Calendar.MARCH;¤		}else if(month.equals("àïðåëÿ")){¤			monthIndex = Calendar.APRIL;¤		}else if(month.equals("ìàÿ")){¤			monthIndex = Calendar.MAY;¤		}else if(month.equals("èþíÿ")){¤			monthIndex = Calendar.JUNE;¤		}else if(month.equals("èþëÿ")){¤			monthIndex = Calendar.JULY;¤		}else if(month.equals("àâãóñòà")){¤			monthIndex = Calendar.AUGUST;¤		}else if(month.equals("ñåíòÿáðÿ")){¤			monthIndex = Calendar.SEPTEMBER;¤		}else if(month.equals("îêòÿáðÿ")){¤			monthIndex = Calendar.OCTOBER;¤		}else if(month.equals("íîÿáðÿ")){¤			monthIndex = Calendar.NOVEMBER;¤		}else if(month.equals("äåêàáðÿ")){¤			monthIndex = Calendar.DECEMBER;¤		}¤		cal.set(Calendar.MONTH, monthIndex);¤		cal.set(Calendar.YEAR, Integer.parseInt(year));¤		return cal.getTime();¤	}¤	¤	public URLConnection getConnection(final String link) throws Exception{¤		return super.getConnection(replaceLinkOnIP(link));¤	}¤¤	public InputStream getInputStream(final String link) throws Exception{¤		URLConnection connection = getConnection(link);¤ 	    InputStream is = connection.getInputStream ();¤ 	    ByteArrayOutputStream baos = new ByteArrayOutputStream();¤ 	    IOUtils.copy(is, baos);¤ 	    is.close();¤	    return new ByteArrayInputStream(baos.toByteArray());¤	}¤¤	public DocCardContent createDocCardContent(final Map<String, String> hrefs, DocCard dc){¤		DocCardContent dcc = new DocCardContent();¤		dcc.setNumber(dc.getNumber());¤		dcc.setCreationDate(dc.getCreationDate());¤		AbstractPage issuer = ContainerManager.Factory.get().getPageManager().getPage(dc.getDocIssuer());¤		dcc.setIssuer(issuer.getTitle());¤		dcc.setType(dc.getType());¤		dcc.setTitle(dc.getName());¤		dcc.setCopyType(new SiteCopyDAO().getType());¤		Map<String, String> hrefFiles = new HashMap<String, String>();¤¤		for(String key : hrefs.keySet()){¤			hrefFiles.put(key, hrefs.get(key));¤		}¤		dcc.setFiles(getDocFiles(hrefFiles));¤		¤		return dcc;¤	}¤	¤	public String getURLPath(URLConnection connection){¤		return connection.getURL().getPath();¤	}¤	¤	public List<DocCardFile> getDocFiles(Map<String, String> hrefFiles){¤		List<DocCardFile> docFiles = new ArrayList<DocCardFile>();¤		InputStream is = null;¤		for(String hrefFileName : hrefFiles.keySet()){¤			try {¤				String urlPath = hrefFiles.get(hrefFileName);¤				URLConnection connection = getConnection(urlPath);¤		 	    is = connection.getInputStream ();¤				String path = getURLPath(connection);¤				int lastindex = path.lastIndexOf(".");¤				String fileType = (lastindex > 0)?path.substring(lastindex):"";¤		    	DocCardFile dcFile = DocCardFile.Factory.make();¤		    	int lastIndexPointhrefFileName = hrefFileName.lastIndexOf(".");¤		    	if(lastIndexPointhrefFileName <= 0 || hrefFileName.substring(lastIndexPointhrefFileName).equals(fileType) == false){¤		    		hrefFileName += fileType;¤		    	}¤		    	dcFile.setFileName(hrefFileName);¤		    	dcFile.setFileComment(urlPath);¤		    	FileContent fc = FileContent.Factory.make();¤		    	fc.setBinaryStream(is);¤		    	dcFile.setFileContent(fc);¤		    	docFiles.add(dcFile);¤			} catch (Exception ex) {¤				Logs.LOG_SEX(ex);¤			}finally{¤				if(is != null){¤				    try {¤						is.close();¤					} catch (IOException e) {¤						Logs.LOG_SEX(e);¤					}¤				}¤			}¤¤		}¤		return docFiles;¤	}¤	¤	public Label getLabelGardocDumaGovRu(){¤		return ContainerManager.Factory.get().getLabelManager().getLabel(LABEL_NAME_GARDOC_DUMA_GOV_RU);¤	}¤	¤	public final static String LABEL_NAME_GARDOC_DUMA_GOV_RU = "gardoc_duma_gov_ru";¤	//#UC END# *555C5661002E_CUSTOM_METHODS_AND_DATA*
		    )))
	    quid       	"555C5661002E"
	    documentation 	"ðàáîòà ñ äîêóìåíòàìè ñ ìåòêîé gardoc_duma_gov_ru è api.duma.gov.ru"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1432114859943333"))
		    quid       	"555C56AB03AE"
		    supplier   	"Logical View::MDProcess::DocCardMailing::MailingSupport::AbstractWorkWithSiteJob"
		    quidu      	"558BE332035F"))
	    language   	"MDA Generator"
	    abstract   	TRUE)
	(object Class "RemoveLabelGardocDumaGrovRuThenLawWasSigned"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1432035385884653")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0 6 * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/RemoveLabelGardocDumaGrovRuThenLawWasSigned.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardChange/DocCardSupport/RemoveLabelGardocDumaGrovRuThenLawWasSigned|555B20390374
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555B20390374_CUSTOM_IMPORT*"
		    value      	"//#UC START# *555B20390374_CUSTOM_IMPORT*¤import java.text.SimpleDateFormat;¤import java.util.*;¤¤import com.atlassian.confluence.labels.Label;¤import com.atlassian.confluence.user.AuthenticatedUserThreadLocal;¤¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.DocTypeDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.GarDocDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.OGVLinksDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.CurrentDocFinderManager;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.DoInNewTransactionCallback;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.OGVLinksManager;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.TransactionDecorator;¤import ru.garant.MDProcess.DocCardMailing.Mailing.DocCardContent;¤//#UC END# *555B20390374_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555B20390374_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *555B20390374_CUSTOM_CLASS_DEFINITION*¤//#UC END# *555B20390374_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555B20390374_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *555B20390374_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *555B20390374_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*555B20390374_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *555B20390374_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤		Logs.LOG_D ("RemoveLabelGardocDumaGrovRuThenLawWasSigned::start");¤		try {¤			AuthenticatedUserThreadLocal.setUser(ContainerManager.Factory.get().getUserAccessor().getUser("robot"));¤			Map<String, String> params = new HashMap<String, String>();¤			Calendar cal = Calendar.getInstance();¤			cal.setTime(new Date());¤			cal.set(Calendar.DAY_OF_MONTH, cal.get(Calendar.DAY_OF_MONTH) - 1);¤			String date = new SimpleDateFormat("dd.MM.yyyy").format(cal.getTime());¤			params.put("status", "6");¤			params.put("event_start", date);¤			params.put("event_end", date);¤			List <DocCardContent> docAttributes = getAttributes(params);¤			removeLabelFromDocuments(docAttributes);¤		} catch (Exception e) {¤			Logs.LOG_SEX(e);¤		}¤		Logs.LOG_D ("RemoveLabelGardocDumaGrovRuThenLawWasSigned::end");¤¤	}¤	¤	public void removeLabelFromDocuments(List <DocCardContent> docAttributes){¤		for(final DocCardContent docCardContent : docAttributes){¤			new TransactionDecorator(true).doInNewTransaction(new DoInNewTransactionCallback() {¤				public void execute() {¤					try{¤						GarDocDAO dc = getDocCard(docCardContent);¤						if(dc != null){¤							ContainerManager.Factory.get().getLabelManager().removeLabel(dc.getPage(), LABEL_NAME_GARDOC_DUMA_GOV_RU);¤¤							ContainerManager.Factory.get().getSession().flush();¤						}¤					}catch(Exception e){¤						Logs.LOG_SEX(e);¤					}¤				}¤			});¤		}¤	}¤¤	public GarDocDAO getDocCard(final DocCardContent dc){¤		OGVLinksDAO ogv = (dc.getIssuer () != null) ? OGVLinksManager.Factory.get(getSpaceKey()).getOgvByName (dc.getIssuer().trim()): null;¤		DocTypeDAO type = OGVLinksManager.Factory.get(getSpaceKey()).getDocTypeByName(dc.getType().trim());¤		Collection<GarDocDAO> gardocList = CurrentDocFinderManager.Factory.get().getDocCardForAdd(¤				ogv.getId()¤				, dc.getNumber()¤				, dc.getCreationDate()¤				, dc.getRegistrationNumber()¤				, dc.getRegistrationDate()¤				, dc.getTitle()¤				, new ArrayList(dc.getAdditionalIssuers())¤				, new ArrayList(dc.getAdditionalNumbers())¤				, String.valueOf(type.getId())¤				, 0¤				, getSpaceKey()¤		);¤		if(gardocList.size() == 1){¤			return gardocList.iterator().next();¤		}else if(gardocList.size() > 1){¤			Iterator it = gardocList.iterator();¤			if(it.hasNext()){¤				do{¤					GarDocDAO doc = (GarDocDAO)it.next();¤					List<Label> labels = doc.getPage().getLabels();¤					if(labels.contains(getLabelGardocDumaGovRu())){¤						return doc;¤					}¤				}while(it.hasNext());¤			}¤		}¤		return null;¤	}¤	¤	@Override¤	protected boolean isNeedWriteTransaction() {¤		return false;¤	}¤	¤	//#UC END# *555B20390374_CUSTOM_METHODS_AND_DATA*
		    )))
	    quid       	"555B20390374"
	    documentation 	"Äæîá óäàëÿòîð ëýéáëà gardoc_duma_gov_ru, êîãäà çàêîí ïîäïèñàí"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1432114912994369"))
		    quid       	"555C56E003E0"
		    supplier   	"Logical View::MDProcess::DocCardMailing::MailingSupport::AbstractWorkWithZakonGosDumaJob"
		    quidu      	"555C5661002E"))
	    language   	"MDA Generator")
	(object Class "CreateProectZakonGosDumaDocJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1431081345625241")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0 1 * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/CreateProectZakonGosDumaDocJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardChange/DocCardSupport/CreateProectZakonGosDumaDocJob|554C91810271
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554C91810271_CUSTOM_IMPORT*"
		    value      	"//#UC START# *554C91810271_CUSTOM_IMPORT*¤import com.atlassian.mail.Email;¤¤import java.text.SimpleDateFormat;¤import java.util.*;¤¤import ru.garant.MDProcess.ConfluencePlugins.EmailNotification.EmailGateway;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.CreateUvsQuery;¤import ru.garant.MDProcess.DocCardMailing.Mailing.DocCardContent;¤import ru.garant.MDProcess.DocCardMailing.Mailing.RequestCreator;¤//#UC END# *554C91810271_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554C91810271_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *554C91810271_CUSTOM_CLASS_DEFINITION*¤//#UC END# *554C91810271_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554C91810271_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *554C91810271_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *554C91810271_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554C91810271_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *554C91810271_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤		Logs.LOG_D ("CreateProectZakonGosDumaDocJob::start");¤		try {¤			Calendar cal = Calendar.getInstance();¤			cal.setTime(new Date());¤			¤			String endDate = new SimpleDateFormat("dd.MM.yyyy").format(cal.getTime());¤¤			cal.set(Calendar.DAY_OF_MONTH, cal.get(Calendar.DAY_OF_MONTH) - 10);¤			String startDate = new SimpleDateFormat("dd.MM.yyyy").format(cal.getTime());¤			int index = 1;¤			List<DocCardContent> dclist = new ArrayList<DocCardContent>();¤			List<DocCardContent> newdcs = new ArrayList<DocCardContent>();¤			do{	¤				Map<String, String> params = new HashMap<String, String>();¤				params.put("search_mode", "3");¤				params.put("registration_start", startDate);¤				params.put("registration_end", endDate);¤				params.put("page", String.valueOf(index));¤				¤				newdcs = getAttributes(params);¤				Logs.LOG_W("CreateProectZakonGosDumaDocJob::page=" + index + " docSize=" + newdcs.size());¤				dclist.addAll(newdcs);¤				index++;¤			}while(newdcs.size() > 0);¤			¤			String log = createUvsQueries(dclist);¤			sendMail(log);			¤		} catch (Exception e) {¤			Logs.LOG_SEX(e);¤		}¤		Logs.LOG_D ("CreateProectZakonGosDumaDocJob::end");¤	}¤¤	public String createUvsQueries(List<DocCardContent> dclist){¤		StringBuilder log = new StringBuilder ();¤		RequestCreator creator = RequestCreator.Factory.make("ALWAYS_ADD_DOCCARD_NO_UVSQUERY");¤		creator.setCreateInNewTransaction(true);¤		String creatorName = "robot";¤		creator.process(dclist, new CreateUvsQuery(), log, creatorName, getSpaceKey());¤		return log.toString();¤	}¤	¤	private void sendMail(String log){¤		EmailGateway eg = EmailGateway.Factory.create();¤		Email emailForSend = eg.createEmail (¤			"Ïîëó÷åíèå äîêóìåíòîâ ÃîñÄóìû ñ ñàéòà " 	¤			, log.replace("\n", "\n<BR>")¤			, "elenau@garant.ru,ses@garant.ru"¤		);¤		¤		Logs.LOG_D("CreateProectZakonGosDumaDocJob::sendMail::log:\n" + log.toString ());¤		¤		eg.queueEmail (emailForSend);¤		¤		Logs.LOG_D ("CreateProectZakonGosDumaDocJob::sendMail: ceg.send ()");¤		eg.send ();		¤	}¤¤	@Override¤	protected boolean isNeedWriteTransaction() {¤		return false;¤	}¤	//#UC END# *554C91810271_CUSTOM_METHODS_AND_DATA*
		    )))
	    quid       	"554C91810271"
	    documentation 	"Äæîá, êîòîðûé ñîçäàåò êàðòî÷êó äëÿ äîêîâ áåç çàïðîñîâ ñ ãîñäóìû çàïóñêàåòñÿ êàæäûé äåíü â 6-÷àñîâ óòðà."
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1432114910229210"))
		    quid       	"555C56DE00E4"
		    supplier   	"Logical View::MDProcess::DocCardMailing::MailingSupport::AbstractWorkWithZakonGosDumaJob"
		    quidu      	"555C5661002E"))
	    language   	"MDA Generator")
	(object Class "AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1431093018791908")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0 3 * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"WikiPageID (wiki)"
		    value      	(value Text 
|MDProcess,key:MDP,guid:456C0DD70110/Home/Ìîäåëü ïðîåêòà "MDProcess"/DocCardChange/DocCardSupport/AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob|554CBF1A0317
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (wiki)"
		    value      	"wiki")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554CBF1A0317_CUSTOM_IMPORT*"
		    value      	"//#UC START# *554CBF1A0317_CUSTOM_IMPORT*¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.UVSQuestDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.DoInNewTransactionCallback;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.DocCardManager;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.CreateUvsQuery;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.DpoUvsHelper;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.TransactionDecorator;¤import ru.garant.MDProcess.DocCardChange.Entities.DocCard;¤¤import ru.garant.MDProcess.DocCardMailing.Mailing.*;¤¤import com.atlassian.confluence.pages.Attachment;¤import com.atlassian.confluence.user.AuthenticatedUserThreadLocal;¤import com.atlassian.gzipfilter.org.apache.commons.lang.StringUtils;¤¤import org.apache.commons.collections.CollectionUtils;¤import org.jsoup.Jsoup;¤import org.jsoup.nodes.Document;¤import org.jsoup.nodes.Element;¤import org.jsoup.select.Elements;¤¤import java.io.*;¤import java.util.*;¤//#UC END# *554CBF1A0317_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554CBF1A0317_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *554CBF1A0317_CUSTOM_CLASS_DEFINITION*¤//#UC END# *554CBF1A0317_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554CBF1A0317_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *554CBF1A0317_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *554CBF1A0317_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*554CBF1A0317_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *554CBF1A0317_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤		Logs.LOG_D ("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob::start");¤		try {¤			AuthenticatedUserThreadLocal.setUser(ContainerManager.Factory.get().getUserAccessor().getUser("robot"));¤¤			List<Long> docIds = DpoUvsHelper.getPagesIdsFromLabelAndSpaceKey(LABEL_NAME_GARDOC_DUMA_GOV_RU, getSpaceKey());¤			Logs.LOG_D ("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob::docIds.size=" + docIds.size());¤			StringBuilder sb = new StringBuilder();¤			for(final Long docId : docIds){¤				if (new Date().getHours() >= 8 && new Date().getHours() < 23) {¤					sb.append(docId).append(",");					¤				}else{¤					new TransactionDecorator(true).doInNewTransaction(new DoInNewTransactionCallback() {¤						public void execute() {¤							try{¤								String log = addUvsQueryWithAttachmentToExistDocCard(docId);¤								Logs.LOG_W(log);¤								ContainerManager.Factory.get().getSession().flush();¤							}catch(Exception e){¤								Logs.LOG_SEX(e);¤							}¤						}¤					});¤				}¤			}¤			if (StringUtils.isEmpty(sb.toString()) == false) {¤				Logs.LOG_D ("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob::stop working, ids not complete: " + sb.toString());¤			}¤			¤		} catch (Exception e) {¤			Logs.LOG_SEX(e);¤		}¤		Logs.LOG_D ("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob::end");¤	}¤	¤	public String getLink(DocCard dc){¤		String link = ContainerManager.Factory.get().getContentPropertyManager().getStringProperty(dc.getPage(), "link");¤		return link;¤	}¤	¤	public void removeExistingLinks(Map<String, String> hrefs, List<String> existUvsQueriesLinks){¤		//áåðåì âñå ññûëêè ñ ñîçäàííûõ çàïðîñîâ¤		List<String> removedKeys = new ArrayList<String>();¤		for(String key : hrefs.keySet()){¤			for(String existLink : existUvsQueriesLinks){¤				if(hrefs.get(key).equals(existLink)){¤					removedKeys.add(key);¤				}¤			}¤		}¤		for(String key : removedKeys){¤			hrefs.remove(key);¤		}¤	}¤	¤	public String addUvsQueryWithAttachmentToExistDocCard(final long docId){¤		DocCard dc = DocCard.Factory.get(docId);¤		String link = getLink(dc);¤		if(link != null){¤			//íàõîäèì ñóùåñòâóþùèå ññûëêè¤			List<String> existUvsQueriesLinks = getExistUvsQueriesLinks(docId);¤			//ñîáèðàåì âñå íóæíûå ññûëêè ñî ñòðàíèöû¤			Map<String, String> hrefs = parseLink(link, existUvsQueriesLinks);¤			//óäàëÿåì óæå ñêà÷àííûå ññûëêè¤			removeExistingLinks(hrefs, existUvsQueriesLinks);¤			if(hrefs.size() > 0){				¤				DocCardContent dcc = createDocCardContent(hrefs, dc);¤				if (CollectionUtils.isNotEmpty(dcc.getFiles())) {¤					List<DocCardContent> dclist = new ArrayList<DocCardContent>();¤					dclist.add(dcc);¤					return createUvsQueries(dclist, docId);¤				} else {¤					return "Download failed for doccardid=" + dc.getPage().getId();¤				}¤			}¤			return "No docs for download doccardid=" + dc.getPage().getId();¤		}¤		return "No URL for docard with id=" + dc.getPage().getId();¤	}¤	¤	public String createUvsQueries(final List<DocCardContent> dclist, long docCardId){¤		StringBuilder log = new StringBuilder ();¤		RequestCreator creator = RequestCreator.Factory.make("ALWAYS_CREATE_QUERY_IN_EXIST_DOCCARD_FROM_DOCID_AND_CHANGE_STATE_TO_MANAGER_STATE");¤		creator.setCreateInNewTransaction(false);¤		String creatorName = "robot";¤		CreateUvsQuery cuq = new CreateUvsQuery();¤//		cuq.setDocCardId(docCardId);¤		cuq.setSelectedId(docCardId);¤		creator.process(dclist, cuq, log, creatorName, getSpaceKey());¤		return log.toString();¤	}¤¤	public List<String> getExistUvsQueriesLinks(final long docId){¤		List<String> existUvsQueriesLinks = new ArrayList<String>();¤		List<UVSQuestDAO> uvsQueries = DocCardManager.Factory.get().getUvsQueryForDocCard(docId);¤		for(UVSQuestDAO uvsQuery : uvsQueries){¤			List<Attachment> attaches = uvsQuery.getPage().getAttachments();¤			for(Attachment attach : attaches){¤				if(existUvsQueriesLinks.contains(attach.getComment()) == false){¤					existUvsQueriesLinks.add(replaceLinkOnIP(attach.getComment()));¤				}¤			}¤		}¤		return existUvsQueriesLinks;¤	}¤	¤	public Map<String, String> getZamPDFDocHrefs(final Document doc, final String siteName){¤ 		Map<String, String> zamPDFDocHrefs = new HashMap<String, String>();¤		Elements registrationZakonoproektaVSaadGosDumiEls = doc.select("#docs td:matches(çàðåãèñòðèðîâàí è íàïðàâëåí Ïðåäñåäàòåëþ ÃÄ)");¤		if(registrationZakonoproektaVSaadGosDumiEls.size() > 0){¤			Element registrationZakonoproektaVSaadGosDumiEl = registrationZakonoproektaVSaadGosDumiEls.first();¤			Element parentRegistrationZakonoproektaVSaadGosDumiEl = registrationZakonoproektaVSaadGosDumiEl.parent().parent();¤			for(String block2Row : BLOCK_2_ROWS){¤				Elements hrefElements = parentRegistrationZakonoproektaVSaadGosDumiEl.select("a:contains(" + block2Row + ")");¤				zamPDFDocHrefs.putAll(getHrefsWithText(hrefElements, siteName));¤			}¤		}¤		return zamPDFDocHrefs;¤	}¤	¤	public Map<String, String> parseLink(final String link, final List<String> existUvsQueriesLinks){¤		Map<String, String> hrefs = new HashMap<String, String>();¤		InputStream is = null;¤		try {¤			String[] path = link.split("/");¤			String siteName = replaceLinkOnIP(path[0] + "/" + path[1] + "/" + path[2]);¤			¤			String resLink = replaceLinkOnIP(link);¤			¤			is = getInputStream(resLink);¤	    	¤	    	BufferedReader htmlPage = new BufferedReader(new InputStreamReader(is)) ;¤	    	¤    		String line = "";¤			StringBuilder strB = new StringBuilder();¤			while ((line = htmlPage.readLine ()) != null) {¤				strB.append(line);¤			}¤			¤			Document doc = Jsoup.parse(strB.toString());¤			¤//block1 Ïàêåò äîêóìåíòîâ ïðè âíåñåíèè, áåðåì òîëüêî ïåðâûé, îñòàëüíûå òîëüêî ññûëêè íà äðóãèå ñòðàíèöû¤			Elements mainPDFDocEls = doc.getElementsByAttributeValue("class", "dark");¤			String newPasportPDFDocKey = null;¤			String existPasportPDFDocHref = null; ¤			¤			if(mainPDFDocEls.size() > 0){¤				Element el = mainPDFDocEls.first();¤				newPasportPDFDocKey = el.text();¤				existPasportPDFDocHref = replaceLinkOnIP(el.attr("href"));¤//				hrefs.put(el.text(), el.attr("href"));¤				Logs.LOG_W("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob:docName=" + el.text());¤			}¤//block2	Âíåñåíèå çàêîíîïðîåêòà â Ãîñóäàðñòâåííóþ Äóìó > Ðåãèñòðàöèÿ çàêîíîïðîåêòà è ìàòåðèàëîâ ê íåìó â ÑÀÄÄ Ãîñóäàðñòâåííîé Äóìû > çàðåãèñòðèðîâàí è íàïðàâëåí Ïðåäñåäàòåëþ ÃÄ¤			Map<String, String> zamPDFDocHrefs = getZamPDFDocHrefs(doc, siteName);¤			¤			boolean hasExistZamPDFDocHrefs = false;¤			if(zamPDFDocHrefs.size() > 0){¤				for(String key : zamPDFDocHrefs.keySet()){¤					if(existUvsQueriesLinks.contains(zamPDFDocHrefs.get(key))){¤						hasExistZamPDFDocHrefs = true;¤					}¤				}¤			}¤			//åñëè íåò PDF íè â ñóùåñòâóþùèõ íèì â ïëàíèðóåìûõ, òî äîáàâèòü äîêóìåíòû èç áëîêà Âíåñåíèå çàêîíîïðîåêòà â Ãîñóäàðñòâåííóþ Äóìó > Ðåãèñòðàöèÿ çàêîíîïðîåêòà è ìàòåðèàëîâ ê íåìó â ÑÀÄÄ Ãîñóäàðñòâåííîé Äóìû > çàðåãèñòðèðîâàí è íàïðàâëåí Ïðåäñåäàòåëþ ÃÄ¤			if(newPasportPDFDocKey == null && existUvsQueriesLinks.contains(existPasportPDFDocHref) == false){¤				//åñëè ïîÿâèëèñü äîêóìåíòû â áëîêå¤				if(zamPDFDocHrefs.size() > 0 && hasExistZamPDFDocHrefs == false){¤					hrefs.putAll(zamPDFDocHrefs);¤				}¤			//åñëè ïîÿâèëñÿ pdf-ôàéë, à åãî ðàíüøå íå áûëî	¤			}else if(newPasportPDFDocKey != null && existUvsQueriesLinks.contains(existPasportPDFDocHref) == false){¤				//åñëè íåò ñóùåñòâóþùèõ äîêóìåíòîâ èç áëîêà¤				if(hasExistZamPDFDocHrefs == false){¤					hrefs.put(newPasportPDFDocKey, existPasportPDFDocHref);¤				}¤			}¤			¤¤//block3 Çàêëþ÷åíèå, Îôèöèàëüíûé îòçûâ Ïðàâèòåëüñòâà, Ïîñòàíîâëåíèå êîëëåãèàëüíîãî îðãàíà ¤			Elements mainDivEls = doc.getElementsByAttributeValue("id", "docs");¤			if(mainDivEls.size() > 0){¤				Elements block3AEls = mainDivEls.get(0).getElementsByTag("a");¤				hrefs.putAll(getHrefsWithText(block3AEls, siteName, BLOCK3_ROWS));¤			}¤¤//block4	Ðàññìîòðåíèå çàêîíîïðîåêòà âî âòîðîì è â òðåòüåì ÷òåíèè		¤			Elements elems = doc.select("#docs a:matches(Ðàññìîòðåíèå çàêîíîïðîåêòà âî âòîðîì ÷òåíèè|Ðàññìîòðåíèå çàêîíîïðîåêòà â òðåòüåì ÷òåíèè)");¤			¤			if(elems.size() > 0){¤				Elements elems2 = elems.parents();¤				for(Element elem : elems2){¤					Element elemNextSibling = elem.nextElementSibling();¤					if(elemNextSibling != null){¤						Elements elemsSignZakonOrZakonoproekt = elemNextSibling.select("td:matches(^ïðèíÿòü çàêîíîïðîåêò.+|^ïðèíÿòü çàêîí.+)");¤						if(elemsSignZakonOrZakonoproekt.size() > 0){¤							for(Element el : elemsSignZakonOrZakonoproekt){¤								Element parentEl = el.parent().parent();¤								for(String block4Row : BLOCK_4_ROWS){¤									Elements hrefElements = parentEl.select("a:contains(" + block4Row + ")");¤									hrefs.putAll(getHrefsWithText(hrefElements, siteName));¤								}¤							}¤						}¤					}¤				}¤			}¤			¤//block5 ðåäàêöèè¤			Elements elemsVGosDumu = doc.select("#docs a:matches(Âíåñåíèå çàêîíîïðîåêòà â Ãîñóäàðñòâåííóþ Äóìó)");¤			¤			if(elemsVGosDumu.size() > 0){¤				Element parentelemVGosDumu = elemsVGosDumu.first().parent().parent();¤				Elements elemsSignNewRedactrion = parentelemVGosDumu.select("td:matches(^çàðåãèñòðèðîâàíà íîâàÿ ðåäàêöèÿ.+)");¤				if(elemsSignNewRedactrion.size() > 0){¤					for(Element el : elemsSignNewRedactrion ){¤						Element parent = el.parent().nextElementSibling();¤						if(parent != null){¤							do{¤								for(String block4Row : BLOCK_4_ROWS){¤									Elements hrefElements = parent.select("a:contains(" + block4Row + ")");¤									hrefs.putAll(getHrefsWithText(hrefElements, siteName));¤								}¤								parent = parent.nextElementSibling();¤							}while(parent != null && parent.select("a").size() > 0);¤						}¤					}¤					¤				}¤			}¤//block7 íîâàÿ ðåäàêöèÿ â ïåðâîì ÷òåíèè¤			Elements elemsNewRedactionInFirstChtenie = doc.select("#docs a:matches(Ðàññìîòðåíèå çàêîíîïðîåêòà â ïåðâîì ÷òåíèè)");¤			¤			if(elemsNewRedactionInFirstChtenie.size() > 0){¤				Element parentelemNewRedactionInFirstChtenie = elemsNewRedactionInFirstChtenie.first().parent().nextElementSibling();¤				if(parentelemNewRedactionInFirstChtenie != null){¤					for(String block7Row : BLOCK_7_ROWS){¤						Elements hrefElements = parentelemNewRedactionInFirstChtenie.select("a:matches(^" + block7Row + ".+\\(íîâàÿ ðåäàêöèÿ\\))");¤						hrefs.putAll(getHrefsWithText(hrefElements, siteName));¤					}¤				}¤			}¤			¤		} catch (Exception ex) {¤			Logs.LOG_SEX(ex);¤		}finally{¤			if(is != null){¤			    try {¤					is.close();¤				} catch (IOException e) {¤					Logs.LOG_SEX(e);¤				}¤			}		¤		}¤		return hrefs;¤	}¤	¤	public Map<String, String> getHrefsWithText(Elements aEls, final String siteName, final String[] block_rows){¤		Map<String, String> hrefs = new HashMap<String, String>();¤		if(aEls.size() > 0){¤			for(Element aEl : aEls){¤				for(String block2Row : block_rows){¤					String docName = aEl.text();¤					if(docName.contains(block2Row)){¤						if(hrefs.get(docName) == null){¤							hrefs.put(docName, siteName + aEl.attr("href"));¤							Logs.LOG_W("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob:getHrefsWithText:docName=" + docName);¤						}else{¤							int i = 1;¤							while(hrefs.get(docName + "-" + i) != null){¤								i++;¤							}¤							hrefs.put(docName + "-" + i, siteName + aEl.attr("href"));¤							Logs.LOG_W("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob:getHrefsWithText:docName=" + docName + "-" + String.valueOf(i));¤						}¤					}¤				}¤			}¤		}¤		return hrefs;¤	}¤	¤	public Map<String, String> getHrefsWithText(Elements aEls, final String siteName){¤		Map<String, String> hrefs = new HashMap<String, String>();¤		if(aEls.size() > 0){¤			for(Element aEl : aEls){¤				String docName = aEl.text();¤				if(hrefs.get(docName) == null){¤					hrefs.put(docName, siteName + aEl.attr("href"));¤					Logs.LOG_W("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob:getHrefsWithText:docName=" + docName);¤				}else{¤					int i = 1;¤					while(hrefs.get(docName + "-" + i) != null){¤						i++;¤					}¤					hrefs.put(docName + "-" + i, siteName + aEl.attr("href"));¤					Logs.LOG_W("AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob:getHrefsWithText:docName=" + docName + "-" + String.valueOf(i));¤				}¤			}¤		}¤		return hrefs;¤	}¤	¤	@Override¤	protected boolean isNeedWriteTransaction() {¤		return false;¤	}¤¤	private final String[] BLOCK_7_ROWS = {¤			"Òåêñò", ¤			"Ïåðå÷åíü",¤			"Ïîÿñíèòåëüíàÿ çàïèñêà", ¤			"Ôèíàíñîâî-ýêîíîìè÷åñêîå îáîñíîâàíèå"¤		};¤¤	private final String[] BLOCK_2_ROWS = {¤			"Òåêñò âíåñåííîãî çàêîíîïðîåêòà", ¤			"Ïåðå÷åíü àêòîâ ôåäåðàëüíîãî çàêîíîäàòåëüñòâà",¤			"Ïåðå÷åíü àêòîâôåäåðàëüíîãî çàêîíîäàòåëüñòâà", ¤			"Ïîÿñíèòåëüíàÿ çàïèñêà ê çàêîíîïðîåêòó", ¤			"Ôèíàíñîâî-ýêîíîìè÷åñêîå îáîñíîâàíèå"¤		};¤¤	private final String[] BLOCK_4_ROWS = {¤											"Òåêñò âíåñåííîãî çàêîíîïðîåêòà", ¤											"Òåêñò çàêîíîïðîåêòà", ¤											"Ïåðå÷åíü àêòîâ ôåäåðàëüíîãî çàêîíîäàòåëüñòâà",¤											"Ïåðå÷åíü àêòîâôåäåðàëüíîãî çàêîíîäàòåëüñòâà", ¤											"Ïîÿñíèòåëüíàÿ çàïèñêà ê çàêîíîïðîåêòó", ¤											"Ôèíàíñîâî-ýêîíîìè÷åñêîå îáîñíîâàíèå"¤										};¤										 ¤	private final String[] BLOCK3_ROWS = {¤											"Çàêëþ÷åíèå", ¤											"Îôèöèàëüíûé îòçûâ Ïðàâèòåëüñòâà", ¤											"Ïîñòàíîâëåíèå êîëëåãèàëüíîãî îðãàíà",¤											"Èíîé äîêóìåíò"¤										};¤	//#UC END# *554CBF1A0317_CUSTOM_METHODS_AND_DATA*
		    )))
	    quid       	"554CBF1A0317"
	    documentation 	"Äæîá, êîòîðûé äîêà÷èâàåò äîêóìåíòû ñ ãîñäóìû äëÿ êàðòî÷åê ñ ìåòêîé gardoc_duma_gov_ru"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1432114915841533"))
		    quid       	"555C56E30347"
		    supplier   	"Logical View::MDProcess::DocCardMailing::MailingSupport::AbstractWorkWithZakonGosDumaJob"
		    quidu      	"555C5661002E"))
	    language   	"MDA Generator")
	(object Class "CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1434026352681065")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0/10 * * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5579817002A9_CUSTOM_IMPORT*"
		    value      	"//#UC START# *5579817002A9_CUSTOM_IMPORT*¤import java.io.*;¤import java.net.*;¤import java.text.SimpleDateFormat;¤import java.util.*;¤import java.util.Map.Entry;¤import java.util.regex.*;¤¤import org.apache.commons.csv.CSVFormat;¤import org.apache.commons.csv.CSVPrinter;¤import org.apache.commons.lang.StringUtils;¤import org.jsoup.Jsoup;¤import org.jsoup.nodes.Document;¤import org.jsoup.nodes.Element;¤import org.jsoup.select.Elements;¤¤import net.sf.hibernate.HibernateException;¤¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.GarDocDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.OGVLinksDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardChangeDAO.SiteCopyDAO;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.DoInNewTransactionCallback;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.DocCardManager;¤import ru.garant.MDProcess.DocCardChange.DocCardCommon.OGVLinksManager;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.DpoUvsHelper;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.RssParser;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.RssParser.Item;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.RssParser.RssFeed;¤import ru.garant.MDProcess.DocCardChange.DocCardSupport.TransactionDecorator;¤import ru.garant.MDProcess.DocCardMailing.Mailing.*;¤¤import com.atlassian.confluence.pages.Page;¤¤import com.google.gson.JsonArray;¤import com.google.gson.JsonElement;¤import com.google.gson.JsonObject;¤import com.google.gson.JsonParser;¤¤import net.sf.hibernate.Query;¤import net.sf.hibernate.Session;¤//#UC END# *5579817002A9_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5579817002A9_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *5579817002A9_CUSTOM_CLASS_DEFINITION*¤//#UC END# *5579817002A9_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5579817002A9_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *5579817002A9_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *5579817002A9_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*5579817002A9_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *5579817002A9_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤		Logs.LOG_D ("CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob::start");¤		Date currentDate = new Date();¤/*		Date currentDate = null;¤		try {¤			currentDate = new SimpleDateFormat("dd.MM.yyyy").parse("02.07.2015");¤		} catch (ParseException e) {¤			Logs.LOG_SEX(e);¤		}¤		*/¤		List<DocCardContent> docs = findRSSDocs(currentDate, getSpaceKey());¤		createMailAndExecuteMailingJob(docs, getSpaceKey());¤		Logs.LOG_D ("CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob::end");¤	}¤¤	@Override¤	protected boolean isNeedWriteTransaction() {¤		return false;¤	}¤	¤	public Map<String, String> getHrefForPDFFileAndMinustInfoString(final String link){¤		InputStream is = null;¤		String href = null;¤		Map<String, String> info = new HashMap<String, String>();¤		try {¤			URLConnection connection = getConnection(link);¤	 	    is = connection.getInputStream ();¤¤	 	    String html = readStreamToString(connection.getInputStream(), "UTF-8");		¤¤	 	    Document doc = Jsoup.parse(html.toString());¤			Element elMainContent = doc.getElementsByAttributeValue("class", "mainContent").get(0);¤			Elements hrefEls = elMainContent.getElementsByTag("a");¤			if(hrefEls.size() > 0){¤				Element pdfFile = hrefEls.get(0);¤				href = pdfFile.attr("href");¤				info.put("pdfHref", siteName + href);¤			}¤			Elements elsDocCaption = doc.getElementsByClass("doccaption");¤			if(elsDocCaption.size() > 0){¤				for(Element elDocCaption : elsDocCaption){¤					if(elDocCaption.text().startsWith("(Çàðåãèñòðèðîâàí â")){¤						info.put("doccaption", elDocCaption.text());¤					}¤					¤					¤				}¤			}¤			¤		} catch (Exception ex) {¤			Logs.LOG_SEX(ex);¤		}finally{¤			if(is != null){¤			    try {¤					is.close();¤				} catch (IOException e) {¤					Logs.LOG_SEX(e);¤				}¤			}¤		}¤		return info;¤	}¤	¤	public DocCardFile getDocFile(final String fileName, final String href){¤		DocCardFile dcFile = null;¤		InputStream is = null;¤		try {¤			URLConnection connection = getConnection(href);¤	 	    is = connection.getInputStream ();¤	    	dcFile = DocCardFile.Factory.make();¤	    	dcFile.setFileName(fileName + "." + href.substring(href.length() - 3));¤	    	dcFile.setFileComment(href);¤	    	FileContent fc = FileContent.Factory.make();¤	    	fc.setBinaryStream(is);¤	    	dcFile.setFileContent(fc);¤¤		} catch (Exception ex) {¤			Logs.LOG_SEX(ex);¤		}finally{¤			if(is != null){¤			    try {¤					is.close();¤				} catch (IOException e) {¤					Logs.LOG_SEX(e);¤				}¤			}¤		}¤		return dcFile;¤	}¤	¤	public void createMailAndExecuteMailingJob(final List<DocCardContent> docs, final String spaceKey){¤		try {¤			List<DocCardContent> resdclist = removingWithExistingAttachments(docs);¤			¤			if(resdclist.size() > 0){¤				List<DocCardFile> docCardFileList = new ArrayList<DocCardFile>();¤				DocCardFile dcFile = DocCardFile.Factory.make();¤				dcFile.setFileName("PRAVO.CSV");¤				FileContent fc = FileContent.Factory.make();¤				fc.setBinaryStream(makeCSVFile(resdclist));¤				dcFile.setFileContent(fc);¤				docCardFileList.add(dcFile);¤				MailingItem mailingItemReceived = MailingItem.Factory.make("pravo.gov.ru", docCardFileList, "SITE");¤				MailingJob job = new  MailingJob();¤				job.processEmailReceived (mailingItemReceived, spaceKey);¤			}¤		} catch (Exception e) {¤			Logs.LOG_SEX (e);¤		}¤	}¤	¤	public List<DocCardContent> removingWithExistingAttachments(final List<DocCardContent> docs){¤		List<DocCardContent> resdclist = new ArrayList<DocCardContent>();¤		resdclist.addAll(docs);¤		List<DocCardContent> removedList = new ArrayList<DocCardContent>();¤		for(DocCardContent dcc : docs){¤			List<DocCardFile> dcfiles = dcc.getFiles();¤			if(dcfiles.size() > 0){¤				DocCardFile dcf = dcfiles.get(0);¤				String fileName = dcf.getFileName();¤				if(fileName.contains("\\")){¤					fileName = fileName.substring(fileName.lastIndexOf("\\") + 1);¤				}¤				if(hasUvsQueryWithAttachmentFromTitle(fileName)){¤					removedList.add(dcc);¤				}¤			}¤		}¤		if(removedList.size() > 0){¤			resdclist.removeAll(removedList);¤		}¤		return resdclist;¤	}¤	¤	public boolean hasUvsQueryWithAttachmentFromTitle(String fileName){¤		Session session = ContainerManager.Factory.get().getSession();¤		try {¤			Query q = session.createQuery("SELECT count(a.fileName) FROM Attachment a WHERE a.originalVersion is null and a.content.contentStatus='current' and a.fileName='" + fileName + "'");¤			Integer count = (Integer)q.uniqueResult();¤			if(count != null && count > 0){¤				return true;¤			}¤		} catch (HibernateException e) {¤			Logs.LOG_SEX(e);¤		}¤		return false;¤	}¤	¤¤	¤	public InputStream makeCSVFile(final List<DocCardContent> docs){¤		try {¤			StringBuilder csvContent = new StringBuilder();¤			¤			CSVFormat format = CSVFormat.EXCEL.withDelimiter(';');¤			StringWriter sw = new StringWriter();¤			CSVPrinter out = new CSVPrinter(sw, format);¤¤			for(DocCardContent dcc : docs){¤				for(DocCardFile dcFile : dcc.getFiles()){¤					List record = new ArrayList();¤					record.add(dcFile.getFileName());¤					record.add((StringUtils.isEmpty(dcc.getType())?"":dcc.getType()));¤					record.add(dcc.getIssuer());¤					record.add(((dcc.getCreationDate()==null)?"":new SimpleDateFormat("dd.MM.yyyy").format(dcc.getCreationDate())));¤					record.add((StringUtils.isEmpty(dcc.getNumber())?"":dcc.getNumber()));¤					record.add((StringUtils.isEmpty(dcc.getTitle())?"":dcc.getTitle()));¤					record.add(((dcc.getRegistrationNumber() == null)?"":dcc.getRegistrationNumber()));¤					record.add(((dcc.getRegistrationDate() == null)?"":new SimpleDateFormat("dd.MM.yyyy").format(dcc.getRegistrationDate())));¤					record.add(dcc.getCopySrcTitle());¤					record.add((StringUtils.isEmpty(dcc.getCopySrcNumber())?"":dcc.getCopySrcNumber()));¤					record.add(((dcc.getCopySrcStartDate() == null)?"":new SimpleDateFormat("dd.MM.yyyy").format(dcc.getCopySrcStartDate())));¤					record.add("[" + dcc.getRequestInfo() + "]");¤					out.printRecord(record);¤				}¤			}¤			sw.flush();¤			sw.close();¤			Logs.LOG_W(sw.toString());¤			ByteArrayInputStream bais = new ByteArrayInputStream(sw.toString().getBytes("windows-1251"));¤			return bais;¤		} catch (Exception e1) {¤			Logs.LOG_SEX(e1);¤		}¤		return null;¤	}¤	¤	public List<DocCardContent> findRSSDocs(final Date currentDate, final String spaceKey){¤		List<DocCardContent> dcs = new ArrayList<DocCardContent>();¤		for(int index = 0; index < RSS_PRAVO_BLOCKS_ROWS.length; index++){¤			AfterGetRSSFeed postProcessor = (AfterGetRSSFeed)RSS_PRAVO_BLOCKS_ROWS[index][3]; ¤			dcs.addAll(postProcessor.execute (					¤					getRSSFeedDocs(currentDate, spaceKey, (String)RSS_PRAVO_BLOCKS_ROWS[index][2], (String)RSS_PRAVO_BLOCKS_ROWS[index][1])¤					));¤		}¤		¤		String[][] statesFedOrgan = getSubjectsRF(spaceKey);¤/*¤		String[][] rssStates = new String[1][2];¤		rssStates[0][0] = "Ôåäåðàëüíàÿ íàëîãîâàÿ ñëóæáà (ÔÍÑ Ðîññèè)";¤		rssStates[0][1] = "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=58b78614-6739-462a-b0d4-d70e46ab4846/limit=100";¤*/		¤		for(int index = 0; index < statesFedOrgan.length; index++){¤			dcs.addAll(getRSSFeedDocs(currentDate, spaceKey, statesFedOrgan[index][1], statesFedOrgan[index][0]));¤			¤		}¤		return dcs;¤	}¤	¤	public List<DocCardContent> getRSSFeedDocs(final Date currentDate, final String spaceKey, final String urlString, final String issuerIdStr){¤		final List<DocCardContent> dcs = new ArrayList<DocCardContent>();¤		final Map<String, String> params = new HashMap<String, String>();¤		new TransactionDecorator(true).doInNewTransaction(new DoInNewTransactionCallback() {¤			public void execute() {¤				try{¤					RssParser rp = new RssParser(urlString, params, "pravo");¤					¤					rp.parse(); ¤					RssFeed feed = rp.getFeed();¤		¤					if(feed.getItems() != null){¤						for(Item item : feed.getItems()){¤							try{¤								String title = item.title;¤								String link = item.link;¤								String description = item.description;¤								List<String> descriptionParams = getPubNumberAndDate(description);¤								if(descriptionParams != null && descriptionParams.size() > 0){¤									Date pubDate = new SimpleDateFormat("dd.MM.yyyy").parse(descriptionParams.get(1));¤				¤									if(hasDatePublicationInInterval(pubDate, currentDate)){¤										DocCardContent content = createDocCardContent(title, spaceKey, issuerIdStr, pubDate, link, descriptionParams.get(0));¤										dcs.add(content);¤		¤										Logs.LOG_W("title=" + item.title + " link=" + item.link);¤									}else{¤										break;¤									}¤								}¤							}catch(Exception ex){¤								Logs.LOG_W("CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob::getRSSFeedDocs::urlString=" + urlString + " issuerIdStr=" + issuerIdStr);¤								Logs.LOG_SEX(ex);¤							}¤						}¤					}¤					}catch(Exception e){¤						Logs.LOG_SEX(e);¤					}¤				¤				}¤			¤			});¤		return dcs;¤	}¤	¤	private String readStreamToString(InputStream in, String encoding)¤	        throws IOException {¤	    StringBuffer b = new StringBuffer();¤	    InputStreamReader r = new InputStreamReader(in, encoding);¤	    int c;¤	    while ((c = r.read()) != -1) {¤	        b.append((char)c);¤	    }¤	    return b.toString();¤	}¤	¤	public String[][] getSubjectsRF(final String spaceKey){¤		try {¤			String content = getContentFromRSSPostRequest();¤¤			JsonObject obj = new JsonParser().parse(content).getAsJsonObject();¤			JsonArray arr = obj.getAsJsonArray("StateAuthorities");¤¤			String[][] rssStates = new String[arr.size()][2];¤			¤			for (int i = 0; i < arr.size(); i++){¤				JsonObject objSubjectRF = (JsonObject)arr.get(i);¤				Set<Entry<String, JsonElement>> entrySet = objSubjectRF.entrySet();¤				Iterator iter = entrySet.iterator();¤				Entry<String, JsonElement> elem = (Entry<String, JsonElement>)iter.next();¤				JsonElement value = elem.getValue();¤				Entry<String, JsonElement> elem2 = (Entry<String, JsonElement>)iter.next();¤				JsonElement text = elem2.getValue();¤				rssStates[i][0] = text.getAsString();¤				rssStates[i][1] = RSS_PRAVO_BLOCK_FED_ORGAN_ISPOLNITELNOJ_VLASTI[2].replace("{1}", value.getAsString());¤			}¤			return rssStates;¤		} catch (Exception e) {¤			Logs.LOG_SEX(e);¤		}¤¤		return new String[0][2];¤	}¤	¤	public String getContentFromRSSPostRequest() throws Exception{¤		HttpURLConnection connection = (HttpURLConnection)getConnection("http://publication.pravo.gov.ru/RssList/GetContent");¤		connection.setDoOutput(true);¤		connection.setRequestMethod("POST");¤		DataOutputStream wr = new DataOutputStream (connection.getOutputStream ());¤		String urlParameters = "blockId=" + RSS_PRAVO_BLOCK_FED_ORGAN_ISPOLNITELNOJ_VLASTI[1];¤	    wr.writeBytes (urlParameters);¤	    wr.flush ();¤	    wr.close ();¤		String content = readStreamToString(connection.getInputStream(), "UTF-8");¤		return content;¤	}¤	¤	¤	public DocCardContent createDocCardContent(final String title, final String spaceKey, final String issuerIdStr, final Date pubDate, final String link, final String attachName) throws Exception{¤		DocCardContent content = new DocCardContent();¤¤		GarDocDAO gardoc = DocCardManager.Factory.get().makeByTitle(title, spaceKey);¤¤		if(StringUtils.isNotEmpty(issuerIdStr) && StringUtils.isNumeric(issuerIdStr)){¤			Page issuer = ContainerManager.Factory.get().getPageManager().getPage(Long.parseLong(issuerIdStr));¤			content.setIssuer(issuer.getTitle());¤		}else{¤			long issuerId = gardoc.getDocIssuer();¤			if(issuerId > 0){¤				Page issuer = ContainerManager.Factory.get().getPageManager().getPage(issuerId);¤				content.setIssuer(issuer.getTitle());¤			}¤		}¤		¤		content.setNumber(gardoc.getNumber());¤		content.setCreationDate(gardoc.getCreationDate());¤		content.setType(gardoc.getType().getName());¤		content.setTitle(gardoc.getName());¤¤		content.setCopyType(new SiteCopyDAO().getType());¤		content.setSourceWebSite("http://pravo.gov.ru/");¤		content.setCopySrcTitle("Îôèöèàëüíûé èíòåðíåò-ïîðòàë ïðàâîâîé èíôîðìàöèè http://pravo.gov.ru/");¤		content.setCopySrcStartDate(pubDate);¤		content.setCopySrcEndDate(pubDate);¤		content.setRequestInfo(link);¤		content.setPubNumber(attachName);¤¤		Map<String, String> infoMap = getHrefForPDFFileAndMinustInfoString(link);¤		String infoMinust = infoMap.get("doccaption");¤		if(infoMinust != null){¤			Pattern pattern = Pattern.compile("\\(Çàðåãèñòðèðîâàí â Ìèíþñòå Ðîññèè (\\d{2}\\.\\d{2}\\.\\d{4}) ¹ (\\d+)\\)");¤			Matcher m = pattern.matcher(infoMinust);¤			if (m.find()) {¤				String minustDateString = (String)m.group(1);¤				String minustNumber = (String)m.group(2);¤				content.setRegistrationNumber(minustNumber);¤				Date muDate = new SimpleDateFormat("dd.MM.yyyy").parse(minustDateString);¤				content.setRegistrationDate(muDate);¤			}¤		}¤		¤		List<DocCardFile> files = new ArrayList<DocCardFile>();¤		DocCardFile dcfile = getDocFile(attachName, infoMap.get("pdfHref"));¤		files.add(dcfile);¤		content.setFiles(files);¤		saveImages(content, spaceKey);¤¤		return content;¤	}¤	¤	public List<String> getPubNumberAndDate(final String description){¤		Pattern pattern = Pattern.compile("Íîìåð îïóáëèêîâàíèÿ: (\\d+); Äàòà îïóáëèêîâàíèÿ: (\\d{2}\\.\\d{2}\\.\\d{4})");¤		Matcher m = pattern.matcher(description);¤		if (m.find()) {¤			List<String> descriptionParams = new ArrayList<String>();¤			descriptionParams.add((String)m.group(1));¤			descriptionParams.add((String)m.group(2));¤			return descriptionParams;¤		}¤		return null;¤	}¤	¤	public boolean hasDatePublicationInInterval(final Date pubDate, final Date currentDate){¤		String pubDateString = new SimpleDateFormat("dd.MM.yyyy").format(pubDate);¤		String currentDateString = new SimpleDateFormat("dd.MM.yyyy").format(currentDate);¤		if(pubDateString.equals(currentDateString)){¤			return true;¤		}¤		return false;¤	}¤	¤	public void saveImages(DocCardContent dcc, String spaceKey){¤		if(StringUtils.isNotEmpty(dcc.getIssuer())){¤			String numberOrTitle = (StringUtils.isNotEmpty(dcc.getNumber()))?dcc.getNumber():dcc.getTitle();¤			String folderForManyFiles = (dcc.getFiles().size() > 1)?(numberOrTitle + "\\"):"";¤¤			String dir = createPathFolders(spaceKey, dcc.getIssuer(), folderForManyFiles);¤			¤			String serverPath = DpoUvsHelper.convertToServerPathToFileWithCopy(dir, spaceKey);¤			new File(serverPath).mkdirs();¤			¤			List<DocCardFile> dcFiles = dcc.getFiles();¤			for(DocCardFile dcFile : dcFiles) {¤				String depositoryPath = saveImage(dir, dcFile, spaceKey);¤				¤				dcFile.setFileName(depositoryPath);¤			}¤		}¤	}¤	¤	public static String createPathFolders(final String spaceKey, final String ogvName, final String folderForManyFiles){¤		OGVLinksDAO ogv = OGVLinksManager.Factory.get(spaceKey).getOgvByName(ogvName);¤		¤		String path = "I:\\CRDR\\TO1";¤		¤		path += "\\" + new SimpleDateFormat("MM_dd").format(new Date());¤		¤		if(ogv != null && StringUtils.isNotEmpty(ogv.getSuffixForECopyFilePath())){¤			path +=  "\\" + ogv.getSuffixForECopyFilePath();¤		}¤		¤		if (StringUtils.isNotEmpty(folderForManyFiles)) {¤			path +=  "\\" + folderForManyFiles;¤		}¤		¤		return path;¤	}	¤	¤	public String saveImage(final String dir, final DocCardFile dcFile, final String spaceKey){¤		String fileName = dcFile.getFileName();¤		String depositoryPath = dir + "\\" + fileName;				¤		String serverFileName = DpoUvsHelper.convertToServerPathToFileWithCopy(depositoryPath, spaceKey);¤		¤		if (new File(serverFileName).exists() == true) {¤			return depositoryPath;¤		}		¤		¤		InputStream is = null;¤		FileOutputStream fos = null;¤		¤		try {¤			String href = dcFile.getFileComment();¤			URLConnection connection = getConnection(href);¤	 	    is = connection.getInputStream ();¤¤			File file = new File(serverFileName);¤			¤			fos = new FileOutputStream(file);¤¤			int read = 0;¤			byte[] bytes = new byte[1024];¤	 ¤			while ((read =  is.read(bytes)) != -1) {¤				fos.write(bytes, 0, read);¤			}¤		} catch (Exception e) {¤			Logs.LOG_SEX(e);¤		}finally{¤			if(is != null){¤				try {¤					is.close();¤				} catch (IOException e) {¤					Logs.LOG_SEX(e);¤				}¤			}¤			if(fos != null){¤				try {¤					fos.close();¤				} catch (IOException e) {¤					Logs.LOG_SEX(e);¤				}¤			}¤		}¤		¤		return depositoryPath;¤	}¤¤	public final String siteName = "http://publication.pravo.gov.ru";¤	¤	interface AfterGetRSSFeed {¤		List<DocCardContent> execute (List<DocCardContent> doccards);¤	}¤	¤	static AfterGetRSSFeed DO_NOTHING = new AfterGetRSSFeed () {¤		@Override¤		public List<DocCardContent> execute(List<DocCardContent> doccards) {¤			return doccards;¤		}¤		¤	};¤	¤	static AfterGetRSSFeed CHANGE_PREZIDENT = new AfterGetRSSFeed () {¤		@Override¤		public List<DocCardContent> execute(List<DocCardContent> doccards) {¤			//åñëè ÒÈÏ - ÔÅÄÅÐÀËÜÍÛÉ ÇÀÊÎÍ è ÎÃÂ - Ïðåçèäåíò Ðîññèè, òî ìåíÿåì ÎÃÂ íà Ãîñóäàðñòâåííàÿ Äóìà Ôåäåðàëüíîãî Ñîáðàíèÿ¤			for(DocCardContent dcc : doccards){¤				if(StringUtils.isNotEmpty(dcc.getType()) && dcc.getType().toUpperCase().equals("ÔÅÄÅÐÀËÜÍÛÉ ÇÀÊÎÍ") && dcc.getIssuer().equals("Ïðåçèäåíò Ðîññèè")){¤					dcc.setIssuer("Ãîñóäàðñòâåííàÿ Äóìà Ôåäåðàëüíîãî Ñîáðàíèÿ");¤				}¤			}¤			return doccards;¤		}¤		¤	};	¤	¤	public final Object[][] RSS_PRAVO_BLOCKS_ROWS = {¤			{"Ïðåçèäåíò Ðîññèéñêîé Ôåäåðàöèè", "249954324", "http://publication.pravo.gov.ru/Rss/block=E94B6872-DCAC-414F-B2F1-A538D13A12A0/limit=100", CHANGE_PREZIDENT}, ¤			{"Ñîâåò Ôåäåðàöèè", "249954309", "http://publication.pravo.gov.ru/Rss/block=950CDCB1-F55D-4E22-9F05-87074FE08EFD/limit=100", DO_NOTHING},¤			{"Ãîñóäàðñòâåííàÿ Äóìà", "241696954", "http://publication.pravo.gov.ru/Rss/block=0DBE1BC1-0E40-446A-A3BA-1CCABE18CA5E/limit=100", DO_NOTHING}, ¤			{"Ïðàâèòåëüñòâî Ðîññèéñêîé Ôåäåðàöèè", "241702354", "http://publication.pravo.gov.ru/Rss/block=19BB10CD-32F3-4632-8303-C94DD5F45359/limit=100", DO_NOTHING}, ¤			{"Êîíñòèòóöèîííûé Ñóä Ðîññèéñêîé Ôåäåðàöèè", "241696797", "http://publication.pravo.gov.ru/Rss/block=B85249B6-F6E6-4562-A783-90EA989AF2DB/limit=100", DO_NOTHING}, ¤			{"Ìåæäóíàðîäíûå Äîãîâîðû Ðîññèéñêîé Ôåäåðàöèè", "249955426", "http://publication.pravo.gov.ru/Rss/block=C79F71A1-C367-4E9D-A8B2-046CC8A1673F/limit=100", DO_NOTHING}¤		};¤	¤	public final String[] RSS_PRAVO_BLOCK_FED_ORGAN_ISPOLNITELNOJ_VLASTI =	{¤			"Ôåäåðàëüíûå Îðãàíû Èñïîëíèòåëüíîé Âëàñòè Ðîññèéñêîé Ôåäåðàöèè", ¤			"28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC", ¤			"http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state={1}/limit=100" ¤            };¤	/*¤	private final String[][] RSS_FED_ORGAN_ISPOLNITELNOJ_VLASTI = {¤			{"Ìèíèñòåðñòâî âíóòðåííèõ äåë Ðîññèéñêîé Ôåäåðàöèè (ÌÂÄ Ðîññèè)", "241696868", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=5d8c1571-a013-41f6-ad47-ebe4b534cc7a/limit=100"},¤			{"Ìèíèñòåðñòâî Ðîññèéñêîé Ôåäåðàöèè ïî äåëàì ãðàæäàíñêîé îáîðîíû, ÷ðåçâû÷àéíûì ñèòóàöèÿì è ëèêâèäàöèè ïîñëåäñòâèé ñòèõèéíûõ áåäñòâèé (Ì×Ñ Ðîññèè)", "241696962", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=a187c3a4-ec6c-4514-bcbf-1953900fdeca/limit=100"},¤			{"Ìèíèñòåðñòâî èíîñòðàííûõ äåë Ðîññèéñêîé Ôåäåðàöèè (ÌÈÄ Ðîññèè)", "241696969", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=e8459357-a5d7-4e9c-a648-801dde239437/limit=100"},¤			{"Ìèíèñòåðñòâî îáîðîíû Ðîññèéñêîé Ôåäåðàöèè (Ìèíîáîðîíû Ðîññèè)", "241696873", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=05766d0a-1828-4264-b419-19147c28650f/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî âîåííî-òåõíè÷åñêîìó ñîòðóäíè÷åñòâó (ÔÑÂÒÑ Ðîññèè)", "241696913", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=a0f5b205-3978-4e03-b07f-8c76dfa2395e/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî òåõíè÷åñêîìó è ýêñïîðòíîìó êîíòðîëþ (ÔÑÒÝÊ Ðîññèè)", "241696935", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=e629ce07-05c7-4ba0-aa4b-bc859b9e0d9a/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ñïåöèàëüíîãî ñòðîèòåëüñòâà (Ñïåöñòðîé Ðîññèè)", "241696874", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=4f79038f-139b-4790-a21f-860202f83576/limit=100"},¤			{"Ìèíèñòåðñòâî þñòèöèè Ðîññèéñêîé Ôåäåðàöèè (Ìèíþñò Ðîññèè)", "241696908", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=6374a31a-dcdc-49a2-a8c2-0cc5430f5353/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà èñïîëíåíèÿ íàêàçàíèé (ÔÑÈÍ Ðîññèè)", "241696942", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=c7114138-dd9a-4577-a237-d1a55fd84012/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ñóäåáíûõ ïðèñòàâîâ (ÔÑÑÏ Ðîññèè)", "241696931", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=b004ab9b-9ef3-4944-9b42-7783f63405d6/limit=100"},¤			{"Ãîñóäàðñòâåííàÿ ôåëüäúåãåðñêàÿ ñëóæáà Ðîññèéñêîé Ôåäåðàöèè (ÃÔÑ Ðîññèè)", "241696854", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=aa80fd6a-cc82-4f55-97d4-0a23a9bfa7d3/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà áåçîïàñíîñòè Ðîññèéñêîé Ôåäåðàöèè (ÔÑÁ Ðîññèè)", "241696875", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=ed61b828-9b26-4b00-b66d-8c9c484b04d5/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà Ðîññèéñêîé Ôåäåðàöèè ïî êîíòðîëþ çà îáîðîòîì íàðêîòèêîâ (ÔÑÊÍ Ðîññèè)", "244712520", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=dd7f252d-4d2b-4b94-af0b-f3c0dbcf0072/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà îõðàíû Ðîññèéñêîé Ôåäåðàöèè (ÔÑÎ Ðîññèè)", "241696916", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=e31b6f80-9eed-4d84-a8e6-4736d6da9ffe/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî ôèíàíñîâîìó ìîíèòîðèíãó (Ðîñôèíìîíèòîðèíã)", "241696844", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=ecc1ca32-67fd-4c07-9dc3-93f71905d8b4/limit=100"},¤			{"Ãëàâíîå óïðàâëåíèå ñïåöèàëüíûõ ïðîãðàìì Ïðåçèäåíòà Ðîññèéñêîé Ôåäåðàöèè (ÃÓÑÏ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=85df00ed-a9df-4345-8cb2-fac95296ae35/limit=100"},¤			{"Óïðàâëåíèå äåëàìè Ïðåçèäåíòà Ðîññèéñêîé Ôåäåðàöèè", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=fc11f46e-7faf-4626-84ae-b9131a03f90f/limit=100"},¤			{"Ìèíèñòåðñòâî çäðàâîîõðàíåíèÿ Ðîññèéñêîé Ôåäåðàöèè (Ìèíçäðàâ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=7eb814c1-9e92-4f86-b312-aaae5946b92c/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî íàäçîðó â ñôåðå çäðàâîîõðàíåíèÿ (Ðîñçäðàâíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=d3c84e54-ad2f-4923-8402-618105000c12/limit=100"},¤			{"Ôåäåðàëüíîå ìåäèêî-áèîëîãè÷åñêîå àãåíòñòâî (ÔÌÁÀ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=8965da6e-b698-4e05-a661-752692a8a8e4/limit=100"},¤			{"Ìèíèñòåðñòâî Ðîññèéñêîé Ôåäåðàöèè ïî äåëàì Êðûìà", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=7baee0e7-dfbf-4cd7-b4b9-109e49fd1dfd/limit=100"},¤			{"Ìèíèñòåðñòâî êóëüòóðû Ðîññèéñêîé Ôåäåðàöèè (Ìèíêóëüòóðû Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=f013d494-3ae8-4d29-97de-1851660bc5a7/limit=100"},¤			{"Ôåäåðàëüíîå àðõèâíîå àãåíòñòâî (Ðîñàðõèâ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=eb2ead6f-9ae1-4a7c-ba3c-ef0fb81c2a87/limit=100"},¤			{"Ìèíèñòåðñòâî îáðàçîâàíèÿ è íàóêè Ðîññèéñêîé Ôåäåðàöèè (Ìèíîáðíàóêè Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=ae6b94d9-b549-4ad0-965a-f736419a52bb/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî äåëàì ìîëîäåæè (Ðîñìîëîäåæü)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=eed74b0c-d34c-44ef-addd-1edd513f5cf5/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî íàäçîðó â ñôåðå îáðàçîâàíèÿ è íàóêè (Ðîñîáðíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=189faee6-1590-4768-95e2-c640417fa802/limit=100"},¤			{"Ìèíèñòåðñòâî ïðèðîäíûõ ðåñóðñîâ è ýêîëîãèè Ðîññèéñêîé Ôåäåðàöèè (Ìèíïðèðîäû Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=d2b40c1f-c4dd-4698-9eed-60eda4ba57e8/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî ãèäðîìåòåîðîëîãèè è ìîíèòîðèíãó îêðóæàþùåé ñðåäû (Ðîñãèäðîìåò)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=ef26ece4-607e-42ec-9a6a-fc5d96b43963/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî íàäçîðó â ñôåðå ïðèðîäîïîëüçîâàíèÿ (Ðîñïðèðîäíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=6d970399-2525-4e41-b308-11ffe42b8ce3/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî âîäíûõ ðåñóðñîâ (Ðîñâîäðåñóðñû)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=cbd0932a-f746-4f95-a40f-1ac317978309/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ëåñíîãî õîçÿéñòâà (Ðîñëåñõîç)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=84d5fb1b-bf23-4d5d-a0d4-a5dabbc47fb3/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî íåäðîïîëüçîâàíèþ (Ðîñíåäðà)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=178f1adc-ed3b-443e-9659-57080b207888/limit=100"},¤			{"Ìèíèñòåðñòâî ïðîìûøëåííîñòè è òîðãîâëè Ðîññèéñêîé Ôåäåðàöèè (Ìèíïðîìòîðã Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=b59e90d8-5f25-4b39-b1db-ec5e521eee62/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî òåõíè÷åñêîìó ðåãóëèðîâàíèþ è ìåòðîëîãèè (Ðîññòàíäàðò)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=f14f649d-89fa-426c-8703-ae6e8b64f227/limit=100"},¤			{"Ìèíèñòåðñòâî Ðîññèéñêîé Ôåäåðàöèè ïî ðàçâèòèþ Äàëüíåãî Âîñòîêà (Ìèíâîñòîêðàçâèòèÿ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=baa69732-4425-4404-9ec4-730942908589/limit=100"},¤			{"Ìèíèñòåðñòâî ñâÿçè è ìàññîâûõ êîììóíèêàöèé Ðîññèéñêîé Ôåäåðàöèè (Ìèíêîìñâÿçü Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=dd215a2b-15a6-4a9d-9bbc-585cfdca32d3/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî íàäçîðó â ñôåðå ñâÿçè, èíôîðìàöèîííûõ òåõíîëîãèé è ìàññîâûõ êîììóíèêàöèé (Ðîñêîìíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=6952d25b-c41e-439a-9b7f-76f7048bafd4/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî ïå÷àòè è ìàññîâûì êîììóíèêàöèÿì (Ðîñïå÷àòü)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=24ef5635-e819-4e72-8589-46cca929fb05/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ñâÿçè (Ðîññâÿçü)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=24f61a2d-5c7f-477f-b63b-2e519023181f/limit=100"},¤			{"Ìèíèñòåðñòâî Ðîññèéñêîé Ôåäåðàöèè ïî äåëàì Ñåâåðíîãî Êàâêàçà (Ìèíêàâêàç Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=e6e90c4f-61a4-4b48-828d-bfe2055c96ab/limit=100"},¤			{"Ìèíèñòåðñòâî ñåëüñêîãî õîçÿéñòâà Ðîññèéñêîé Ôåäåðàöèè (Ìèíñåëüõîç Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=04079430-85a7-456f-9c4f-1fb83dbf1c6d/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî âåòåðèíàðíîìó è ôèòîñàíèòàðíîìó íàäçîðó (Ðîññåëüõîçíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=1df930d9-e6ef-4e26-8a39-56d8f9ef949e/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî ðûáîëîâñòâó (Ðîñðûáîëîâñòâî)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=d120e5c4-3d8a-45ce-88a3-32e752507200/limit=100"},¤			{"Ìèíèñòåðñòâî ñïîðòà Ðîññèéñêîé Ôåäåðàöèè (Ìèíñïîðò Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=d2b66e16-c40d-407b-8eec-17de967c3cc6/limit=100"},¤			{"Ìèíèñòåðñòâî ñòðîèòåëüñòâà è æèëèùíî-êîììóíàëüíîãî õîçÿéñòâà Ðîññèéñêîé Ôåäåðàöèè (Ìèíñòðîé Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=6c02dc0c-d331-4d15-ad72-f9c8423f2afd/limit=100"},¤			{"Ìèíèñòåðñòâî òðàíñïîðòà Ðîññèéñêîé Ôåäåðàöèè (Ìèíòðàíñ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=19e068ff-08f3-4cdb-bfd4-3029bdf115c9/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî íàäçîðó â ñôåðå òðàíñïîðòà (Ðîñòðàíñíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=211324a4-92ac-4e5d-a46e-54ae59039c9e/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî âîçäóøíîãî òðàíñïîðòà (Ðîñàâèàöèÿ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=9b940359-27fa-460c-bdb5-285e8f4e0199/limit=100"},¤			{"Ôåäåðàëüíîå äîðîæíîå àãåíòñòâî (Ðîñàâòîäîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=3350f4e5-79cc-48f6-a951-e8e1fec4d409/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî æåëåçíîäîðîæíîãî òðàíñïîðòà (Ðîñæåëäîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=aff92728-d1d5-4477-a33c-1225341d9b87/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ìîðñêîãî è ðå÷íîãî òðàíñïîðòà (Ðîñìîððå÷ôëîò)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=647893ae-d929-4c92-bcec-fa2b64aba534/limit=100"},¤			{"Ìèíèñòåðñòâî òðóäà è ñîöèàëüíîé çàùèòû Ðîññèéñêîé Ôåäåðàöèè (Ìèíòðóä Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=c8e75904-6619-4369-878c-94a84a78823a/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî òðóäó è çàíÿòîñòè (Ðîñòðóä)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=b1de73c2-6d98-4ff0-ba98-fb46f1867ebf/limit=100"},¤			{"Ìèíèñòåðñòâî ôèíàíñîâ Ðîññèéñêîé Ôåäåðàöèè (Ìèíôèí Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=eee00294-b2c9-4c73-a6db-305af201e259/limit=100"},¤			{"Ôåäåðàëüíàÿ íàëîãîâàÿ ñëóæáà (ÔÍÑ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=58b78614-6739-462a-b0d4-d70e46ab4846/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ôèíàíñîâî-áþäæåòíîãî íàäçîðà (Ðîñôèííàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=c83a4278-e26c-4eff-be01-1ed8bb9c9d58/limit=100"},¤			{"Ôåäåðàëüíîå êàçíà÷åéñòâî (Êàçíà÷åéñòâî Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=f8f74aef-f109-4751-9542-a482df74ed6f/limit=100"},¤			{"Ìèíèñòåðñòâî ýêîíîìè÷åñêîãî ðàçâèòèÿ Ðîññèéñêîé Ôåäåðàöèè (Ìèíýêîíîìðàçâèòèÿ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=a98bb81d-6b3d-46ae-a49b-f15e0de66cc3/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ãîñóäàðñòâåííîé ðåãèñòðàöèè, êàäàñòðà è êàðòîãðàôèè (Ðîñðååñòð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=ddc3a92a-fbd6-4966-b07e-c1b9426fc25d/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî èíòåëëåêòóàëüíîé ñîáñòâåííîñòè (Ðîñïàòåíò)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=b86a7549-da6f-43b9-aca0-016e2d356bbf/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî ãîñóäàðñòâåííûì ðåçåðâàì (Ðîñðåçåðâ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=80daf753-e65e-4af5-8f50-0aa7a3d6fd87/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî óïðàâëåíèþ ãîñóäàðñòâåííûì èìóùåñòâîì (Ðîñèìóùåñòâî)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=1e856059-b593-44f7-b621-c73be348c8dc/limit=100"},¤			{"Ìèíèñòåðñòâî ýíåðãåòèêè Ðîññèéñêîé Ôåäåðàöèè (Ìèíýíåðãî)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=4f270d29-283e-4945-b998-f4556665d369/limit=100"},¤			{"Ôåäåðàëüíàÿ àíòèìîíîïîëüíàÿ ñëóæáà (ÔÀÑ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=192adbac-aae7-4d82-85d7-9159fec019f0/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ãîñóäàðñòâåííîé ñòàòèñòèêè (Ðîññòàò)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=3b199a60-d899-4471-8038-9a00a6d51202/limit=100"},¤			{"Ôåäåðàëüíàÿ ìèãðàöèîííàÿ ñëóæáà (ÔÌÑ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=02a092b4-842f-4e53-8980-6bcb0680138c/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî íàäçîðó â ñôåðå çàùèòû ïðàâ ïîòðåáèòåëåé è áëàãîïîëó÷èÿ ÷åëîâåêà (Ðîñïîòðåáíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=0174983b-0042-4b05-851d-110dff59d4be/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî ðåãóëèðîâàíèþ àëêîãîëüíîãî ðûíêà (Ðîñàëêîãîëüðåãóëèðîâàíèå)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=16faaf12-c56e-4da7-9e91-bec6dffb9fba/limit=100"},¤			{"Ôåäåðàëüíàÿ òàìîæåííàÿ ñëóæáà (ÔÒÑ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=46ce0765-7e71-48f1-9ea9-d4ae39f9d6fb/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî òàðèôàì (ÔÑÒ Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=f22e75bd-e17d-4168-b05d-82f59829b553/limit=100"},¤			{"Ôåäåðàëüíàÿ ñëóæáà ïî ýêîëîãè÷åñêîìó, òåõíîëîãè÷åñêîìó è àòîìíîìó íàäçîðó (Ðîñòåõíàäçîð)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=5fa36332-0066-4f7b-9a0c-77da641b92b8/limit=100"},¤			{"Ôåäåðàëüíîå êîñìè÷åñêîå àãåíòñòâî (Ðîñêîñìîñ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=507ae2c5-8dee-4a36-86fe-b6bf17743d9c/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî íàó÷íûõ îðãàíèçàöèé (ÔÀÍÎ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=1d21f68e-fa61-4f05-95c9-3631d4960243/limit=100"},¤			{"Ôåäåðàëüíîå àãåíòñòâî ïî îáóñòðîéñòâó ãîñóäàðñòâåííîé ãðàíèöû Ðîññèéñêîé ôåäåðàöèè (Ðîñãðàíèöà)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=dea1fa7a-9e5d-4287-89d9-f36d3c427b02/limit=100"},¤			{"Ãîñóäàðñòâåííàÿ êîðïîðàöèÿ ïî àòîìíîé ýíåðãèè Ðîñàòîì (Ãîñêîðïîðàöèÿ Ðîñàòîì)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=5f22c8cc-9ce2-42ba-8287-75d24c2f3c59/limit=100"},¤			{"Ôîíä ñîöèàëüíîãî ñòðàõîâàíèÿ Ðîññèéñêîé Ôåäåðàöèè", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=6d7f99eb-a9f4-4b69-94c6-52a733b91c14/limit=100"},¤			{"Ôåäåðàëüíûé ôîíä îáÿçàòåëüíîãî ìåäèöèíñêîãî ñòðàõîâàíèÿ (ÔÎÌÑ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=8472a3c5-821a-40d4-88d7-c8c5958c9070/limit=100"},¤			{"Ïåíñèîííûé Ôîíä Ðîññèéñêîé Ôåäåðàöèè (ÏÔÐ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=76c19b0b-f27d-4c43-8baf-3966afb532a6/limit=100"},¤			{"Ñëåäñòâåííûé êîìèòåò Ðîññèéñêîé Ôåäåðàöèè", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=9e88027c-6b47-4e36-88ea-29eef17fe866/limit=100"},¤			{"Öåíòðàëüíûé áàíê Ðîññèéñêîé Ôåäåðàöèè (Áàíê Ðîññèè)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=8bacdcad-49a0-40b5-a1f4-5c2f1c4ec5e2/limit=100"},¤			{"Ãåíåðàëüíàÿ ïðîêóðàòóðà Ðîññèéñêîé Ôåäåðàöèè", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=8b38c936-ee5e-43f6-9df6-76e425c2bb00/limit=100"},¤			{"Ðîññèéñêàÿ àêàäåìèÿ íàóê (ÐÀÍ)", "", "http://publication.pravo.gov.ru/Rss/block=28BDEEBD-E2CF-45CE-8D2A-2BC1AAADD7FC/state=e1b8e72d-5cf7-404a-b7d5-af3c9777a817/limit=100"}¤	};¤	*/¤	//#UC END# *5579817002A9_CUSTOM_METHODS_AND_DATA*
		    )))
	    quid       	"5579817002A9"
	    documentation 	"êà÷àåò äîêóìåíòû ñ publication.pravo.gov.ru, êàæäûé êàíàë îáðàáàòûâàåò îäèíàêîâî è ñîçäàåò íîâûå êàðòî÷êè ñ îáðàçàìè"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1435231196696304"))
		    quid       	"558BE3DC02B7"
		    supplier   	"Logical View::MDProcess::DocCardMailing::MailingSupport::AbstractWorkWithSiteJob"
		    quidu      	"558BE332035F"))
	    language   	"MDA Generator")
	(object Class "AbstractWorkWithSiteJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1435231026863589")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"abstract")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/AbstractWorkWithSiteJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*558BE332035F_CUSTOM_IMPORT*"
		    value      	"//#UC START# *558BE332035F_CUSTOM_IMPORT*¤import java.net.*;¤import org.apache.commons.lang.StringUtils;¤import com.atlassian.confluence.setup.bandana.ConfluenceBandanaContext;¤//#UC END# *558BE332035F_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*558BE332035F_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *558BE332035F_CUSTOM_CLASS_DEFINITION*¤//#UC END# *558BE332035F_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*558BE332035F_DO_EXECUTE_IMPLEMETATION*"
		    value      	(value Text 
|//#UC START# *558BE332035F_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *558BE332035F_DO_EXECUTE_IMPLEMETATION*
		    ))
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*558BE332035F_CUSTOM_METHODS_AND_DATA*"
		    value      	(value Text 
|//#UC START# *558BE332035F_CUSTOM_METHODS_AND_DATA*¤	public URLConnection getConnection(final String link) throws Exception{¤		URL urlLink = null;¤		try {¤			urlLink = new URL(link);¤		} catch (Exception e) {¤			Logs.LOG_SEX(e);¤		}¤		¤		String loginPassword = (String)ru.garant.shared.ConfluenceCore.Helpers.ContainerManager.Factory.get().getBandanaManager().getValue(ConfluenceBandanaContext.GLOBAL_CONTEXT, "AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob.ProxyConnection.LoginPassword");¤		if(StringUtils.isEmpty(loginPassword)){¤			loginPassword = "elenau:charly";¤		}¤		¤		Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress("proxy.garant.ru", 8080));¤		URLConnection connection = urlLink.openConnection(proxy);¤        sun.misc.BASE64Encoder encoder = new sun.misc.BASE64Encoder();¤	    String encodedUserPwd = encoder.encode(loginPassword.getBytes());¤	    connection.setRequestProperty("Proxy-Authorization", "Basic " + encodedUserPwd);¤	    return connection;¤	}¤	¤¤	public String getSpaceKey(){¤		return SPACE_KEY;¤	}¤¤	final String SPACE_KEY = "DPOUVS";¤	//#UC END# *558BE332035F_CUSTOM_METHODS_AND_DATA*
		    )))
	    quid       	"558BE332035F"
	    documentation 	"îáùèé ìåõàíèçì ðàáîòû ñ ñàéòàìè"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1435231191784023"))
		    quid       	"558BE3D7030F"
		    supplier   	"Logical View::MDProcess::DocCardChange::DocCardSupport::GarDocAbstractJob"
		    quidu      	"53E4BF9000E2"))
	    language   	"MDA Generator"
	    abstract   	TRUE)
	(object Class "CreateQueriesWithCopiesFromCBRJob"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"ElementCreationOrder"
		    value      	"1458043822413602")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"AbstarctOperation"
		    value      	"regular")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsNative"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory auto reg"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Factory default impl"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"Servant Pool"
		    value      	"none")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"cron-expression"
		    value      	"0 0 23 * * ?")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"debug log"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"factory priority"
		    value      	"0")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"local supervisor"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"need UC"
		    value      	"true")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"repeated"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator User Properties"
		    name       	"singleton"
		    value      	"false")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SELF GENERATED FILE (java)"
		    value      	"w:/MDProcess/java/src/java/ru/garant/MDProcess/DocCardMailing/MailingSupport/CreateQueriesWithCopiesFromCBRJob.java")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"SourceType (java)"
		    value      	"file")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*56E7FBAE019D_CUSTOM_IMPORT*"
		    value      	"//#UC START# *56E7FBAE019D_CUSTOM_IMPORT*¤//#UC END# *56E7FBAE019D_CUSTOM_IMPORT*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*56E7FBAE019D_CUSTOM_CLASS_DEFINITION*"
		    value      	"//#UC START# *56E7FBAE019D_CUSTOM_CLASS_DEFINITION*¤//#UC END# *56E7FBAE019D_CUSTOM_CLASS_DEFINITION*")
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*56E7FBAE019D_DO_EXECUTE_IMPLEMETATION*"
		    value      	
|//#UC START# *56E7FBAE019D_DO_EXECUTE_IMPLEMETATION*¤		super.doExecute(jec);¤		//#UC END# *56E7FBAE019D_DO_EXECUTE_IMPLEMETATION*
		    )
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"java:*56E7FBAE019D_CUSTOM_METHODS_AND_DATA*"
		    value      	
|//#UC START# *56E7FBAE019D_CUSTOM_METHODS_AND_DATA*¤	@Override¤	protected void executeJob() {¤		Logs.LOG_D ("CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob::start");¤		Date currentDate = new Date();¤/*		Date currentDate = null;¤		try {¤			currentDate = new SimpleDateFormat("dd.MM.yyyy").parse("02.07.2015");¤		} catch (ParseException e) {¤			Logs.LOG_SEX(e);¤		}¤		*/¤		List<DocCardContent> docs = findRSSDocs(currentDate, getSpaceKey());¤		createMailAndExecuteMailingJob(docs, getSpaceKey());¤		Logs.LOG_D ("CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob::end");¤	}¤¤	@Override¤	protected boolean isNeedWriteTransaction() {¤		return false;¤	}¤¤	public void createMailAndExecuteMailingJob(final List<DocCardContent> docs, final String spaceKey){¤		try {¤			List<DocCardContent> resdclist = removingWithExistingAttachments(docs);¤			¤			if(resdclist.size() > 0){¤				List<DocCardFile> docCardFileList = new ArrayList<DocCardFile>();¤				DocCardFile dcFile = DocCardFile.Factory.make();¤				dcFile.setFileName("CBR.CSV");¤				FileContent fc = FileContent.Factory.make();¤				fc.setBinaryStream(makeCSVFile(resdclist));¤				dcFile.setFileContent(fc);¤				docCardFileList.add(dcFile);¤				MailingItem mailingItemReceived = MailingItem.Factory.make("cbr.ru", docCardFileList, "SITE");¤				MailingJob job = new  MailingJob();¤				job.processEmailReceived (mailingItemReceived, spaceKey);¤			}¤		} catch (Exception e) {¤			Logs.LOG_SEX (e);¤		}¤	}¤	//#UC END# *56E7FBAE019D_CUSTOM_METHODS_AND_DATA*
		    ))
	    quid       	"56E7FBAE019D"
	    documentation 	"Âûêà÷èâàòåëü CBR â 23:00"
	    stereotype 	"KJobPlugin"
	    superclasses 	(list inheritance_relationship_list
		(object Inheritance_Relationship
		    attributes 	(list Attribute_Set
			(object Attribute
			    tool       	"MDA Generator"
			    name       	"ElementCreationOrder"
			    value      	"1458045157303978"))
		    quid       	"56E800E5012E"
		    supplier   	"Logical View::MDProcess::DocCardMailing::MailingSupport::CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob"
		    quidu      	"5579817002A9"))
	    language   	"MDA Generator"))
    logical_presentations 	(list unit_reference_list
	(object ClassDiagram "Main"
	    attributes 	(list Attribute_Set
		(object Attribute
		    tool       	"MDA Generator"
		    name       	"IsChanged"
		    value      	"true"))
	    quid       	"4E5667FF0169"
	    title      	"Main"
	    zoom       	100
	    max_height 	28350
	    max_width  	21600
	    origin_x   	0
	    origin_y   	469
	    items      	(list diagram_item_list
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::Mailing::MailingParser" @1
		    ShowCompartmentStereotypes 	TRUE
		    SuppressAttribute 	TRUE
		    SuppressOperation 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    location   	(1257, 231)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	16714250
			default_color 	FALSE)
		    label      	(object ItemLabel
			Parent_View 	@1
			location   	(1115, 203)
			nlines     	1
			max_width  	284
			justify    	0
			label      	"MailingParser")
		    stereotype 	(object ItemLabel
			Parent_View 	@1
			location   	(1115, 153)
			anchor     	10
			nlines     	1
			max_width  	284
			justify    	0
			label      	"<<Interface>>")
		    icon       	"Interface"
		    icon_style 	"Label"
		    line_color 	16714250
		    fill_color 	16777215
		    quidu      	"4E54C62F00A5"
		    width      	302
		    height     	180
		    annotation 	8
		    autoResize 	TRUE)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::Mailing::RequestCreator" @2
		    ShowCompartmentStereotypes 	TRUE
		    SuppressAttribute 	TRUE
		    SuppressOperation 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    location   	(1254, 585)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	16714250
			default_color 	FALSE)
		    label      	(object ItemLabel
			Parent_View 	@2
			location   	(1099, 557)
			nlines     	1
			max_width  	310
			justify    	0
			label      	"RequestCreator")
		    stereotype 	(object ItemLabel
			Parent_View 	@2
			location   	(1099, 507)
			anchor     	10
			nlines     	1
			max_width  	310
			justify    	0
			label      	"<<Interface>>")
		    icon       	"Interface"
		    icon_style 	"Label"
		    line_color 	16714250
		    fill_color 	16777215
		    quidu      	"4E79EC4501CD"
		    width      	328
		    height     	180
		    annotation 	8
		    autoResize 	TRUE)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::MailingJob" @3
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(2574, 387)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@3
			location   	(1673, 328)
			fill_color 	13434879
			nlines     	1
			max_width  	1802
			justify    	0
			label      	" MailingJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@3
			location   	(1673, 278)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	1802
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"4E84777001E7"
		    compartment 	(object Compartment
			Parent_View 	@3
			location   	(1673, 389)
			font       	(object Font
			    size       	10
			    face       	"Arial"
			    charSet    	204
			    bold       	FALSE
			    italics    	FALSE
			    underline  	FALSE
			    strike     	FALSE
			    color      	0
			    default_color 	TRUE)
			icon_style 	"Icon"
			fill_color 	16777215
			anchor     	2
			nlines     	2
			max_width  	1796
			justify    	1)
		    width      	1820
		    height     	242
		    annotation 	8
		    autoResize 	TRUE)
		(object UsesView "" @4
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    stereotype 	(object SegLabel @5
			Parent_View 	@4
			location   	(1568, 483)
			font       	(object Font
			    size       	10
			    face       	"Arial"
			    charSet    	204
			    bold       	FALSE
			    italics    	FALSE
			    underline  	FALSE
			    strike     	FALSE
			    color      	0
			    default_color 	TRUE)
			anchor     	10
			anchor_loc 	1
			nlines     	1
			max_width  	450
			justify    	0
			label      	"<<uses>>"
			pctDist    	0.539808
			height     	55
			orientation 	1)
		    line_color 	3342489
		    quidu      	"4E84779000A5"
		    client     	@3
		    supplier   	@2
		    vertices   	(list Points
			(1759, 508)
			(1418, 560))
		    line_style 	0)
		(object UsesView "" @6
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    stereotype 	(object SegLabel @7
			Parent_View 	@6
			location   	(1552, 241)
			font       	(object Font
			    size       	10
			    face       	"Arial"
			    charSet    	204
			    bold       	FALSE
			    italics    	FALSE
			    underline  	FALSE
			    strike     	FALSE
			    color      	0
			    default_color 	TRUE)
			anchor     	10
			anchor_loc 	1
			nlines     	1
			max_width  	450
			justify    	0
			label      	"<<uses>>"
			pctDist    	0.451908
			height     	24
			orientation 	1)
		    line_color 	3342489
		    quidu      	"4E8477A40344"
		    client     	@3
		    supplier   	@1
		    vertices   	(list Points
			(1663, 278)
			(1408, 247))
		    line_style 	0)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::AddArchiExportDateFromNumberInUvsQueryInMail" @8
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(2865, 1266)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@8
			location   	(2051, 1182)
			fill_color 	13434879
			nlines     	1
			max_width  	1628
			justify    	0
			label      	" AddArchiExportDateFromNumberInUvsQueryInMail")
		    stereotype 	(object ItemLabel
			Parent_View 	@8
			location   	(2051, 1132)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	1628
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"4F69D63A0144"
		    compartment 	(object Compartment
			Parent_View 	@8
			location   	(2051, 1243)
			font       	(object Font
			    size       	10
			    face       	"Arial"
			    charSet    	204
			    bold       	FALSE
			    italics    	FALSE
			    underline  	FALSE
			    strike     	FALSE
			    color      	0
			    default_color 	TRUE)
			icon_style 	"Icon"
			fill_color 	16777215
			anchor     	2
			nlines     	3
			max_width  	1634
			justify    	1)
		    width      	1646
		    height     	292
		    annotation 	8
		    autoResize 	TRUE)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::FindAndSendMailWithSubjectDelayInExportDocCards" @9
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(2820, 831)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@9
			location   	(2147, 803)
			fill_color 	13434879
			nlines     	1
			max_width  	1346
			justify    	0
			label      	" FindAndSendMailWithSubjectDelayInExportDocCards")
		    stereotype 	(object ItemLabel
			Parent_View 	@9
			location   	(2147, 753)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	1346
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"4F69D8670091"
		    width      	1364
		    height     	180
		    annotation 	8
		    autoResize 	TRUE)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::RequestCreatorAsyncJob" @10
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(3162, 1692)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@10
			location   	(2898, 1664)
			fill_color 	13434879
			nlines     	1
			max_width  	528
			justify    	0
			label      	" RequestCreatorAsyncJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@10
			location   	(2898, 1614)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	528
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"5193830903BB"
		    width      	546
		    height     	180
		    annotation 	8
		    autoResize 	TRUE)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::Mailing::MailingQueue" @11
		    ShowCompartmentStereotypes 	TRUE
		    SuppressAttribute 	TRUE
		    SuppressOperation 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    location   	(1467, 906)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	16714250
			default_color 	FALSE)
		    label      	(object ItemLabel
			Parent_View 	@11
			location   	(1308, 878)
			nlines     	1
			max_width  	318
			justify    	0
			label      	" MailingQueue")
		    stereotype 	(object ItemLabel
			Parent_View 	@11
			location   	(1308, 828)
			anchor     	10
			nlines     	1
			max_width  	318
			justify    	0
			label      	"<<Interface>>")
		    icon       	"Interface"
		    icon_style 	"Label"
		    line_color 	16714250
		    fill_color 	16777215
		    quidu      	"51938049018D"
		    width      	336
		    height     	180
		    annotation 	8
		    autoResize 	TRUE)
		(object UsesView "" @12
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    stereotype 	(object SegLabel @13
			Parent_View 	@12
			location   	(2023, 776)
			font       	(object Font
			    size       	10
			    face       	"Arial"
			    charSet    	204
			    bold       	FALSE
			    italics    	FALSE
			    underline  	FALSE
			    strike     	FALSE
			    color      	0
			    default_color 	TRUE)
			anchor     	10
			anchor_loc 	1
			nlines     	1
			max_width  	450
			justify    	0
			label      	"<<uses>>"
			pctDist    	0.500000
			height     	120
			orientation 	0)
		    line_color 	3342489
		    quidu      	"51DE9985031E"
		    client     	@3
		    supplier   	@11
		    vertices   	(list Points
			(2311, 508)
			(1635, 825))
		    line_style 	0)
		(object ClassView "Class" "Logical View::MDProcess::DocCardChange::DocCardSupport::GarDocAbstractJob" @14
		    ShowCompartmentStereotypes 	TRUE
		    SuppressAttribute 	TRUE
		    SuppressOperation 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    location   	(681, 1485)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	TRUE
			underline  	FALSE
			strike     	FALSE
			color      	13110000
			default_color 	FALSE)
		    label      	(object ItemLabel
			Parent_View 	@14
			location   	(486, 1458)
			nlines     	1
			max_width  	390
			justify    	0
			label      	"GarDocAbstractJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@14
			location   	(486, 1408)
			anchor     	10
			nlines     	1
			max_width  	390
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    line_color 	13110000
		    fill_color 	16777215
		    quidu      	"53E4BF9000E2"
		    width      	408
		    height     	178
		    annotation 	8
		    autoResize 	TRUE)
		(object InheritView "" @15
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"51948BA8036D"
		    client     	@10
		    supplier   	@14
		    vertices   	(list Points
			(2888, 1668)
			(885, 1500))
		    line_style 	0)
		(object InheritView "" @16
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"4FBA297E02BB"
		    client     	@8
		    supplier   	@14
		    vertices   	(list Points
			(2041, 1347)
			(885, 1464))
		    line_style 	0)
		(object InheritView "" @17
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"4FBA297B0163"
		    client     	@9
		    supplier   	@14
		    vertices   	(list Points
			(2520, 921)
			(885, 1421))
		    line_style 	0)
		(object InheritView "" @18
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"5350DDD8029C"
		    client     	@3
		    supplier   	@14
		    vertices   	(list Points
			(2362, 508)
			(830, 1395))
		    line_style 	0)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::AbstractWorkWithZakonGosDumaJob" @19
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(732, 2268)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	TRUE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@19
			location   	(357, 2239)
			fill_color 	13434879
			nlines     	1
			max_width  	750
			justify    	0
			label      	"AbstractWorkWithZakonGosDumaJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@19
			location   	(357, 2189)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	750
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"555C5661002E"
		    width      	768
		    height     	182
		    annotation 	8
		    autoResize 	TRUE)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::RemoveLabelGardocDumaGrovRuThenLawWasSigned" @20
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(801, 3252)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@20
			location   	(101, 3223)
			fill_color 	13434879
			nlines     	1
			max_width  	1400
			justify    	0
			label      	" RemoveLabelGardocDumaGrovRuThenLawWasSigned")
		    stereotype 	(object ItemLabel
			Parent_View 	@20
			location   	(101, 3173)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	1400
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"555B20390374"
		    width      	1418
		    height     	182
		    annotation 	8
		    autoResize 	TRUE)
		(object InheritView "" @21
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"555C56E003E0"
		    client     	@20
		    supplier   	@19
		    vertices   	(list Points
			(794, 3160)
			(737, 2359))
		    line_style 	0)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::CreateProectZakonGosDumaDocJob" @22
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(2097, 3330)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@22
			location   	(1621, 3301)
			fill_color 	13434879
			nlines     	1
			max_width  	952
			justify    	0
			label      	" CreateProectZakonGosDumaDocJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@22
			location   	(1621, 3251)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	952
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"554C91810271"
		    width      	970
		    height     	182
		    annotation 	8
		    autoResize 	TRUE)
		(object InheritView "" @23
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"555C56DE00E4"
		    client     	@22
		    supplier   	@19
		    vertices   	(list Points
			(1978, 3238)
			(849, 2359))
		    line_style 	0)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob" @24
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(3621, 3315)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@24
			location   	(2847, 3286)
			fill_color 	13434879
			nlines     	1
			max_width  	1548
			justify    	0
			label      	" AddUvsQueryWithAttachmentToExistDocCardFromGosDumaJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@24
			location   	(2847, 3236)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	1548
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"554CBF1A0317"
		    width      	1566
		    height     	182
		    annotation 	8
		    autoResize 	TRUE)
		(object InheritView "" @25
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"555C56E30347"
		    client     	@24
		    supplier   	@19
		    vertices   	(list Points
			(3370, 3223)
			(984, 2359))
		    line_style 	0)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob" @26
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(3009, 2655)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@26
			location   	(2231, 2626)
			fill_color 	13434879
			nlines     	1
			max_width  	1556
			justify    	0
			label      	" CreateDocCardsWithUvsQueriesWithCopiesFromPravoSiteJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@26
			location   	(2231, 2576)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	1556
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"5579817002A9"
		    width      	1574
		    height     	182
		    annotation 	8
		    autoResize 	TRUE)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::AbstractWorkWithSiteJob" @27
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(717, 1821)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	TRUE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@27
			location   	(456, 1792)
			fill_color 	13434879
			nlines     	1
			max_width  	522
			justify    	0
			label      	"AbstractWorkWithSiteJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@27
			location   	(456, 1742)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	522
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"558BE332035F"
		    width      	540
		    height     	182
		    annotation 	8
		    autoResize 	TRUE)
		(object InheritView "" @28
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"555C56AB03AE"
		    client     	@19
		    supplier   	@27
		    vertices   	(list Points
			(728, 2176)
			(719, 1912))
		    line_style 	0)
		(object InheritView "" @29
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"558BE3D7030F"
		    client     	@27
		    supplier   	@14
		    vertices   	(list Points
			(706, 1729)
			(690, 1574))
		    line_style 	0)
		(object ClassView "Class" "Logical View::MDProcess::DocCardMailing::MailingSupport::CreateQueriesWithCopiesFromCBRJob" @30
		    ShowCompartmentStereotypes 	TRUE
		    IncludeAttribute 	TRUE
		    IncludeOperation 	TRUE
		    ShowOperationSignature 	TRUE
		    location   	(2910, 2088)
		    font       	(object Font
			size       	10
			face       	"Arial"
			charSet    	204
			bold       	FALSE
			italics    	FALSE
			underline  	FALSE
			strike     	FALSE
			color      	0
			default_color 	TRUE)
		    label      	(object ItemLabel
			Parent_View 	@30
			location   	(2400, 2059)
			fill_color 	13434879
			nlines     	1
			max_width  	1020
			justify    	0
			label      	" CreateQueriesWithCopiesFromCBRJob")
		    stereotype 	(object ItemLabel
			Parent_View 	@30
			location   	(2400, 2009)
			fill_color 	13434879
			anchor     	10
			nlines     	1
			max_width  	1020
			justify    	0
			label      	"<<KJobPlugin>>")
		    icon_style 	"Label"
		    fill_color 	15448575
		    quidu      	"56E7FBAE019D"
		    width      	1038
		    height     	182
		    annotation 	8
		    autoResize 	TRUE)
		(object InheritView "" @31
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"558BE3DC02B7"
		    client     	@26
		    supplier   	@27
		    vertices   	(list Points
			(2760, 2563)
			(967, 1912))
		    line_style 	0)
		(object InheritView "" @32
		    stereotype 	TRUE
		    line_color 	3342489
		    quidu      	"56E800E5012E"
		    client     	@30
		    supplier   	@26
		    vertices   	(list Points
			(2925, 2179)
			(2992, 2563))
		    line_style 	0)))))
