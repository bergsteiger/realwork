<<ServerLibrary>> ChatLibrary
 %UID '4A2E061E0198'
 %DOCUMENTATION 'библиотека обмена сообщениями'
 %DEPENDS
  U$ '4503D5DC0290' /* omg */
 ; // %DEPENDS
 %META
  %upv "exec mode" 'idle'
  %upv "gui" 'tie'
  %upv "is namespace" true
  %upv "old gcm" false
  %upv "vendor" '/Garant'
 ; // %META
 %TOBEINCLUDED
  U$ '4503D5DC0290' /* omg */
 ; // %TOBEINCLUDED
 %CHILDREN
  
  <<ServerInterfaces>> ChatService
   %UID '4A2E035D01EA'
   %DOCUMENTATION 'сервис обмена сообщениями. Интерфейсы подразумевают, что работа с чатом происходит в рамках сессии, которая позволяет идентифицировать текущего пользователя.'
   %META
    %upv "is namespace" true
   ; // %META
   %TOBEINCLUDED
    U$ '4A2E061E0198' /* ChatLibrary */
   ; // %TOBEINCLUDED
   %CHILDREN
    
     <<Vector>> UidList
      %UID '4A2E073B02B4'
      %DOCUMENTATION 'список идентификаторов пользователей'
      %META
       %upv "array type" 'dynamic'
      ; // %META
      %ATTRIBUTES
        <<Attribute>> "4A30AEAC035B"
         %UID '4A30AEAC035B'
        ; // 4A30AEAC035B
      ; // %ATTRIBUTES
     ; // UidList
     <<Exception>> UnknownUser
      %UID '4A2E0928038F'
      %DOCUMENTATION 'задан некорректный идентификатор пользователя'
     ; // UnknownUser
     <<Struct>> UserInfo
      %UID '4A2E07F803CF'
      %DOCUMENTATION 'информация о пользователе'
      %ATTRIBUTES
        FINAL <<Attribute>> name
         %UID '4A2E083903E6'
         %DOCUMENTATION 'имя пользователя'
         %TARGET U$ '3DBFFE240068' /* string */
        ; // name
        FINAL <<Attribute>> login
         %UID '4A2E08540028'
         %DOCUMENTATION 'логин пользователя'
         %TARGET U$ '3DBFFE240068' /* string */
        ; // login
        FINAL <<Attribute>> email
         %UID '4A2E086203A0'
         %DOCUMENTATION 'адрес электронной почты пользователя'
         %TARGET U$ '3DBFFE240068' /* string */
        ; // email
      ; // %ATTRIBUTES
     ; // UserInfo
     <<ServerInterface>> UsersListManager
      %UID '4A2E039200FC'
      %DOCUMENTATION 'управление списком пользователей'
      %META
       %upv "Use AMI" false
      ; // %META
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %OPERATIONS
        ABSTRACT <<chg>> add_user_to_list
         %UID '4A2E03E401C9'
         %DOCUMENTATION 'добавить пользователя в список контактов'
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %RAISES
          U$ '4A2E0928038F' /* UnknownUser */
         ; // %RAISES
         %PARAMETERS
           <<in>> user
            %UID '4A2E53640161'
           ; // user
         ; // %PARAMETERS
        ; // add_user_to_list
        ABSTRACT <<chg>> del_user_from_list
         %UID '4A2E06EB02D6'
         %DOCUMENTATION 'удалить пользователя из списка контактов'
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %RAISES
          U$ '4A2E0928038F' /* UnknownUser */
         ; // %RAISES
         %PARAMETERS
           <<in>> user
            %UID '4A2E536A03B5'
           ; // user
         ; // %PARAMETERS
        ; // del_user_from_list
        ABSTRACT <<Operation>> get_contacts_list
         %UID '4A2E0717034A'
         %DOCUMENTATION 'получить список контактов'
         %TARGET U$ '4A2E073B02B4' /* UidList */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // get_contacts_list
        ABSTRACT <<factory>> get
         %UID '4A3735D401C5'
         %DOCUMENTATION 'фабрика с кешированным параметром'
         %META
          %upv "const_type" 'read-write'
         ; // %META
         %PARAMETERS
           <<cache>> uid
            %UID '4A4B3A0D0261'
           ; // uid
         ; // %PARAMETERS
        ; // get
        ABSTRACT <<factory>> get_by_uid
         %UID '4A7979290005'
         %DOCUMENTATION 'получить менеджер по идентификатору'
         %META
          %upv "const_type" 'read-write'
         ; // %META
         %PARAMETERS
           <<in>> uid
            %UID '4A797962013C'
           ; // uid
         ; // %PARAMETERS
        ; // get_by_uid
      ; // %OPERATIONS
     ; // UsersListManager
     <<Enum>> MessageType
      %UID '4A2E0D2601F1'
      %DOCUMENTATION 'тип данных, передаваемых в сообщении'
      %ATTRIBUTES
        <<Attribute>> MT_UNKNOWN
         %UID '4A2E0D5601FA'
         %DOCUMENTATION 'тип сообщения неизвестен'
        ; // MT_UNKNOWN
        <<Attribute>> MT_TEXT
         %UID '4A2E0D6B00E1'
         %DOCUMENTATION 'текстовое сообщение'
        ; // MT_TEXT
        <<Attribute>> MT_EVD
         %UID '4A2E0D7C03BA'
         %DOCUMENTATION 'сообщение формата EVD'
        ; // MT_EVD
      ; // %ATTRIBUTES
     ; // MessageType
     <<Vector>> MessageText
      %UID '4A2E101803DE'
      %DOCUMENTATION 'текст сообщения'
      %META
       %upv "array type" 'dynamic'
      ; // %META
      %ATTRIBUTES
        <<Attribute>> "4A2E34CF01C0"
         %UID '4A2E34CF01C0'
         %TARGET U$ '3DBFFE500260' /* octet */
        ; // 4A2E34CF01C0
      ; // %ATTRIBUTES
     ; // MessageText
     <<Typedef>> MessageId
      %UID '4A3B6187008D'
      %DOCUMENTATION 'уникальный идентификатор сообщения'
      %INHERITS
       U$ '3DBFFDE101CA' /* "unsigned long" */
      ; // %INHERITS
     ; // MessageId
     <<Struct>> MessageData
      %UID '4A2E2A0A02B1'
      %DOCUMENTATION 'данные сообщения'
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %ATTRIBUTES
        FINAL LINK <<Attribute>> text
         %UID '4A2E2A1C00EE'
         %DOCUMENTATION 'текст сообщения'
         %TARGET U$ '4A2E101803DE' /* MessageText */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // text
        FINAL LINK <<Attribute>> type
         %UID '4A2E2A1F02E6'
         %DOCUMENTATION 'тип сообщения'
         %TARGET U$ '4A2E0D2601F1' /* MessageType */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // type
      ; // %ATTRIBUTES
     ; // MessageData
     <<Struct>> MessageMetaData
      %UID '4A2E299D01B0'
      %DOCUMENTATION 'мета-данные сообщения'
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %ATTRIBUTES
        FINAL LINK <<Attribute>> date
         %UID '4A2E2A23036E'
         %DOCUMENTATION 'время создания сообщения'
         %TARGET U$ '3DBFFDF10213' /* "unsigned long long" */
        ; // date
        <<Attribute>> id
         %UID '4A3B61D4024C'
         %DOCUMENTATION 'уникальный идентификатор сообщения'
         %TARGET U$ '4A3B6187008D' /* MessageId */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // id
        FINAL LINK <<Attribute>> receiver
         %UID '4A2E2A2602AD'
         %DOCUMENTATION 'приёмник сообщения'
        ; // receiver
        FINAL LINK <<Attribute>> sender
         %UID '4A2E2A2901F3'
         %DOCUMENTATION 'источник сообщения'
        ; // sender
      ; // %ATTRIBUTES
     ; // MessageMetaData
     <<Struct>> Message
      %UID '4A2E0C550171'
      %DOCUMENTATION 'сообщение, передаваемое между пользователями'
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %ATTRIBUTES
        FINAL <<Attribute>> meta_data
         %UID '4A2E2C810246'
         %DOCUMENTATION 'данные, связанные с сообщением'
         %TARGET U$ '4A2E299D01B0' /* MessageMetaData */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // meta_data
        FINAL <<Attribute>> data
         %UID '4A2E2C9D00D2'
         %DOCUMENTATION 'текст и тип сообщения'
         %TARGET U$ '4A2E2A0A02B1' /* MessageData */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // data
      ; // %ATTRIBUTES
     ; // Message
     <<Typedef>> ListenerId
      %UID '4A2FA0F000B8'
      %DOCUMENTATION 'идентификатор слушателя сообщений'
      %INHERITS
       U$ '3DBFFDE101CA' /* "unsigned long" */
      ; // %INHERITS
     ; // ListenerId
     <<Vector>> MessageList
      %UID '4A2E2E7A02F2'
      %DOCUMENTATION 'список сообщений'
      %META
       %upv "array type" 'dynamic'
      ; // %META
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %ATTRIBUTES
        <<Attribute>> "4A2E34DF00FF"
         %UID '4A2E34DF00FF'
         %TARGET U$ '4A2E0C550171' /* Message */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // 4A2E34DF00FF
      ; // %ATTRIBUTES
     ; // MessageList
     <<ServerInterface>> MessageListener
      %UID '4A2E213E025E'
      %DOCUMENTATION 'интерфейс слушателя сообщений'
      %META
       %upv "Use AMI" false
      ; // %META
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %OPERATIONS
        ABSTRACT <<chg>> receive_message
         %UID '4A2E232102EB'
         %DOCUMENTATION 'получить сообщение'
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %PARAMETERS
           <<in>> data
            %UID '4A2E551F001F'
            %TARGET U$ '4A2E0C550171' /* Message */
            %TOBEINCLUDED
             U$ '4A2E061E0198' /* ChatLibrary */
            ; // %TOBEINCLUDED
           ; // data
         ; // %PARAMETERS
        ; // receive_message
        ABSTRACT <<factory>> make
         %UID '4A2E34A00253'
         %DOCUMENTATION 'фабрика слушателя'
         %META
          %upv "const_type" 'read-write'
         ; // %META
        ; // make
      ; // %OPERATIONS
     ; // MessageListener
     <<Vector>> MessageIds
      %UID '4A41F2E300CD'
      %DOCUMENTATION 'список идентификаторов сообщений'
      %META
       %upv "array type" 'dynamic'
      ; // %META
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %ATTRIBUTES
        <<Attribute>> "4A41F3020315"
         %UID '4A41F3020315'
         %TARGET U$ '4A3B6187008D' /* MessageId */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
        ; // 4A41F3020315
      ; // %ATTRIBUTES
     ; // MessageIds
     <<ServerInterface>> ChatManager
      %UID '4A2E0B760095'
      %DOCUMENTATION 'Позволяет получить информацию о заданном пользователе. Также позволяет клиенту чата зарегестрировать слушателя (одного или нескольких), которым через заданный коллбек интерфейс будут передаваться новые полученные сообщения.'
      %META
       %upv "Use AMI" false
      ; // %META
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %OPERATIONS
        ABSTRACT <<Operation>> get_user_info
         %UID '4A2E0BCB03DF'
         %DOCUMENTATION 'получить информацию о пользователе'
         %TARGET U$ '4A2E07F803CF' /* UserInfo */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %RAISES
          U$ '4A2E0928038F' /* UnknownUser */
         ; // %RAISES
         %PARAMETERS
           <<in>> user
            %UID '4A2E5371014C'
           ; // user
         ; // %PARAMETERS
        ; // get_user_info
        ABSTRACT <<chg>> add_listener
         %UID '4A2E2CD00128'
         %DOCUMENTATION 'добавить получателя сообщений для пользователя, вызвавшего данный метод'
         %TARGET U$ '4A2FA0F000B8' /* ListenerId */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %PARAMETERS
           <<in>> listener
            %UID '4A2E2CF40370'
            %TARGET U$ '4A2E213E025E' /* MessageListener */
            %TOBEINCLUDED
             U$ '4A2E061E0198' /* ChatLibrary */
            ; // %TOBEINCLUDED
           ; // listener
         ; // %PARAMETERS
        ; // add_listener
        ABSTRACT <<chg>> delete_listener
         %UID '4A2FA1260301'
         %DOCUMENTATION 'удалить слушателя с заданным идентификатором'
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %PARAMETERS
           <<in>> id
            %UID '4A2FA13F01F1'
            %TARGET U$ '4A2FA0F000B8' /* ListenerId */
            %TOBEINCLUDED
             U$ '4A2E061E0198' /* ChatLibrary */
            ; // %TOBEINCLUDED
           ; // id
         ; // %PARAMETERS
        ; // delete_listener
        ABSTRACT <<factory>> make
         %UID '4A37355B0168'
         %DOCUMENTATION 'создаётся объект, работающий от имени создавшего его пользователя'
         %META
          %upv "const_type" 'read-write'
         ; // %META
        ; // make
      ; // %OPERATIONS
     ; // ChatManager
     <<ServerInterface>> MessageManager
      %UID '4A30A0EE00F5'
      %DOCUMENTATION 'интерфейс для работы с сообщениями данного пользователя'
      %META
       %upv "Use AMI" false
      ; // %META
      %TOBEINCLUDED
       U$ '4A2E061E0198' /* ChatLibrary */
      ; // %TOBEINCLUDED
      %OPERATIONS
        ABSTRACT <<Operation>> get_messages_for_user
         %UID '4A30A17A01B3'
         %DOCUMENTATION 'получить список, состоящий из  _count_ последних сообщений при общении текущего пользователя и пользователя _user_, Если _count=0_, будет возвращена вся история переписки. Если _get_all_new = true_ будут получены все новые сообщения, а также все сообщения после самого старого нового, даже если их количество превышает _count_,'
         %TARGET U$ '4A2E2E7A02F2' /* MessageList */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %RAISES
          U$ '4A2E0928038F' /* UnknownUser */
         ; // %RAISES
         %PARAMETERS
           <<in>> user
            %UID '4A30A17A01C4'
           ; // user
           <<in>> count
            %UID '4A30A17A01E7'
            %TARGET U$ '3DBFFDE101CA' /* "unsigned long" */
           ; // count
           <<in>> get_all_new
            %UID '4A49E5BD0327'
            %TARGET U$ '3DBFFE100240' /* boolean */
           ; // get_all_new
         ; // %PARAMETERS
        ; // get_messages_for_user
        ABSTRACT <<Operation>> get_unreaded_list
         %UID '4A30A17D02FD'
         %DOCUMENTATION 'список новых сообщений для текущего пользователя'
         %TARGET U$ '4A2E2E7A02F2' /* MessageList */
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %RAISES
          U$ '4A2E0928038F' /* UnknownUser */
         ; // %RAISES
        ; // get_unreaded_list
        ABSTRACT <<Operation>> send_message
         %UID '4A30A181009B'
         %DOCUMENTATION 'послать сообщение заданному пользователю'
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %RAISES
          U$ '4A2E0928038F' /* UnknownUser */
         ; // %RAISES
         %PARAMETERS
           <<in>> receiver
            %UID '4A30A18100AF'
           ; // receiver
           <<in>> data
            %UID '4A30A18100D7'
            %TARGET U$ '4A2E2A0A02B1' /* MessageData */
            %TOBEINCLUDED
             U$ '4A2E061E0198' /* ChatLibrary */
            ; // %TOBEINCLUDED
           ; // data
         ; // %PARAMETERS
        ; // send_message
        ABSTRACT <<chg>> clean_history_for_user
         %UID '4A35F1E801BD'
         %DOCUMENTATION 'удаляет историю переписки текущего пользователя с заданным пользователем'
         %PARAMETERS
           <<in>> user
            %UID '4A35F21C02C7'
           ; // user
         ; // %PARAMETERS
        ; // clean_history_for_user
        ABSTRACT <<factory>> get
         %UID '4A3735BB039D'
         %DOCUMENTATION 'фабрика с кешированным параметром'
         %META
          %upv "const_type" 'read-write'
         ; // %META
         %PARAMETERS
           <<cache>> uid
            %UID '4A4B4087005B'
           ; // uid
         ; // %PARAMETERS
        ; // get
        ABSTRACT <<chg>> set_messages_as_read
         %UID '4A41D68701D4'
         %DOCUMENTATION 'пометить сообщения как прочитанные'
         %TOBEINCLUDED
          U$ '4A2E061E0198' /* ChatLibrary */
         ; // %TOBEINCLUDED
         %PARAMETERS
           <<in>> list
            %UID '4A41D6B100CC'
            %TARGET U$ '4A41F2E300CD' /* MessageIds */
            %TOBEINCLUDED
             U$ '4A2E061E0198' /* ChatLibrary */
            ; // %TOBEINCLUDED
           ; // list
         ; // %PARAMETERS
        ; // set_messages_as_read
      ; // %OPERATIONS
     ; // MessageManager
   ; // %CHILDREN
  ; // ChatService
 ; // %CHILDREN
; // ChatLibrary